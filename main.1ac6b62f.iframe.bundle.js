(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{289:function(module,__webpack_exports__,__webpack_require__){"use strict";var _node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(452),_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(453),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_cssWithMappingToString_js__WEBPACK_IMPORTED_MODULE_0___default.a);___CSS_LOADER_EXPORT___.push([module.i,".svg_1034369b{position:absolute;overflow:visible;top:0;left:0;width:100%;height:100%}.svg_1034369b:focus{outline:none}.node_a9f151f1{cursor:move}.container_b01cb13d{position:relative;width:100%;height:100%;overflow:hidden;touch-action:none}.button-a11y_d1d870a7{opacity:0;width:0;height:0;overflow:hidden}.adding-node-svg_ef88712a{z-index:1000000;position:fixed;left:0;top:0;width:100%;height:100%}.module-item_b1d09e51{user-select:none;cursor:pointer}.minimap_cf11a73a{height:320px;width:320px;user-select:none;touch-action:none}.minimap-svg_95b86ba4{position:absolute;top:0;left:0;width:100%;height:100%}","",{version:3,sources:["webpack://./src/components/Graph.styles.m.scss"],names:[],mappings:"AAIA,cACE,iBAAA,CACA,gBAAA,CACA,KAAA,CACA,MAAA,CACA,UAAA,CACA,WAAA,CAEA,oBACE,YAAA,CAIJ,eACE,WAAA,CAGF,oBACE,iBAAA,CACA,UAAA,CACA,WAAA,CACA,eAAA,CACA,iBAAA,CAGF,sBACE,SAAA,CACA,OAAA,CACA,QAAA,CACA,eAAA,CAGF,0BACE,eAAA,CACA,cAAA,CACA,MAAA,CACA,KAAA,CACA,UAAA,CACA,WAAA,CAGF,sBACE,gBAAA,CACA,cAAA,CAGF,kBACE,YAAA,CACA,WAAA,CACA,gBAAA,CACA,iBAAA,CAEA,sBACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,UAAA,CACA,WAAA",sourcesContent:["// use static css file here\n// if we use css-in-js, classNames are generated in Graph component\n// while node dragged out from module list can't get then className\n\n.svg {\n  position: absolute;\n  overflow: visible;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n\n  &:focus {\n    outline: none;\n  }\n}\n\n.node {\n  cursor: move;\n}\n\n.container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  touch-action: none;\n}\n\n.button-a11y {\n  opacity: 0;\n  width: 0;\n  height: 0;\n  overflow: hidden;\n}\n\n.adding-node-svg {\n  z-index: 1000000;\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.module-item {\n  user-select: none;\n  cursor: pointer;\n}\n\n.minimap {\n  height: 320px;\n  width: 320px;\n  user-select: none;\n  touch-action: none;\n\n  &-svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={svg:"svg_1034369b",node:"node_a9f151f1",container:"container_b01cb13d","button-a11y":"button-a11y_d1d870a7",buttonA11Y:"button-a11y_d1d870a7","adding-node-svg":"adding-node-svg_ef88712a",addingNodeSvg:"adding-node-svg_ef88712a","module-item":"module-item_b1d09e51",moduleItem:"module-item_b1d09e51",minimap:"minimap_cf11a73a","minimap-svg":"minimap-svg_95b86ba4",minimapSvg:"minimap-svg_95b86ba4"},__webpack_exports__.a=___CSS_LOADER_EXPORT___},475:function(module,exports,__webpack_require__){__webpack_require__(476),__webpack_require__(633),__webpack_require__(634),__webpack_require__(829),__webpack_require__(830),module.exports=__webpack_require__(823)},543:function(module,exports){},634:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(341)},823:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(341).configure)([__webpack_require__(824)],module,!1)}).call(this,__webpack_require__(191)(module))},824:function(module,exports,__webpack_require__){var map={"./index.stories.tsx":828};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=824},828:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Features",(function(){return index_stories_Features}));var GraphEdgeState,GraphNodeState,GraphNodeStateConst,GraphPortState,tslib_es6=__webpack_require__(1),react=__webpack_require__(0);__webpack_require__(11),__webpack_require__(63),__webpack_require__(6),__webpack_require__(15),__webpack_require__(13),__webpack_require__(14);!function(GraphEdgeState){GraphEdgeState[GraphEdgeState.default=0]="default",GraphEdgeState[GraphEdgeState.selected=1]="selected",GraphEdgeState[GraphEdgeState.activated=2]="activated",GraphEdgeState[GraphEdgeState.connectedToSelected=4]="connectedToSelected",GraphEdgeState[GraphEdgeState.unconnectedToSelected=8]="unconnectedToSelected",GraphEdgeState[GraphEdgeState.editing=16]="editing"}(GraphEdgeState||(GraphEdgeState={})),function(GraphNodeState){GraphNodeState[GraphNodeState.default=0]="default",GraphNodeState[GraphNodeState.selected=1]="selected",GraphNodeState[GraphNodeState.activated=2]="activated",GraphNodeState[GraphNodeState.editing=4]="editing",GraphNodeState[GraphNodeState.connectedToSelected=8]="connectedToSelected",GraphNodeState[GraphNodeState.unconnectedToSelected=16]="unconnectedToSelected"}(GraphNodeState||(GraphNodeState={})),function(GraphNodeStateConst){GraphNodeStateConst.default="default",GraphNodeStateConst.selected="selected",GraphNodeStateConst.activated="activated",GraphNodeStateConst.editing="editing",GraphNodeStateConst.connectedToSelected="connectedToSelected",GraphNodeStateConst.unconnectedToSelected="unconnectedToSelected"}(GraphNodeStateConst||(GraphNodeStateConst={})),function(GraphPortState){GraphPortState[GraphPortState.default=0]="default",GraphPortState[GraphPortState.selected=1]="selected",GraphPortState[GraphPortState.activated=2]="activated",GraphPortState[GraphPortState.connecting=4]="connecting",GraphPortState[GraphPortState.connectingAsTarget=8]="connectingAsTarget"}(GraphPortState||(GraphPortState={}));__webpack_require__(43);var Debug=function(){function Debug(){}return Debug.log=function(message){0},Debug.warn=function(message){0},Debug.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];console.error.apply(console,args)},Debug.never=function(value,message){throw new Error(null!=message?message:value+" is unexpected")},Debug}(),getNodeConfig_getNodeConfig=function getNodeConfig(node,graphConfig){var nodeConfig=graphConfig.getNodeConfigByName(node.shape);if(nodeConfig)return nodeConfig;Debug.warn("invalid shape in node "+JSON.stringify(node))};__webpack_require__(37),__webpack_require__(30),__webpack_require__(72),__webpack_require__(7);function getRectWidth(rectConfig,rect){var _a,minWidth=null!==(_a=null==rectConfig?void 0:rectConfig.getMinWidth(rect))&&void 0!==_a?_a:0;return rect.width&&rect.width>=minWidth?rect.width:minWidth}function getRectHeight(rectConfig,rect){var _a,minHeight=null!==(_a=null==rectConfig?void 0:rectConfig.getMinHeight(rect))&&void 0!==_a?_a:0;return rect.height&&rect.height>=minHeight?rect.height:minHeight}function getNodeSize(node,graphConfig){var nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig),width=getRectWidth(nodeConfig,node);return{height:getRectHeight(nodeConfig,node),width:width}}function getGroupRect(group,nodes,graphConfig){var _a,_b,_c,_d,_e,_f,_g,_h,childrenIds=new Set(group.nodeIds),children=Array.from(nodes.values()).filter((function(node){return childrenIds.has(node.id)})),minX=Math.min.apply(Math,children.map((function(node){return node.x}))),maxX=Math.max.apply(Math,children.map((function(node){return node.x+getNodeSize(node,graphConfig).width}))),minY=Math.min.apply(Math,children.map((function(node){return node.y}))),maxY=Math.max.apply(Math,children.map((function(node){return node.y+getNodeSize(node,graphConfig).height}))),x=minX-(null!==(_b=null===(_a=group.padding)||void 0===_a?void 0:_a.left)&&void 0!==_b?_b:0),y=minY-(null!==(_d=null===(_c=group.padding)||void 0===_c?void 0:_c.top)&&void 0!==_d?_d:0),height=maxY-y+(null!==(_f=null===(_e=group.padding)||void 0===_e?void 0:_e.bottom)&&void 0!==_f?_f:0);return{x:x,y:y,width:maxX-x+(null!==(_h=null===(_g=group.padding)||void 0===_g?void 0:_g.left)&&void 0!==_h?_h:0),height:height}}var MouseEventButton,MouseEventButtons,getPortPosition_getPortPositionByPortId=function getPortPositionByPortId(node,portId,graphConfig){var nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig);if(nodeConfig){var port=(node.ports||[]).find((function(p){return p.id===portId}));if(port)return function getPortPosition(node,port,nodeConfig){var width=getRectWidth(nodeConfig,node),height=getRectHeight(nodeConfig,node),xOffset=port.position?port.position[0]*width:.5*width,x=node.x+xOffset,yOffset=port.position?port.position[1]*height:height;return{x:x,y:node.y+yOffset}}(node,port,nodeConfig);Debug.warn("invalid port id "+JSON.stringify(port))}};__webpack_require__(23);!function(MouseEventButton){MouseEventButton[MouseEventButton.Primary=0]="Primary",MouseEventButton[MouseEventButton.Auxiliary=1]="Auxiliary",MouseEventButton[MouseEventButton.Secondary=2]="Secondary",MouseEventButton[MouseEventButton.Fourth=4]="Fourth",MouseEventButton[MouseEventButton.Fifth=5]="Fifth"}(MouseEventButton||(MouseEventButton={})),function(MouseEventButtons){MouseEventButtons[MouseEventButtons.None=0]="None",MouseEventButtons[MouseEventButtons.Left=1]="Left",MouseEventButtons[MouseEventButtons.Right=2]="Right",MouseEventButtons[MouseEventButtons.Middle=4]="Middle"}(MouseEventButtons||(MouseEventButtons={}));var BrowserType,identical=function identical(data){return data},isMobile=(__webpack_require__(108),__webpack_require__(24),__webpack_require__(29),__webpack_require__(57),__webpack_require__(65),function isMobile(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(toMatchItem){return navigator.userAgent.match(toMatchItem)}))});!function(BrowserType){BrowserType.unknown="unknown",BrowserType.edge="edge",BrowserType.edgeChromium="edgeChromium",BrowserType.opera="opera",BrowserType.chrome="chrome",BrowserType.ie="ie",BrowserType.firefox="firefox",BrowserType.safari="safari",BrowserType.electron="electron"}(BrowserType||(BrowserType={}));var getBrowser=function getBrowser(){var agent=navigator.userAgent.toLowerCase();if(agent.indexOf("electron")>-1)return BrowserType.electron;switch(!0){case agent.indexOf("edge")>-1:return BrowserType.edge;case agent.indexOf("edg")>-1:return BrowserType.edgeChromium;case agent.indexOf("opr")>-1&&!!window.opr:return BrowserType.opera;case agent.indexOf("chrome")>-1&&!!window.chrome:return BrowserType.chrome;case agent.indexOf("trident")>-1:return BrowserType.ie;case agent.indexOf("firefox")>-1:return BrowserType.firefox;case agent.indexOf("safari")>-1:return BrowserType.safari;default:return BrowserType.unknown}},isMacOs=navigator.userAgent.includes("Macintosh"),keyboard_metaControl=function metaControl(e){return isMacOs?e.metaKey:e.ctrlKey},checkIsMultiSelect=function checkIsMultiSelect(e){return e.shiftKey||keyboard_metaControl(e)},hasState=(__webpack_require__(59),__webpack_require__(19),function hasState(mask){return function(state){return Boolean(pickState(mask)(state))}}),addState=function addState(mask){return function(state){var t=state||0;return Array.isArray(mask)?mask.reduce((function(c,m){return c|m}),t):t|mask}},pickState=function pickState(mask){return function(state){return(state||0)&mask}},removeState=function removeState(mask){return function(state){var t=state||0;return Array.isArray(mask)?mask.reduce((function(c,m){return c&~m}),t):t&~mask}},resetState=function resetState(state){return function(){return state}},state_updateState=function updateState(updater){return function(value){return updater(value.state)===value.state?value:Object(tslib_es6.a)(Object(tslib_es6.a)({},value),{state:updater(value.state)})}},state_isNodeEditing=function isNodeEditing(node){return hasState(GraphNodeState.editing)(node.state)},state_isSelected=function isSelected(node){return hasState(1)(node.state)},state_notSelected=function notSelected(node){return!hasState(1)(node.state)},transformPoint=function transformPoint(x,y,transformMatrix){return{x:transformMatrix[0]*x+transformMatrix[2]*y+transformMatrix[4],y:transformMatrix[1]*x+transformMatrix[3]*y+transformMatrix[5]}},reverseTransformPoint=function reverseTransformPoint(x,y,transformMatrix){var t0=transformMatrix[0],t1=transformMatrix[1],t2=transformMatrix[2],t3=transformMatrix[3],t4=transformMatrix[4],t5=transformMatrix[5];return{x:((x-t4)*t3-(y-t5)*t2)/(t0*t3-t1*t2),y:((x-t4)*t1-(y-t5)*t0)/(t1*t2-t0*t3)}},getPointDeltaByClientDelta=function getPointDeltaByClientDelta(x,y,transformMatrix){var a=transformMatrix[0],b=transformMatrix[1],c=transformMatrix[2],d=transformMatrix[3];return{x:d*x/(a*d-b*c)+c*y/(b*c-a*d),y:b*x/(b*c-a*d)+a*y/(a*d-b*c)}},getClientDeltaByPointDelta=function getClientDeltaByPointDelta(x,y,transformMatrix){if(!transformMatrix)return{x:x,y:y};var a=transformMatrix[0],b=transformMatrix[1],c=transformMatrix[2],d=transformMatrix[3];return transformPoint(x,y,[a,b,c,d,0,0])},getRealPointFromClientPoint=function getRealPointFromClientPoint(clientX,clientY,viewport){var rect=viewport.rect,x=clientX-rect.left,y=clientY-rect.top;return reverseTransformPoint(x,y,viewport.transformMatrix)},getContainerClientPoint=function getContainerClientPoint(realX,realY,viewport){var client=function getClientPointFromRealPoint(realX,realY,viewport){var _a=transformPoint(realX,realY,viewport.transformMatrix),x=_a.x,y=_a.y,rect=viewport.rect;return{x:x+rect.left,y:y+rect.top}}(realX,realY,viewport),rect=viewport.rect;return{x:client.x-rect.left,y:client.y-rect.top}};function markEdgeDirty(edges,id){edges.update(id,(function(edge){return edge.shallow()}))}var graphDataUtils_isConnectable=function isConnectable(graphConfig,params){var portConfig=graphConfig.getPortConfigByName(params.model.shape);return!!portConfig&&portConfig.getIsConnectable(params)};var graphDataUtils_unSelectAllEntity=function unSelectAllEntity(){return function(data){return data.mapNodes((function(n){return n.update((function(curNode){var _a,nextNode=Object(tslib_es6.a)(Object(tslib_es6.a)({},curNode),{ports:null===(_a=curNode.ports)||void 0===_a?void 0:_a.map(state_updateState(resetState(GraphPortState.default)))});return state_updateState(resetState(GraphNodeState.default))(nextNode)}))})).mapEdges((function(e){return e.update(state_updateState(resetState(GraphEdgeState.default)))}))}},graphDataUtils_nodeSelection=function nodeSelection(e,target){if(state_isNodeEditing(target))return identical;var isMultiSelect=checkIsMultiSelect(e);return state_isSelected(target)&&!isMultiSelect?identical:function(data){var predicate=isMultiSelect?function(node){return node.id!==target.id?state_isSelected(node):e.button===MouseEventButton.Secondary||!state_isSelected(target)}:function(node){return node.id===target.id};return data.selectNodes(predicate,target.id)}},getNodeUid=function getNodeUid(graphId,node){return"node:"+graphId+":"+node.id},getPortUid=function getPortUid(graphId,node,port){return"port:"+graphId+":"+node.id+":"+port.id},getCurvePathD=function getCurvePathD(x1,x2,y1,y2){return"M"+x1+","+y1+"C"+x1+","+(y1-getControlPointDistance(y1,y2))+","+x2+","+(y2+5+getControlPointDistance(y1,y2))+","+x2+","+(y2+5)},getControlPointDistance=function getControlPointDistance(y1,y2){return Math.min(75,Math.max(15,Math.abs((y1-(y2+5))/2)))},isWithinThreshold=function isWithinThreshold(dx,dy,threshold){return Math.abs(dx)<threshold&&Math.abs(dy)<threshold},isPointInRect=(__webpack_require__(419),__webpack_require__(109),function isPointInRect(rect,point){var minX=rect.minX,minY=rect.minY,maxX=rect.maxX,maxY=rect.maxY,x=point.x,y=point.y;return x>minX&&x<maxX&&y>minY&&y<maxY}),square=function square(x){return Math.pow(x,2)},geometric_distance=function distance(x1,y1,x2,y2){return Math.sqrt(square(x2-x1)+square(y2-y1))},getLinearFunction=function getLinearFunction(x1,y1,x2,y2){return x1===x2?function(){return Number.MAX_SAFE_INTEGER}:function(x){return(y2-y1)/(x2-x1)*x+(y1*x2-y2*x1)/(x2-x1)}};(function(){function LinearEquation(x1,y1,x2,y2){this.a=y1-y2,this.b=x1-x2,this.c=x2*y1-x1*y2}LinearEquation.prototype.getX=function(y){if(0!==this.a)return(this.b*y+this.c)/this.a},LinearEquation.prototype.getY=function(x){if(0!==this.b)return(this.a*x-this.c)/this.b}})(),__webpack_require__(31),__webpack_require__(32),__webpack_require__(56);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var Direction;__webpack_require__(68),__webpack_require__(420);!function(Direction){Direction[Direction.X=0]="X",Direction[Direction.Y=1]="Y",Direction[Direction.XY=2]="XY"}(Direction||(Direction={}));var isViewportComplete=function isViewportComplete(viewport){return!!viewport.rect},viewport_getNodeRect=function getNodeRect(node,graphConfig){var x=node.x,y=node.y,_a=getNodeSize(node,graphConfig);return{x:x,y:y,width:_a.width,height:_a.height}},isRectVisible=function isRectVisible(shapeRect,viewport){var x=shapeRect.x,y=shapeRect.y,width=shapeRect.width,height=shapeRect.height;return viewport_isPointVisible({x:x,y:y},viewport)||viewport_isPointVisible({x:x+width,y:y},viewport)||viewport_isPointVisible({x:x+width,y:y+height},viewport)||viewport_isPointVisible({x:x,y:y+height},viewport)},viewport_isPointVisible=function isPointVisible(point,viewport){var _a=getContainerClientPoint(point.x,point.y,viewport),x=_a.x,y=_a.y,_b=viewport.rect,height=_b.height,width=_b.width;return x>0&&x<width&&y>0&&y<height},getVisibleNodes=function getVisibleNodes(nodes,viewport,graphConfig){var result=[];return nodes.forEach((function(n){(function isNodeVisible(node,viewport,graphConfig){return isRectVisible(viewport_getNodeRect(node,graphConfig),viewport)})(n,viewport,graphConfig)&&result.push(n.inner)})),result},getRenderedNodes=function getRenderedNodes(nodes,viewport){var result=[],renderedArea=viewport_getRenderedArea(viewport);return nodes.forEach((function(n){viewport_isNodeInRenderedArea(n,renderedArea)&&result.push(n.inner)})),result},viewport_isNodeInRenderedArea=function isNodeInRenderedArea(node,renderedArea){return isPointInRect(renderedArea,node)},viewport_getVisibleArea=function getVisibleArea(viewport){if(!isViewportComplete(viewport))return{minX:0,minY:0,maxX:0,maxY:0};var rect=viewport.rect,transformMatrix=viewport.transformMatrix,maxX=rect.width,maxY=rect.height,min=reverseTransformPoint(0,0,transformMatrix),max=reverseTransformPoint(maxX,maxY,transformMatrix);return{minX:min.x,minY:min.y,maxX:max.x,maxY:max.y}},viewport_getRenderedArea=function getRenderedArea(viewport){if(!isViewportComplete(viewport))return{minX:0,minY:0,maxX:0,maxY:0};var rect=viewport.rect,transformMatrix=viewport.transformMatrix,maxX=rect.width,maxY=rect.height,min=reverseTransformPoint(0-rect.width,0-rect.height,transformMatrix),max=reverseTransformPoint(maxX+rect.width,maxY+rect.height,transformMatrix);return{minX:min.x,minY:min.y,maxX:max.x,maxY:max.y}},viewport_zoomTo=function zoomTo(_a){var scale=_a.scale,anchor=_a.anchor,direction=_a.direction,limitScale=_a.limitScale;return function(prevState){var transformMatrix,scaleX=limitScale(scale)/prevState.transformMatrix[0],scaleY=limitScale(scale)/prevState.transformMatrix[3],dx=anchor.x*(1-scaleX),dy=anchor.y*(1-scaleY);switch(direction){case Direction.X:transformMatrix=[scale,0,0,prevState.transformMatrix[3],prevState.transformMatrix[4]*scaleX+dx,prevState.transformMatrix[5]];break;case Direction.Y:transformMatrix=[prevState.transformMatrix[0],0,0,scale,prevState.transformMatrix[4],prevState.transformMatrix[5]*scaleY+dy];break;case Direction.XY:default:transformMatrix=[scale,0,0,scale,prevState.transformMatrix[4]*scaleX+dx,prevState.transformMatrix[5]*scaleY+dy]}return Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{transformMatrix:transformMatrix})}},viewport_zoom=function zoom(_a){var scale=_a.scale,anchor=_a.anchor,direction=_a.direction,limitScale=_a.limitScale;return 1===scale?identical:function(prevState){var transformMatrix;switch(direction){case Direction.X:return viewport_zoomTo({anchor:anchor,direction:direction,limitScale:limitScale,scale:prevState.transformMatrix[0]*scale})(prevState);case Direction.Y:return viewport_zoomTo({anchor:anchor,direction:direction,limitScale:limitScale,scale:prevState.transformMatrix[3]*scale})(prevState);case Direction.XY:default:var resultX=limitScale(prevState.transformMatrix[0]*scale),resultY=limitScale(prevState.transformMatrix[3]*scale),scaleX=resultX/prevState.transformMatrix[0],scaleY=resultY/prevState.transformMatrix[3],dx=anchor.x*(1-scaleX),dy=anchor.y*(1-scaleY);transformMatrix=[resultX,0,0,resultY,prevState.transformMatrix[4]*scaleX+dx,prevState.transformMatrix[5]*scaleY+dy]}return Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{transformMatrix:transformMatrix})}},viewport_pan=function pan(dx,dy){return 0===dx&&0===dy?identical:function(prevState){return Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{transformMatrix:[prevState.transformMatrix[0],prevState.transformMatrix[1],prevState.transformMatrix[2],prevState.transformMatrix[3],prevState.transformMatrix[4]+dx,prevState.transformMatrix[5]+dy]})}},viewport_getContentArea=function getContentArea(data,graphConfig,nodeIds){var minNodeWidth=1/0,minNodeHeight=1/0,minNodeX=1/0,minNodeY=1/0,maxNodeX=-1/0,maxNodeY=-1/0;return(void 0===nodeIds?function forEachNode(fn){return data.nodes.forEach(fn)}:function forEachByIds(fn){return null==nodeIds?void 0:nodeIds.forEach((function(id){var node=data.nodes.get(id);node&&fn(node)}))})((function(node){var _a=getNodeSize(node,graphConfig),nodeWidth=_a.width,nodeHeight=_a.height;node.x<minNodeX&&(minNodeX=node.x),node.y<minNodeY&&(minNodeY=node.y),node.x+nodeWidth>maxNodeX&&(maxNodeX=node.x+nodeWidth),node.y+nodeHeight>maxNodeY&&(maxNodeY=node.y+nodeHeight),nodeWidth<minNodeWidth&&(minNodeWidth=nodeWidth),nodeHeight<minNodeHeight&&(minNodeHeight=nodeHeight)})),{minNodeWidth:minNodeWidth,minNodeHeight:minNodeHeight,minNodeX:minNodeX,minNodeY:minNodeY,maxNodeX:maxNodeX,maxNodeY:maxNodeY}},getScaleRange=function getScaleRange(params,_a){var minNodeWidth=_a.width,minNodeHeight=_a.height,_b=function normalizeNodeVisibleMinMax(_a){var nodeMinVisibleSize=_a.nodeMinVisibleSize,nodeMaxVisibleSize=_a.nodeMaxVisibleSize,nodeMinVisibleWidth=nodeMinVisibleSize.width,nodeMinVisibleHeight=nodeMinVisibleSize.height,nodeMaxVisibleWidth=nodeMaxVisibleSize.width,nodeMaxVisibleHeight=nodeMaxVisibleSize.height;if(nodeMinVisibleWidth>nodeMaxVisibleWidth){var temp=nodeMinVisibleWidth;nodeMinVisibleWidth=nodeMaxVisibleWidth,nodeMaxVisibleWidth=temp}if(nodeMinVisibleHeight>nodeMaxVisibleHeight){temp=nodeMinVisibleHeight;nodeMinVisibleHeight=nodeMaxVisibleHeight,nodeMaxVisibleHeight=temp}return{nodeMinVisibleWidth:nodeMinVisibleWidth,nodeMinVisibleHeight:nodeMinVisibleHeight,nodeMaxVisibleWidth:nodeMaxVisibleWidth,nodeMaxVisibleHeight:nodeMaxVisibleHeight}}(params),nodeMinVisibleWidth=_b.nodeMinVisibleWidth,nodeMinVisibleHeight=_b.nodeMinVisibleHeight,nodeMaxVisibleWidth=_b.nodeMaxVisibleWidth,nodeMaxVisibleHeight=_b.nodeMaxVisibleHeight,minScaleX=0,minScaleY=0,maxScaleX=1/0,maxScaleY=1/0;return minNodeWidth&&(minScaleX=nodeMinVisibleWidth/minNodeWidth,maxScaleX=nodeMaxVisibleWidth/minNodeWidth),minNodeHeight&&(minScaleY=nodeMinVisibleHeight/minNodeHeight,maxScaleY=nodeMaxVisibleHeight/minNodeHeight),{minScaleX:minScaleX,minScaleY:minScaleY,maxScaleX:maxScaleX,maxScaleY:maxScaleY}},viewport_getZoomFitMatrix=function getZoomFitMatrix(args){var data=args.data,graphConfig=args.graphConfig,disablePan=args.disablePan,direction=args.direction,rect=args.rect;if(0===data.nodes.size)return[1,0,0,1,0,0];var _a=viewport_getContentArea(data,graphConfig),minNodeWidth=_a.minNodeWidth,minNodeHeight=_a.minNodeHeight,minNodeX=_a.minNodeX,minNodeY=_a.minNodeY,maxNodeX=_a.maxNodeX,maxNodeY=_a.maxNodeY,_b=getScaleRange(args,{width:minNodeWidth,height:minNodeHeight}),minScaleX=_b.minScaleX,minScaleY=_b.minScaleY,maxScaleX=_b.maxScaleX,maxScaleY=_b.maxScaleY,spacing=function normalizeSpacing(spacing){return spacing?"number"==typeof spacing?{top:spacing,right:spacing,bottom:spacing,left:spacing}:Object(tslib_es6.a)({top:0,right:0,bottom:0,left:0},spacing):{top:0,right:0,bottom:0,left:0}}(args.spacing),width=rect.width,height=rect.height,scaleX=width/(maxNodeX-minNodeX+spacing.left+spacing.right),scaleY=height/(maxNodeY-minNodeY+spacing.top+spacing.bottom),scaleCommon=direction===Direction.Y?Math.min(Math.max(minScaleX,minScaleY,scaleY),maxScaleX,maxScaleY):Math.min(Math.max(minScaleX,minScaleY,Math.min(scaleX,scaleY)),maxScaleY,maxScaleY),newScaleX=direction===Direction.XY?Math.min(Math.max(minScaleX,scaleX),maxScaleX):scaleCommon,newScaleY=direction===Direction.XY?Math.min(Math.max(minScaleY,scaleY),maxScaleY):scaleCommon;if(disablePan)return[newScaleX,0,0,newScaleY,0,0];var dx=-newScaleX*(minNodeX-spacing.left),dy=-newScaleY*(minNodeY-spacing.top);if(getVisibleNodes(data.nodes,{rect:rect,transformMatrix:[newScaleX,0,0,newScaleY,dx,dy]},graphConfig).length>0)return[newScaleX,0,0,newScaleY,dx,dy];var focusNode=data.nodes.first();return focusNode&&data.nodes.forEach((function(node){focusNode.y>node.y&&(focusNode=node)})),[newScaleX,0,0,newScaleY,-newScaleX*(focusNode.x-spacing.left),-newScaleY*(focusNode.y-spacing.top)]},viewport_focusArea=function focusArea(minX,minY,maxX,maxY,viewport){var width=maxX-minX,height=maxY-minY,scale=Math.min(viewport.rect.width/width,viewport.rect.height/height),dx=-scale*(minX+width/2)+viewport.rect.width/2,dy=-scale*(minY+height/2)+viewport.rect.height/2;return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:[scale,0,0,scale,dx,dy]})};function getContainerCenter(rectRef){var rect=rectRef.current;if(rect)return{x:rect.width/2,y:rect.height/2}}function getRelativePoint(rect,e){return{x:e.clientX-rect.left,y:e.clientY-rect.top}}var viewport_scrollIntoView=function scrollIntoView(x,y,rect,alwaysScroll,position){if(!rect)return identical;var width=rect.width,height=rect.height;return x<0||x>width||y<0||y>height||alwaysScroll?function(prevState){var dx=position?position.x-x:width/2-x,dy=position?position.y-y:height/2-y;return Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{transformMatrix:[prevState.transformMatrix[0],prevState.transformMatrix[1],prevState.transformMatrix[2],prevState.transformMatrix[3],prevState.transformMatrix[4]+dx,prevState.transformMatrix[5]+dy]})}:identical},getScaleLimit=function getScaleLimit(data,settings){var _a=viewport_getContentArea(data,settings.graphConfig),minNodeWidth=_a.minNodeWidth,minNodeHeight=_a.minNodeHeight,_b=getScaleRange(settings,{width:minNodeWidth,height:minNodeHeight}),minScaleX=_b.minScaleX,minScaleY=_b.minScaleY;return Math.max(minScaleX,minScaleY)},is=(__webpack_require__(825),__webpack_require__(421),function(){function Task(name,cost,dependencies){var _this=this;this.dependencies=new Set,this.name=name,this.cost=cost,null==dependencies||dependencies.forEach((function(t){_this.dependencies.add(t)})),this.earlyFinish=-1}Task.prototype.isDependent=function(t){return!!this.dependencies.has(t)||Array.from(this.dependencies).some((function(dep){return dep.isDependent(t)}))}}(),__webpack_require__(448),__webpack_require__(280),Object.is),memoize_shallowEqual=function shallowEqual(a,b){if(!a)return!1;if(a.length!==b.length)return!1;for(var i=0;i<a.length;i+=1)if(!is(a[i],b[i]))return!1;return!0};var getOffsetLimit_getContentArea=function memoize(f){var prev,value;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return memoize_shallowEqual(prev,args)?value:(prev=args,value=f.apply(void 0,args))}}(viewport_getContentArea),getOffsetLimit_getOffsetLimit=function getOffsetLimit(_a){var _b,_c,_d,_e,data=_a.data,graphConfig=_a.graphConfig,rect=_a.rect,transformMatrix=_a.transformMatrix,canvasBoundaryPadding=_a.canvasBoundaryPadding,groupPadding=_a.groupPadding,contentArea=getOffsetLimit_getContentArea(data,graphConfig),nodeMin=getClientDeltaByPointDelta(contentArea.minNodeX-((null==groupPadding?void 0:groupPadding.left)||0),contentArea.minNodeY-((null==groupPadding?void 0:groupPadding.top)||0),transformMatrix);nodeMin.x-=null!==(_b=null==canvasBoundaryPadding?void 0:canvasBoundaryPadding.left)&&void 0!==_b?_b:0,nodeMin.y-=null!==(_c=null==canvasBoundaryPadding?void 0:canvasBoundaryPadding.top)&&void 0!==_c?_c:0;var nodeMax=getClientDeltaByPointDelta(contentArea.maxNodeX+((null==groupPadding?void 0:groupPadding.right)||0),contentArea.maxNodeY+((null==groupPadding?void 0:groupPadding.bottom)||0),transformMatrix);nodeMax.x+=null!==(_d=null==canvasBoundaryPadding?void 0:canvasBoundaryPadding.right)&&void 0!==_d?_d:0,nodeMax.y+=null!==(_e=null==canvasBoundaryPadding?void 0:canvasBoundaryPadding.bottom)&&void 0!==_e?_e:0;var minX=-nodeMin.x||0,minY=-nodeMin.y||0,maxX=rect.width-nodeMax.x||0,maxY=rect.height-nodeMax.y||0;if(maxX<minX){var temp=maxX;maxX=minX,minX=temp}if(maxY<minY){temp=maxY;maxY=minY,minY=temp}return{minX:minX,minY:minY,maxX:maxX,maxY:maxY}};__webpack_require__(121);function isDef(v){return null!=v}var debounce_debounce=function debounce(callback,timeout,options){var firstInvokeTime,_a=options||{},instance=_a.instance,maxWait=_a.maxWait,timer=0;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(window.clearTimeout(timer),isDef(maxWait)){var now=Date.now();if(isDef(firstInvokeTime)){if(now-firstInvokeTime>=maxWait)return firstInvokeTime=void 0,void invokeCallback(args)}else firstInvokeTime=now}timer=window.setTimeout((function(){invokeCallback(args)}),timeout)};function invokeCallback(args){callback.apply(instance,args)}};var emptyArrayInstance=[];function stopPropagation(e){e.stopPropagation()}function clamp(min,max,value){return min>value?min:max<value?max:value}var history_pushHistory=function pushHistory(history,data,mapPresent){return void 0===mapPresent&&(mapPresent=identical),{present:data,past:{next:history.past,value:mapPresent(history.present)},future:null}},undo=function undo(history){return history.past?{present:history.past.value,past:history.past.next,future:{next:history.future,value:history.present}}:history},redo=function redo(history){return history.future?{present:history.future.value,past:{next:history.past,value:history.present},future:history.future.next}:history},resetUndoStack=function resetUndoStack(data){return{present:data,future:null,past:null}},RectComponent_RectComponent=function RectComponent(props){var style=props.style,node=props.node,width=props.width,height=props.height,textY=props.textY,comment=node.data&&node.data.comment?node.data.comment:"",isEditing=state_isNodeEditing(node);return react.createElement("g",{key:node.id},react.createElement("rect",{width:width,height:height,x:node.x,y:node.y,style:style,rx:style.borderRadius}),react.createElement("text",{x:node.x,y:textY,fontSize:12},node.name),node.data&&node.data.comment&&!isEditing&&react.createElement("text",{x:node.x,y:textY+20,fontSize:12,className:"comment-"+node.id},node.data.comment),isEditing&&react.createElement("foreignObject",{x:node.x,y:textY,height:height/2.5,width:width-5},react.createElement("input",{value:comment,placeholder:"Input your comment here"})))};try{RectComponent_RectComponent.displayName="RectComponent",RectComponent_RectComponent.__docgenInfo={description:"",displayName:"RectComponent",props:{style:{defaultValue:null,description:"",name:"style",required:!0,type:{name:"CSSProperties"}},node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"ICanvasNode<any, unknown>"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},textY:{defaultValue:null,description:"",name:"textY",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/built-in/RectComponent.tsx#RectComponent"]={docgenInfo:RectComponent_RectComponent.__docgenInfo,name:"RectComponent",path:"src/built-in/RectComponent.tsx#RectComponent"})}catch(__react_docgen_typescript_loader_error){}var rect_rect={getMinHeight:function getMinHeight(){return 150},getMinWidth:function getMinWidth(){return 150},getStyle:function getStyle(node,theme){return hasState(GraphNodeState.selected|GraphNodeState.activated)(node.state)?{fill:theme.nodeActivateFill,stroke:theme.nodeActivateStroke}:{fill:theme.nodeFill,fillOpacity:.1,stroke:theme.nodeStroke,borderRadius:"5"}},render:function render(args){var node=args.model,width=getRectWidth(rect_rect,node),height=getRectHeight(rect_rect,node),style=rect_rect.getStyle?rect_rect.getStyle(node,args.theme):{},textY=node.y+height/3;return react.createElement(RectComponent_RectComponent,{style:style,node:node,width:width,height:height,textY:textY})}},line_line={getStyle:function getStyle(edge,theme){return{cursor:"crosshair",stroke:hasState(GraphEdgeState.selected)(edge.state)?theme.edgeColorSelected:theme.edgeColor,strokeWidth:"2"}},render:function render(args){var edge=args.model,style=line_line.getStyle?line_line.getStyle(edge,args.theme):{};return react.createElement("path",{key:edge.id,d:getCurvePathD(args.x2,args.x1,args.y2,args.y1),fill:"none",style:style,id:"edge"+edge.id})}},defaultPort=new(function(){function DefaultPort(){}return DefaultPort.prototype.getStyle=function(port,parentNode,data,theme,connectedAsSource,connectedAsTarget){var stroke=theme.portStroke,fill=theme.portFill;return(connectedAsSource||connectedAsTarget)&&(fill=theme.connectedPortColor),hasState(GraphPortState.activated)(port.state)&&(fill=theme.primaryColor),{stroke:stroke,fill:fill}},DefaultPort.prototype.getIsConnectable=function(){return!0},DefaultPort.prototype.render=function(args){var port=args.model,data=args.data,parentNode=args.parentNode,connectedAsSource=data.isPortConnectedAsSource(parentNode.id,port.id),connectedAsTarget=data.isPortConnectedAsTarget(parentNode.id,port.id),style=this.getStyle(port,parentNode,data,args.theme,connectedAsSource,connectedAsTarget),x=args.x,y=args.y,polygonPoints=x-5+" "+y+", "+(x+7)+" "+y+", "+(x+1)+" "+(y+8);return react.createElement(react.Fragment,null,connectedAsTarget?react.createElement("polygon",{points:polygonPoints,style:style}):react.createElement("circle",{key:args.parentNode.id+"-"+args.model.id,r:5,cx:x,cy:y,style:style}))},DefaultPort}()),v4=__webpack_require__(836),defaultClipboard_DefaultClipboard=function(){function DefaultClipboard(storage){this.storage=storage}return DefaultClipboard.prototype.write=function(data){this.storage.setItem("graph-clipboard",JSON.stringify({nodes:data.nodes.map((function(n){return Object(tslib_es6.a)(Object(tslib_es6.a)({},n),{data:{}})})),edges:data.edges.map((function(e){return Object(tslib_es6.a)(Object(tslib_es6.a)({},e),{data:{}})}))}))},DefaultClipboard.prototype.read=function(){var str=this.storage.getItem("graph-clipboard");if(!str)return null;try{var data=JSON.parse(str),nodeIdHash_1=new Map;return{nodes:data.nodes.map((function(n){var newId=v4.a();return nodeIdHash_1.set(n.id,newId),Object(tslib_es6.a)(Object(tslib_es6.a)({},n),{x:n.x+50,y:n.y+50,id:newId})})),edges:data.edges.map((function(e){return Object(tslib_es6.a)(Object(tslib_es6.a)({},e),{id:v4.a(),source:nodeIdHash_1.get(e.source)||"",target:nodeIdHash_1.get(e.target)||""})}))}}catch(error){return null}},DefaultClipboard}(),DefaultStorage=function(){function DefaultStorage(){this.key=function(){return"DefaultLocalStorage"},this.items={}}return Object.defineProperty(DefaultStorage.prototype,"length",{get:function get(){return Object.keys(this.items||{}).length},enumerable:!1,configurable:!0}),DefaultStorage.prototype.clear=function(){this.items={}},DefaultStorage.prototype.setItem=function(key,data){this.items[key]=data},DefaultStorage.prototype.getItem=function(key){return this.items[key]},DefaultStorage.prototype.removeItem=function(key){this.items[key]=void 0},DefaultStorage}();__webpack_require__(422);var MenuType,defaultGroup={render:function Renderer(props){return react.createElement("rect",{height:props.height,width:props.width,fill:props.group.fill})}},GraphConfig=function(){function GraphConfig(defaultEdgeShape,defaultNodeShape,defaultPortShape,defaultGroupShape,nodeConfigMap,edgeConfigMap,portConfigMap,groupConfigMap,clipboard){this.defaultEdgeShape=defaultEdgeShape,this.defaultNodeShape=defaultNodeShape,this.defaultPortShape=defaultPortShape,this.defaultGroupShape=defaultGroupShape,this.nodeConfigMap=nodeConfigMap,this.edgeConfigMap=edgeConfigMap,this.portConfigMap=portConfigMap,this.groupConfigMap=groupConfigMap,this.clipboard=clipboard}return GraphConfig.prototype.getClipboard=function(){return this.clipboard},GraphConfig.prototype.getEdgeConfigByName=function(name){return this.edgeConfigMap.get(name||this.defaultEdgeShape)},GraphConfig.prototype.getGroupConfigByName=function(name){return this.groupConfigMap.get(name||this.defaultGroupShape)},GraphConfig.prototype.getNodeConfigByName=function(name){return this.nodeConfigMap.get(name||this.defaultNodeShape)},GraphConfig.prototype.getPortConfigByName=function(name){return this.portConfigMap.get(name||this.defaultPortShape)},GraphConfig}(),GraphConfigBuilder_GraphConfigBuilder=function(){function GraphConfigBuilder(defaultEdgeShape,defaultNodeShape,defaultPortShape,defaultGroupShape,nodeConfigMap,edgeConfigMap,portConfigMap,groupConfigMap,clipboard){this.defaultEdgeShape=defaultEdgeShape,this.defaultNodeShape=defaultNodeShape,this.defaultPortShape=defaultPortShape,this.defaultGroupShape=defaultGroupShape,this.nodeConfigMap=nodeConfigMap,this.edgeConfigMap=edgeConfigMap,this.portConfigMap=portConfigMap,this.groupConfigMap=groupConfigMap,this.clipboard=clipboard}return GraphConfigBuilder.default=function(){return new GraphConfigBuilder("default","default","default","default",(new Map).set("default",rect_rect),(new Map).set("default",line_line),(new Map).set("default",defaultPort),(new Map).set("default",defaultGroup),new defaultClipboard_DefaultClipboard(new DefaultStorage))},GraphConfigBuilder.from=function(graphConfig){return new GraphConfigBuilder(graphConfig.defaultEdgeShape,graphConfig.defaultNodeShape,graphConfig.defaultPortShape,graphConfig.defaultGroupShape,new Map(graphConfig.nodeConfigMap),new Map(graphConfig.edgeConfigMap),new Map(graphConfig.portConfigMap),new Map(graphConfig.groupConfigMap),graphConfig.clipboard)},GraphConfigBuilder.prototype.withDefaultEdgeShape=function(shape){return this.defaultEdgeShape=shape,this},GraphConfigBuilder.prototype.withDefaultNodeShape=function(shape){return this.defaultNodeShape=shape,this},GraphConfigBuilder.prototype.withDefaultPortShape=function(shape){return this.defaultPortShape=shape,this},GraphConfigBuilder.prototype.withDefaultGroupShape=function(shape){return this.defaultGroupShape=shape,this},GraphConfigBuilder.prototype.withClipboard=function(clipboard){return this.clipboard=clipboard,this},GraphConfigBuilder.prototype.registerNode=function(name,config){return this.nodeConfigMap.set(name,config),this},GraphConfigBuilder.prototype.registerEdge=function(name,config){return this.edgeConfigMap.set(name,config),this},GraphConfigBuilder.prototype.registerPort=function(name,config){return this.portConfigMap.set(name,config),this},GraphConfigBuilder.prototype.registerGroup=function(name,config){return this.groupConfigMap.set(name,config),this},GraphConfigBuilder.prototype.build=function(){return new GraphConfig(this.defaultEdgeShape,this.defaultNodeShape,this.defaultPortShape,this.defaultGroupShape,new Map(this.nodeConfigMap),new Map(this.edgeConfigMap),new Map(this.portConfigMap),new Map(this.groupConfigMap),this.clipboard)},GraphConfigBuilder}(),GraphConfigContext=Object(react.createContext)(GraphConfigBuilder_GraphConfigBuilder.default().build());!function(MenuType){MenuType.Node="node",MenuType.Edge="edge",MenuType.Port="port",MenuType.Canvas="canvas",MenuType.Multi="multi"}(MenuType||(MenuType={}));var GraphFeatures,ContextMenuConfigContext_ContextMenuConfig=function(){function ContextMenuConfig(){this.contextMenu={}}return ContextMenuConfig.prototype.registerContextMenu=function(props){this.contextMenuProps=Object(tslib_es6.a)({},props)},ContextMenuConfig.prototype.registerMenu=function(element,menuType){this.contextMenu[menuType]=element},ContextMenuConfig.prototype.getMenu=function(menuType){if(this.contextMenuProps&&this.contextMenu[menuType]){var _a=this.contextMenuProps,className=_a.className,styles=_a.styles;return react.createElement("div",{className:className,style:styles},this.contextMenu[menuType])}return null},ContextMenuConfig}(),ContextMenuConfigContext=react.createContext(new ContextMenuConfigContext_ContextMenuConfig),ThemeContext=react.createContext({theme:{},setTheme:function setTheme(){}}),useTheme_useTheme=function useTheme(){return react.useContext(ThemeContext)},SelectBox_SelectBox=function SelectBox(props){var selectBoxPosition=props.selectBoxPosition,style=props.style,theme=useTheme_useTheme().theme,selectBoxD="m"+selectBoxPosition.startX+" "+selectBoxPosition.startY+" v "+selectBoxPosition.height+" h "+selectBoxPosition.width+" v"+-selectBoxPosition.height+" h "+-selectBoxPosition.width,pathStyle=null!=style?style:{fill:"none",stroke:theme.defaultColor};return react.createElement("path",{style:pathStyle,d:selectBoxD})};try{SelectBox_SelectBox.displayName="SelectBox",SelectBox_SelectBox.__docgenInfo={description:"",displayName:"SelectBox",props:{selectBoxPosition:{defaultValue:null,description:"",name:"selectBoxPosition",required:!0,type:{name:"ISelectBoxPosition"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Graph/SelectBox.tsx#SelectBox"]={docgenInfo:SelectBox_SelectBox.__docgenInfo,name:"SelectBox",path:"src/components/Graph/SelectBox.tsx#SelectBox"})}catch(__react_docgen_typescript_loader_error){}!function(GraphFeatures){GraphFeatures.nodeDraggable="nodeDraggable",GraphFeatures.nodeResizable="nodeResizable",GraphFeatures.clickNodeToSelect="clickNodeToSelect",GraphFeatures.panCanvas="panCanvas",GraphFeatures.multipleSelect="multipleSelect",GraphFeatures.lassoSelect="lassoSelect",GraphFeatures.delete="delete",GraphFeatures.addNewNodes="addNewNodes",GraphFeatures.addNewEdges="addNewEdges",GraphFeatures.addNewPorts="addNewPorts",GraphFeatures.autoFit="autoFit",GraphFeatures.canvasHorizontalScrollable="canvasHorizontalScrollable",GraphFeatures.canvasVerticalScrollable="canvasVerticalScrollable",GraphFeatures.nodeHoverView="nodeHoverView",GraphFeatures.portHoverView="portHoverView",GraphFeatures.addEdgesByKeyboard="addEdgesByKeyboard",GraphFeatures.a11yFeatures="a11yFeatures",GraphFeatures.editNode="editNode",GraphFeatures.autoAlign="autoAlign",GraphFeatures.undoStack="undoStack",GraphFeatures.ctrlKeyZoom="ctrlKeyZoom",GraphFeatures.limitBoundary="limitBoundary",GraphFeatures.editEdge="editEdge"}(GraphFeatures||(GraphFeatures={}));new Set([GraphFeatures.nodeDraggable,GraphFeatures.nodeResizable,GraphFeatures.clickNodeToSelect,GraphFeatures.panCanvas,GraphFeatures.multipleSelect,GraphFeatures.lassoSelect,GraphFeatures.delete,GraphFeatures.addNewNodes,GraphFeatures.addNewEdges,GraphFeatures.addNewPorts,GraphFeatures.canvasHorizontalScrollable,GraphFeatures.canvasVerticalScrollable,GraphFeatures.nodeHoverView,GraphFeatures.portHoverView,GraphFeatures.addEdgesByKeyboard,GraphFeatures.a11yFeatures,GraphFeatures.autoFit,GraphFeatures.editNode,GraphFeatures.autoAlign,GraphFeatures.undoStack,GraphFeatures.ctrlKeyZoom,GraphFeatures.limitBoundary,GraphFeatures.editEdge]);var NodeType,defaultFeatures=new Set([GraphFeatures.nodeDraggable,GraphFeatures.nodeResizable,GraphFeatures.clickNodeToSelect,GraphFeatures.panCanvas,GraphFeatures.multipleSelect,GraphFeatures.delete,GraphFeatures.addNewNodes,GraphFeatures.addNewEdges,GraphFeatures.addNewPorts,GraphFeatures.canvasHorizontalScrollable,GraphFeatures.canvasVerticalScrollable,GraphFeatures.nodeHoverView,GraphFeatures.portHoverView,GraphFeatures.addEdgesByKeyboard,GraphFeatures.a11yFeatures,GraphFeatures.editNode,GraphFeatures.autoAlign,GraphFeatures.undoStack,GraphFeatures.ctrlKeyZoom,GraphFeatures.limitBoundary]),utils_is=(new Set([GraphFeatures.nodeDraggable,GraphFeatures.nodeResizable,GraphFeatures.clickNodeToSelect,GraphFeatures.panCanvas,GraphFeatures.multipleSelect,GraphFeatures.canvasHorizontalScrollable,GraphFeatures.canvasVerticalScrollable,GraphFeatures.nodeHoverView,GraphFeatures.portHoverView,GraphFeatures.a11yFeatures,GraphFeatures.ctrlKeyZoom,GraphFeatures.limitBoundary]),new Set([GraphFeatures.clickNodeToSelect,GraphFeatures.canvasHorizontalScrollable,GraphFeatures.canvasVerticalScrollable,GraphFeatures.nodeHoverView,GraphFeatures.portHoverView,GraphFeatures.a11yFeatures,GraphFeatures.lassoSelect,GraphFeatures.limitBoundary]),new Set([GraphFeatures.nodeHoverView,GraphFeatures.portHoverView,GraphFeatures.autoFit]),__webpack_require__(423),__webpack_require__(281),__webpack_require__(282),__webpack_require__(54),__webpack_require__(196),__webpack_require__(277),Object.is),MapIterator=function(){function MapIterator(upstream,f){this.upstream=upstream,this.f=f}return MapIterator.prototype[Symbol.iterator]=function(){return this},MapIterator.prototype.next=function(){var next=this.upstream.next();return next.done?next:{done:!1,value:this.f(next.value)}},MapIterator}();!function(NodeType){NodeType[NodeType.Bitmap=0]="Bitmap",NodeType[NodeType.Collision=1]="Collision"}(NodeType||(NodeType={}));function bitPosFrom(mask){return 1<<mask}function indexFrom(bitmap,mask,bitPos){return 1073741823===bitmap?mask:bitCount(bitmap&bitPos-1)}function maskFrom(hash,shift){return hash>>>shift&31}function bitCount(x){return x|=0,x=(x=(858993459&(x-=x>>>1&1431655765))+(x>>>2&858993459))+(x>>>4)&252645135,x+=x>>>8,127&(x+=x>>>16)}var champ_BitmapIndexedNode=function(){function BitmapIndexedNode(owner,dataMap,nodeMap,keys,values,children,hashes,size){this.type=NodeType.Bitmap,this.owner=owner,this.dataMap=dataMap,this.nodeMap=nodeMap,this.keys=keys,this.values=values,this.children=children,this.hashes=hashes,this.size=size}return Object.defineProperty(BitmapIndexedNode.prototype,"valueCount",{get:function get(){return this.values.length},enumerable:!1,configurable:!0}),Object.defineProperty(BitmapIndexedNode.prototype,"nodeCount",{get:function get(){return this.children.length},enumerable:!1,configurable:!0}),BitmapIndexedNode.empty=function(owner){return new BitmapIndexedNode(owner,0,0,[],[],[],[],0)},BitmapIndexedNode.prototype.getKey=function(index){return this.keys[index]},BitmapIndexedNode.prototype.getValue=function(index){return this.values[index]},BitmapIndexedNode.prototype.getHash=function(index){return this.hashes[index]},BitmapIndexedNode.prototype.getNode=function(index){return this.children[index]},BitmapIndexedNode.prototype.contains=function(key,keyHash,shift){var mask=maskFrom(keyHash,shift),bitPos=bitPosFrom(mask),dataMap=this.dataMap,nodeMap=this.nodeMap;if(0!=(dataMap&bitPos)){var index=indexFrom(dataMap,mask,bitPos),key0=this.getKey(index);return utils_is(key0,key)}if(0!=(nodeMap&bitPos)){index=indexFrom(nodeMap,mask,bitPos);return this.getNode(index).contains(key,keyHash,shift+5)}return!1},BitmapIndexedNode.prototype.get=function(key,keyHash,shift){var mask=maskFrom(keyHash,shift),bitPos=bitPosFrom(mask),dataMap=this.dataMap,nodeMap=this.nodeMap;if(0!=(dataMap&bitPos)){var index=indexFrom(dataMap,mask,bitPos),key0=this.getKey(index);return utils_is(key0,key)?this.getValue(index):void 0}if(0!=(nodeMap&bitPos)){index=indexFrom(nodeMap,mask,bitPos);return this.getNode(index).get(key,keyHash,shift+5)}},BitmapIndexedNode.prototype.insert=function(owner,key,value,hash,shift){var mask=maskFrom(hash,shift),bitPos=bitPosFrom(mask),dataMap=this.dataMap,nodeMap=this.nodeMap;if(0!=(dataMap&bitPos)){var index=indexFrom(dataMap,mask,bitPos),key0=this.getKey(index),value0=this.getValue(index),key0Hash=this.getHash(index);if(key0Hash===hash&&utils_is(key0,key))return utils_is(value0,value)?this:this.setValue(owner,value,index);var subNodeNew=function mergeTwoKeyValPairs(owner,key0,value0,keyHash0,key1,value1,keyHash1,shift){if(shift>=30)return new champ_HashCollisionNode(owner,keyHash0,[key0,key1],[value0,value1]);var mask0=maskFrom(keyHash0,shift),mask1=maskFrom(keyHash1,shift);if(mask0!==mask1){var dataMap=bitPosFrom(mask0)|bitPosFrom(mask1);return mask0<mask1?new champ_BitmapIndexedNode(owner,dataMap,0,[key0,key1],[value0,value1],[],[keyHash0,keyHash1],2):new champ_BitmapIndexedNode(owner,dataMap,0,[key1,key0],[value1,value0],[],[keyHash1,keyHash0],2)}var nodeMap=bitPosFrom(mask0),node=mergeTwoKeyValPairs(owner,key0,value0,keyHash0,key1,value1,keyHash1,shift+5);return new champ_BitmapIndexedNode(owner,0,nodeMap,[],[],[node],[],node.size)}(owner,key0,value0,key0Hash,key,value,hash,shift+5);return this.migrateInlineToNode(owner,bitPos,subNodeNew)}if(0!=(nodeMap&bitPos)){index=indexFrom(nodeMap,mask,bitPos),subNodeNew=this.getNode(index).insert(owner,key,value,hash,shift+5);return this.setNode(owner,1,subNodeNew,bitPos)}return this.insertValue(owner,bitPos,key,hash,value)},BitmapIndexedNode.prototype.update=function(owner,key,updater,hash,shift){var mask=maskFrom(hash,shift),bitPos=bitPosFrom(mask),dataMap=this.dataMap,nodeMap=this.nodeMap;if(0!=(dataMap&bitPos)){var index=indexFrom(dataMap,mask,bitPos),key0=this.getKey(index);if(this.getHash(index)===hash&&utils_is(key0,key)){var value0=this.getValue(index),value=updater(value0);return utils_is(value0,value)?this:this.setValue(owner,value,index)}}else if(0!=(nodeMap&bitPos)){index=indexFrom(nodeMap,mask,bitPos);var subNode=this.getNode(index),subNodeNew=subNode.update(owner,key,updater,hash,shift+5);return subNodeNew===subNode?this:this.setNode(owner,0,subNodeNew,bitPos)}return this},BitmapIndexedNode.prototype.remove=function(owner,key,keyHash,shift){var mask=maskFrom(keyHash,shift),bitPos=bitPosFrom(mask);if(0!=(this.dataMap&bitPos)){var index=indexFrom(this.dataMap,mask,bitPos),key0=this.getKey(index);return utils_is(key0,key)?this.removeValue(owner,bitPos):void 0}if(0!=(this.nodeMap&bitPos)){index=indexFrom(this.nodeMap,mask,bitPos);var subNode=this.getNode(index),remove=subNode.remove(owner,key,keyHash,shift+5);if(void 0===remove)return;var subNodeNew=remove[0],removedValue=remove[1];return 1===subNodeNew.size?this.size===subNode.size?[new BitmapIndexedNode(owner,bitPos,0,[subNodeNew.getKey(0)],[subNodeNew.getValue(0)],[],[subNodeNew.getHash(0)],1),removedValue]:[this.migrateNodeToInline(owner,bitPos,subNodeNew),removedValue]:[this.setNode(owner,-1,subNodeNew,bitPos),removedValue]}},BitmapIndexedNode.prototype.toOwned=function(owner){return this.owner===owner?this:new BitmapIndexedNode(owner,this.dataMap,this.nodeMap,this.keys.slice(),this.values.slice(),this.children.slice(),this.hashes.slice(),this.size)},BitmapIndexedNode.prototype.iter=function(){return new BitmapIndexedNodeIterator(this)},BitmapIndexedNode.prototype.map=function(owner,f){for(var valueCount=this.valueCount,keys=[],values=[],children=[],same=!0,i=0;i<valueCount;i+=1){var key=this.getKey(i),value0=this.getValue(i),value=f(value0,key);same=same&&utils_is(value0,value),keys.push(key),values.push(value)}for(i=0;i<this.children.length;i+=1){var node0=this.getNode(i),node=node0.map(owner,f);same=same&&node===node0,children.push(node)}return same?this:new BitmapIndexedNode(owner,this.dataMap,this.nodeMap,keys,values,children,this.hashes,this.size)},BitmapIndexedNode.prototype.forEach=function(f){for(var i=0;i<this.values.length;i+=1){var key=this.getKey(i);f(this.getValue(i),key)}for(i=0;i<this.children.length;i+=1){this.getNode(i).forEach(f)}},BitmapIndexedNode.prototype.find=function(predicate){for(var i=0;i<this.values.length;i+=1){var value=this.getValue(i);if(predicate(value))return value}for(i=0;i<this.children.length;i+=1){var found=this.getNode(i).find(predicate);if(found)return found}},BitmapIndexedNode.prototype.dataIndex=function(bitPos){return bitCount(this.dataMap&bitPos-1)},BitmapIndexedNode.prototype.nodeIndex=function(bitPos){return bitCount(this.nodeMap&bitPos-1)},BitmapIndexedNode.prototype.setValue=function(owner,value,index){var next=this.toOwned(owner);return next.values[index]=value,next},BitmapIndexedNode.prototype.insertValue=function(owner,bitPos,key,originalHash,value){var index=this.dataIndex(bitPos),next=this.toOwned(owner);return next.size+=1,next.dataMap|=bitPos,next.keys.splice(index,0,key),next.values.splice(index,0,value),next.hashes.splice(index,0,originalHash),next},BitmapIndexedNode.prototype.migrateInlineToNode=function(owner,bitPos,child){var indexOld=this.dataIndex(bitPos),indexNew=this.nodeIndex(bitPos),next=this.toOwned(owner);return next.dataMap^=bitPos,next.nodeMap|=bitPos,next.keys.splice(indexOld,1),next.values.splice(indexOld,1),next.children.splice(indexNew,0,child),next.hashes.splice(indexOld,1),next.size+=1,next},BitmapIndexedNode.prototype.migrateNodeToInline=function(owner,bitPos,node){var indexOld=this.nodeIndex(bitPos),indexNew=this.dataIndex(bitPos),key=node.getKey(0),value=node.getValue(0),hash=node.getHash(0),next=this.toOwned(owner);return next.dataMap=next.dataMap|bitPos,next.nodeMap=next.nodeMap^bitPos,next.children.splice(indexOld,1),next.keys.splice(indexNew,0,key),next.values.splice(indexNew,0,value),next.size-=1,next.hashes.splice(indexNew,0,hash),next},BitmapIndexedNode.prototype.setNode=function(owner,sizeDelta,newNode,bitPos){var index=this.nodeIndex(bitPos),next=this.toOwned(owner);return next.children[index]=newNode,next.size=next.size+sizeDelta,next},BitmapIndexedNode.prototype.removeValue=function(owner,bitPos){var index=this.dataIndex(bitPos),value=this.getValue(index),next=this.toOwned(owner);return next.dataMap^=bitPos,next.keys.splice(index,1),next.values.splice(index,1),next.hashes.splice(index,1),next.size-=1,[next,value]},BitmapIndexedNode}();var champ_HashCollisionNode=function(){function HashCollisionNode(owner,hash,keys,values){this.type=NodeType.Collision,this.owner=owner,this.hash=hash,this.keys=keys,this.values=values}return Object.defineProperty(HashCollisionNode.prototype,"size",{get:function get(){return this.keys.length},enumerable:!1,configurable:!0}),HashCollisionNode.prototype.toOwned=function(owner){return this.owner===owner?this:new HashCollisionNode(owner,this.hash,this.keys.slice(),this.values.slice())},HashCollisionNode.prototype.contains=function(key){return this.keys.includes(key)},HashCollisionNode.prototype.get=function(key){var index=this.keys.findIndex((function(it){return utils_is(it,key)}));return index>=0?this.values[index]:void 0},HashCollisionNode.prototype.insert=function(owner,key,value){var index=this.keys.findIndex((function(it){return utils_is(it,key)}));if(index>=0){var next,value0=this.values[index];return utils_is(value0,value)?this:((next=this.toOwned(owner)).values[index]=value,next)}return(next=this.toOwned(owner)).keys.push(key),next.values.push(value),next},HashCollisionNode.prototype.update=function(owner,key,updater){var index=this.keys.findIndex((function(it){return utils_is(it,key)}));if(index>=0){var value0=this.values[index],value=updater(value0);if(utils_is(value0,value))return this;var next=this.toOwned(owner);return next.values[index]=value,next}return this},HashCollisionNode.prototype.remove=function(owner,key){var index=this.keys.findIndex((function(it){return utils_is(it,key)}));if(-1!==index){var value=this.getValue(index);return[new HashCollisionNode(owner,this.hash,this.keys.filter((function(_,i){return i!==index})),this.values.filter((function(_,i){return i!==index}))),value]}},HashCollisionNode.prototype.getKey=function(index){return this.keys[index]},HashCollisionNode.prototype.getValue=function(index){return this.values[index]},HashCollisionNode.prototype.getHash=function(){return this.hash},HashCollisionNode.prototype.iter=function(){return new HashCollisionNodeIterator(this)},HashCollisionNode.prototype.map=function(owner,f){for(var len=this.size,values=[],update=!1,i=0;i<len;i+=1){var key=this.getKey(i),value0=this.getValue(i),value=f(value0,key);values.push(value),update=utils_is(value0,value)}return update?new HashCollisionNode(owner,this.hash,this.keys,values):this},HashCollisionNode.prototype.forEach=function(f){for(var len=this.size,i=0;i<len;i+=1){var key=this.getKey(i);f(this.getValue(i),key)}},HashCollisionNode.prototype.find=function(predicate){return this.values.find(predicate)},HashCollisionNode}(),BitmapIndexedNodeIterator=function(){function BitmapIndexedNodeIterator(node){this.index=0,this.delegate=null,this.done=!1,this.node=node,this.valueCount=node.valueCount,this.nodeCount=node.nodeCount,this.size=this.valueCount+this.nodeCount}return BitmapIndexedNodeIterator.prototype[Symbol.iterator]=function(){return this.clone()},BitmapIndexedNodeIterator.prototype.next=function(){if(this.done)return{done:!0,value:void 0};if(this.index<this.valueCount){var key=this.node.getKey(this.index),value=this.node.getValue(this.index);return this.index+=1,{done:!1,value:[key,value]}}if(this.index<this.size){null===this.delegate&&(this.delegate=this.node.getNode(this.index-this.valueCount).iter());var next=this.delegate.next();return next.done?(this.index+=1,this.delegate=null,this.next()):next}return this.done=!0,{done:!0,value:void 0}},BitmapIndexedNodeIterator.prototype.clone=function(){var iter=new BitmapIndexedNodeIterator(this.node);return iter.index=this.index,iter.delegate=this.delegate,iter.done=this.done,iter},BitmapIndexedNodeIterator}(),HashCollisionNodeIterator=function(){function HashCollisionNodeIterator(node){this.index=0,this.node=node}return HashCollisionNodeIterator.prototype[Symbol.iterator]=function(){return this.clone()},HashCollisionNodeIterator.prototype.next=function(){if(this.index>=this.node.size)return{done:!0,value:void 0};var key=this.node.getKey(this.index),value=this.node.getValue(this.index);return this.index+=1,{done:!1,value:[key,value]}},HashCollisionNodeIterator.prototype.clone=function(){var iter=new HashCollisionNodeIterator(this.node);return iter.index=this.index,iter},HashCollisionNodeIterator}();function hashing_typeof(obj){return(hashing_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function hashing(o){if(null===o)return 1108378658;switch(hashing_typeof(o)){case"boolean":return o?839943201:839943200;case"number":return function hashNumber(n){if(n!=n||n===1/0)return 0;var hash=0|n;hash!==n&&(hash^=4294967295*n);for(;n>4294967295;)hash^=n/=4294967295;return smi(hash)}(o);case"string":return hashString(o);case"object":case"function":case"symbol":throw new Error("Using object, function and symbol as hash map key is not supported");case"undefined":return 839943203;default:return hashString(String(o))}}function hashString(str){for(var hashed=0,ii=0;ii<str.length;ii++)hashed=31*hashed+str.charCodeAt(ii)|0;return smi(hashed)}function smi(value){return 1073741823&value}var b_tree_NodeType,Uid=function(){function Uid(){this.id=0}return Uid.prototype.take=function(){return this.id+=1,this.id},Uid.prototype.peek=function(){return this.id+1},Uid}(),uid=new Uid,hash_map_HashMap=function(){function HashMap(root){this.id=uid.take(),this.root=root}return Object.defineProperty(HashMap.prototype,"size",{get:function get(){return this.root.size},enumerable:!1,configurable:!0}),HashMap.empty=function(){return hash_map_HashMapBuilder.empty().finish()},HashMap.from=function(iterable){return hash_map_HashMapBuilder.from(iterable).finish()},HashMap.prototype.get=function(key){var h=hashing(key);return this.root.get(key,h,0)},HashMap.prototype.has=function(key){var h=hashing(key);return this.root.contains(key,h,0)},HashMap.prototype.set=function(key,value){return this.withRoot(this.root.insert(uid.peek(),key,value,hashing(key),0))},HashMap.prototype.update=function(key,updater){return this.withRoot(this.root.update(uid.peek(),key,updater,hashing(key),0))},HashMap.prototype.delete=function(key){var h=hashing(key),id=uid.peek(),remove=this.root.remove(id,key,h,0);return void 0===remove?this:new HashMap(remove[0])},HashMap.prototype.clone=function(){return new HashMap(this.root)},HashMap.prototype[Symbol.iterator]=function(){return this.entries()},HashMap.prototype.entries=function(){return this.root.iter()},HashMap.prototype.values=function(){return new MapIterator(this.entries(),(function(_a){return _a[1]}))},HashMap.prototype.mutate=function(){return new hash_map_HashMapBuilder(this.root)},HashMap.prototype.map=function(f){return new HashMap(this.root.map(uid.peek(),f))},HashMap.prototype.filter=function(predicate){var map=this.mutate();return this.forEach((function(value,key){predicate(value,key)||map.delete(key)})),map.finish()},HashMap.prototype.forEach=function(f){this.root.forEach(f)},HashMap.prototype.find=function(predicate){return this.root.find(predicate)},HashMap.prototype.withRoot=function(newRoot){return newRoot===this.root?this:new HashMap(newRoot)},HashMap}(),hash_map_HashMapBuilder=function(){function HashMapBuilder(root){this.id=uid.take(),this.root=root}return HashMapBuilder.empty=function(){var id=uid.peek();return new HashMapBuilder(champ_BitmapIndexedNode.empty(id))},HashMapBuilder.from=function(iterable){if(Array.isArray(iterable))return HashMapBuilder.fromArray(iterable);for(var iter=iterable[Symbol.iterator](),builder=HashMapBuilder.empty(),next=iter.next();!next.done;){var _a=next.value,key=_a[0],value=_a[1];builder.set(key,value),next=iter.next()}return builder},HashMapBuilder.fromArray=function(list){for(var builder=HashMapBuilder.empty(),i=0;i<list.length;i+=1){var _a=list[i],key=_a[0],value=_a[1];builder.set(key,value)}return builder},HashMapBuilder.prototype.get=function(key){var h=hashing(key);return this.root.get(key,h,0)},HashMapBuilder.prototype.has=function(key){var h=hashing(key);return this.root.contains(key,h,0)},HashMapBuilder.prototype.set=function(key,value){return this.root=this.root.insert(this.id,key,value,hashing(key),0),this},HashMapBuilder.prototype.update=function(key,updater){var h=hashing(key);return this.root=this.root.update(this.id,key,updater,h,0),this},HashMapBuilder.prototype.delete=function(key){var h=hashing(key),remove=this.root.remove(this.id,key,h,0);return void 0!==remove&&(this.root=remove[0]),this},HashMapBuilder.prototype.finish=function(){return new hash_map_HashMap(this.root)},HashMapBuilder}();!function(NodeType){NodeType[NodeType.Internal=0]="Internal",NodeType[NodeType.Leaf=1]="Leaf"}(b_tree_NodeType||(b_tree_NodeType={}));function binaryFind(list,key){for(var start=0,end=list.length;;){if(start+1===end)return list[start]>=key?start:end;var mid=start+end>>>1;if(list[mid]===key)return mid;key<list[mid]?end=mid:start=mid}}var b_tree_InternalNode=function(){function InternalNode(owner,keys,values,children,size){this.type=b_tree_NodeType.Internal,this.owner=owner,this.keys=keys,this.values=values,this.children=children,this.size=size}return Object.defineProperty(InternalNode.prototype,"selfSize",{get:function get(){return this.keys.length},enumerable:!1,configurable:!0}),InternalNode.prototype.iter=function(){return new BTreeIterator(this)},InternalNode.prototype.toOwned=function(owner){return this.owner===owner?this:new InternalNode(owner,this.keys.slice(),this.values.slice(),this.children.slice(),this.size)},InternalNode.prototype.getKey=function(index){return this.keys[index]},InternalNode.prototype.getValue=function(index){return this.values[index]},InternalNode.prototype.getChild=function(index){return this.children[index]},InternalNode.prototype.get=function(key){var size=this.selfSize,index=binaryFind(this.keys,key);if(index!==size&&this.getKey(index)===key)return this.getValue(index);return this.getChild(index).get(key)},InternalNode.prototype.contains=function(key){var size=this.selfSize,index=binaryFind(this.keys,key);if(index!==size&&this.getKey(index)===key)return!0;return this.getChild(index).contains(key)},InternalNode.prototype.insert=function(owner,key,value){var size=this.selfSize,index=binaryFind(this.keys,key),key0=this.getKey(index),value0=this.getValue(index);if(key0===key)return utils_is(value0,value)?[this]:((next=this.toOwned(owner)).values[index]=value,[next]);var child0=this.getChild(index),insert=child0.insert(owner,key,value);if(1===insert.length){var next,child=insert[0];return child===child0?[this]:((next=this.toOwned(owner)).children[index]=child,[next])}return 31===size?this.updateWithSplit(owner,insert[0],insert[1],insert[2],insert[3],index):((next=this.toOwned(owner)).keys.splice(index,0,insert[2]),next.values.splice(index,0,insert[3]),next.children.splice(index,1,insert[0],insert[1]),next.size+=1,[next])},InternalNode.prototype.update=function(owner,key,updater){var index=binaryFind(this.keys,key),key0=this.getKey(index),value0=this.getValue(index);if(key0===key){var value=updater(value0);return utils_is(value0,value)?this:((next=this.toOwned(owner)).values[index]=value,next)}var next,child0=this.getChild(index),child=child0.update(owner,key,updater);return child===child0?this:((next=this.toOwned(owner)).children[index]=child,next)},InternalNode.prototype.remove=function(owner,key){var index=binaryFind(this.keys,key),size=this.selfSize,child0=this.getChild(index),originalSize=child0.size,key0=this.getKey(index);if(key0===key){var next,_a=child0.removeMostRight(owner),removedKey=_a[0],value=_a[1],child=_a[2];return(next=this.toOwned(owner)).size-=1,next.keys[index]=removedKey,next.values[index]=value,next.children[index]=child,next.balanceChild(owner,child,removedKey,value,index)}if((child=child0.remove(owner,key)).size===originalSize)return this;if((next=this.toOwned(owner)).size-=1,next.children[index]=child,child.selfSize>=15)return next;if(index===size)return next.balanceTail(child),next;var value0=this.getValue(index);return next.balanceChild(owner,child,key0,value0,index)},InternalNode.prototype.removeMostRight=function(owner){var size=this.selfSize,_a=this.getChild(size).removeMostRight(owner),key=_a[0],value=_a[1],child=_a[2],next=this.toOwned(owner);return next.size-=1,next.children[size]=child,child.selfSize<15&&next.balanceTail(child),[key,value,next]},InternalNode.prototype.map=function(owner,f){for(var values=[],children=[],same=!0,i=0;i<this.keys.length;i+=1){var key=this.getKey(i),value0=this.getValue(i),value=f(value0,key);values.push(value),same=same&&utils_is(value0,value)}for(i=0;i<this.children.length;i+=1){var child0=this.getChild(i),child=child0.map(owner,f);children.push(child),same=same&&child0===child}return same?this:new InternalNode(owner,this.keys,values,children,this.size)},InternalNode.prototype.forEach=function(f){for(var i=0;i<this.keys.length;i+=1){var key=this.getKey(i);f(this.getValue(i),key)}for(i=0;i<this.children.length;i+=1){this.getChild(i).forEach(f)}},InternalNode.prototype.find=function(predicate){for(var i=0;i<this.keys.length;i+=1){var value=this.getValue(i);if(predicate(value))return value}for(i=0;i<this.children.length;i+=1){var found=this.getChild(i).find(predicate);if(found)return found}},InternalNode.prototype.balanceChild=function(owner,child,key0,value0,index){var _a,_b,_c,_d,_e,_f;if(0===index)return this.balanceHead(child),this;var isChildInternal=child.type===b_tree_NodeType.Internal,left0=this.getChild(index-1),right0=this.getChild(index+1);if(left0.selfSize>15)this.rotateRight(child,left0,index,isChildInternal);else if(right0.selfSize>15)this.rotateLeft(child,right0,index,isChildInternal);else{var left=left0.toOwned(owner),right=right0.toOwned(owner),key=child.getKey(7),value=child.getValue(7);left.keys.push(this.getKey(index-1)),left.values.push(this.getValue(index-1)),(_a=left.keys).push.apply(_a,child.keys.slice(0,7)),(_b=left.values).push.apply(_b,child.values.slice(0,7)),right.keys.unshift(key0),right.values.unshift(value0),(_c=right.keys).unshift.apply(_c,child.keys.slice(8,15)),(_d=right.values).unshift.apply(_d,child.values.slice(8,15)),this.keys.splice(index-1,2,key),this.values.splice(index-1,2,value),this.children.splice(index-1,3,left,right),isChildInternal&&((_e=left.children).push.apply(_e,child.children.slice(0,8)),(_f=right.children).unshift.apply(_f,child.children.slice(8,16)),left.updateSize(),right.updateSize())}return this},InternalNode.prototype.rotateLeft=function(child,right0,index,isChildInternal){var right=right0.toOwned(this.owner),newKey=right.keys.shift(),newValue=right.values.shift(),key0=this.getKey(index),value0=this.getValue(index);if(child.keys.push(key0),child.values.push(value0),this.keys[index]=newKey,this.values[index]=newValue,this.children[index+1]=right,isChildInternal){var grandChild=right.children.shift();child.children.push(grandChild);var delta=grandChild.size+1;child.size+=delta,right.size-=delta}},InternalNode.prototype.rotateRight=function(child,left0,index,isChildInternal){var left=left0.toOwned(this.owner),newKey=left.keys.pop(),newValue=left.values.pop(),key0=this.getKey(index-1),value0=this.getValue(index-1);if(child.keys.unshift(key0),child.values.unshift(value0),this.keys[index-1]=newKey,this.values[index-1]=newValue,this.children[index-1]=left,isChildInternal){var grandChild=left.children.pop();child.children.unshift(grandChild);var delta=grandChild.size+1;child.size+=delta,left.size-=delta}},InternalNode.prototype.balanceTail=function(child){var _a,_b,_c,index=this.selfSize,left0=this.getChild(index-1),isChildInternal=child.type===b_tree_NodeType.Internal;15===left0.selfSize?(child.keys.unshift(this.getKey(index-1)),child.values.unshift(this.getValue(index-1)),(_a=child.keys).unshift.apply(_a,left0.keys),(_b=child.values).unshift.apply(_b,left0.values),this.keys.splice(index-1,1),this.values.splice(index-1,1),this.children.splice(index-1,1),isChildInternal&&((_c=child.children).unshift.apply(_c,left0.children),child.size+=left0.size+1)):this.rotateRight(child,left0,index,isChildInternal)},InternalNode.prototype.balanceHead=function(child){var _a,_b,_c,right0=this.getChild(1),isChildInternal=child.type===b_tree_NodeType.Internal;15===right0.selfSize?(child.keys.push(this.getKey(0)),child.values.push(this.getValue(0)),(_a=child.keys).push.apply(_a,right0.keys),(_b=child.values).push.apply(_b,right0.values),this.keys.splice(0,1),this.values.splice(0,1),this.children.splice(1,1),isChildInternal&&((_c=child.children).push.apply(_c,right0.children),child.size+=right0.size+1)):this.rotateLeft(child,right0,0,isChildInternal)},InternalNode.prototype.updateWithSplit=function(owner,child1,child2,key,value,index){var next1=this.toOwned(owner);next1.keys.splice(index,0,key),next1.values.splice(index,0,value),next1.children.splice(index,1,child1,child2);var next2=new InternalNode(owner,next1.keys.splice(16,16),next1.values.splice(16,16),next1.children.splice(16,17),0),nextKey=next1.keys.pop(),nextValue=next1.values.pop();return next1.updateSize(),next2.updateSize(),[next1,next2,nextKey,nextValue]},InternalNode.prototype.updateSize=function(){for(var sum=this.selfSize,len=this.children.length,i=0;i<len;i+=1)sum+=this.children[i].size;this.size=sum},InternalNode}(),b_tree_LeafNode=function(){function LeafNode(owner,keys,values){this.type=b_tree_NodeType.Leaf,this.owner=owner,this.keys=keys,this.values=values}return Object.defineProperty(LeafNode.prototype,"size",{get:function get(){return this.keys.length},enumerable:!1,configurable:!0}),Object.defineProperty(LeafNode.prototype,"selfSize",{get:function get(){return this.size},enumerable:!1,configurable:!0}),LeafNode.prototype.toOwned=function(owner){return this.owner===owner?this:new LeafNode(owner,this.keys.slice(),this.values.slice())},LeafNode.prototype.getKey=function(index){return this.keys[index]},LeafNode.prototype.getValue=function(index){return this.values[index]},LeafNode.prototype.get=function(key){var size=this.selfSize,index=binaryFind(this.keys,key);if(index!==size)return this.getKey(index)===key?this.getValue(index):void 0},LeafNode.prototype.contains=function(key){var size=this.selfSize,index=binaryFind(this.keys,key);return index!==size&&this.getKey(index)===key},LeafNode.prototype.insert=function(owner,key,value){var size=this.selfSize,index=binaryFind(this.keys,key);if((index===size?void 0:this.getKey(index))===key){var next,value0=this.getValue(index);return utils_is(value,value0)?[this]:((next=this.toOwned(owner)).values[index]=value,[next])}return 31===size?this.updateWithSplit(owner,key,value,index):((next=this.toOwned(owner)).keys.splice(index,0,key),next.values.splice(index,0,value),[next])},LeafNode.prototype.update=function(owner,key,updater){var size=this.selfSize,index=binaryFind(this.keys,key);if((index===size?void 0:this.getKey(index))===key){var value0=this.getValue(index),value=updater(value0);if(utils_is(value,value0))return this;var next=this.toOwned(owner);return next.values[index]=value,next}return this},LeafNode.prototype.remove=function(owner,key){var index=binaryFind(this.keys,key);return index===this.selfSize?this:this.removeIndex(owner,index)},LeafNode.prototype.removeMostRight=function(owner){var index=this.selfSize-1;return[this.getKey(index),this.getValue(index),this.removeIndex(owner,index)]},LeafNode.prototype.map=function(owner,f){for(var values=[],same=!0,i=0;i<this.keys.length;i+=1){var key=this.getKey(i),value0=this.getValue(i),value=f(value0,key);values.push(value),same=same&&utils_is(value0,value)}return same?this:new LeafNode(owner,this.keys,values)},LeafNode.prototype.forEach=function(f){for(var i=0;i<this.keys.length;i+=1){var key=this.getKey(i);f(this.getValue(i),key)}},LeafNode.prototype.find=function(predicate){return this.values.find(predicate)},LeafNode.prototype.updateWithSplit=function(owner,key,value,index){var next1=this.toOwned(owner);next1.keys.splice(index,0,key),next1.values.splice(index,0,value);var next2=new LeafNode(owner,next1.keys.splice(16,16),next1.values.splice(16,16)),nextKey=next1.keys.pop(),nextValue=next1.values.pop();return[next1,next2,nextKey,nextValue]},LeafNode.prototype.removeIndex=function(owner,index){var next=this.toOwned(owner);return next.keys.splice(index,1),next.values.splice(index,1),next},LeafNode}();function emptyRoot(owner){return new b_tree_LeafNode(owner,[],[])}function rootInsert(owner,root,key,value){if(0===root.selfSize)return new b_tree_LeafNode(owner,[key],[value]);var insert=root.insert(owner,key,value);if(1===insert.length)return insert[0];var next1=insert[0],next2=insert[1],newKey=insert[2],newValue=insert[3];return new b_tree_InternalNode(owner,[newKey],[newValue],[next1,next2],next1.size+next2.size+1)}function rootRemove(owner,root,key){var newRoot=root.remove(owner,key);return newRoot.type===b_tree_NodeType.Internal&&0===newRoot.selfSize?newRoot.getChild(0):newRoot}var BTreeIterator=function(){function BTreeIterator(node){this.delegate=null,this.index=0,this.done=!1,this.node=node,this.setDelegate(this.index)}return BTreeIterator.prototype[Symbol.iterator]=function(){return this.clone()},BTreeIterator.prototype.next=function(){if(null===this.delegate)return this.yieldValue();var next=this.delegate.next();if(!next.done)return{done:!1,value:next.value};var y=this.yieldValue();return this.index<=this.node.selfSize?this.setDelegate(this.index):(this.done=!0,this.delegate=null),y},BTreeIterator.prototype.clone=function(){var iter=new BTreeIterator(this.node);return iter.delegate=this.delegate,iter.index=this.index,iter.done=this.done,iter},BTreeIterator.prototype.setDelegate=function(index){if(this.node.type===b_tree_NodeType.Internal){var child=this.node.getChild(index);this.delegate=new BTreeIterator(child)}},BTreeIterator.prototype.yieldValue=function(){if(!this.done&&this.index<this.node.selfSize){var key=this.node.getKey(this.index),value=this.node.getValue(this.index);return this.index+=1,{done:!1,value:[key,value]}}return this.done=!0,{done:!0,value:void 0}},BTreeIterator}(),sorted_map_uid=new Uid,sorted_map_SortedMap=function(){function SortedMap(root){this.id=sorted_map_uid.take(),this.root=root}return Object.defineProperty(SortedMap.prototype,"size",{get:function get(){return this.root.size},enumerable:!1,configurable:!0}),SortedMap.empty=function(){return sorted_map_SortedMapBuilder.empty().finish()},SortedMap.from=function(iterable){return sorted_map_SortedMapBuilder.from(iterable).finish()},SortedMap.prototype.delete=function(key){return this.withRoot(rootRemove(sorted_map_uid.peek(),this.root,key))},SortedMap.prototype.get=function(key){return this.root.get(key)},SortedMap.prototype.has=function(key){return this.root.contains(key)},SortedMap.prototype.set=function(key,value){return this.withRoot(rootInsert(sorted_map_uid.peek(),this.root,key,value))},SortedMap.prototype.update=function(key,updater){return this.withRoot(this.root.update(sorted_map_uid.peek(),key,updater))},SortedMap.prototype[Symbol.iterator]=function(){return this.entries()},SortedMap.prototype.clone=function(){return new SortedMap(this.root)},SortedMap.prototype.entries=function(){return new BTreeIterator(this.root)},SortedMap.prototype.values=function(){return new MapIterator(this.entries(),(function(_a){return _a[1]}))},SortedMap.prototype.mutate=function(){return new sorted_map_SortedMapBuilder(this.root)},SortedMap.prototype.map=function(f){return new SortedMap(this.root.map(sorted_map_uid.peek(),f))},SortedMap.prototype.filter=function(predicate){var map=this.mutate();return this.forEach((function(value,key){predicate(value,key)||map.delete(key)})),map.finish()},SortedMap.prototype.forEach=function(f){this.root.forEach(f)},SortedMap.prototype.find=function(predicate){return this.root.find(predicate)},SortedMap.prototype.withRoot=function(newRoot){return newRoot===this.root?this:new SortedMap(newRoot)},SortedMap}(),sorted_map_SortedMapBuilder=function(){function SortedMapBuilder(root){this.id=sorted_map_uid.take(),this.root=root}return SortedMapBuilder.empty=function(){return new SortedMapBuilder(emptyRoot(sorted_map_uid.peek()))},SortedMapBuilder.from=function(iterable){if(Array.isArray(iterable))return SortedMapBuilder.fromArray(iterable);for(var iter=iterable[Symbol.iterator](),builder=SortedMapBuilder.empty(),next=iter.next();!next.done;){var _a=next.value,key=_a[0],value=_a[1];builder.set(key,value),next=iter.next()}return builder},SortedMapBuilder.fromArray=function(list){for(var builder=SortedMapBuilder.empty(),i=0;i<list.length;i+=1){var _a=list[i],key=_a[0],value=_a[1];builder.set(key,value)}return builder},SortedMapBuilder.prototype.delete=function(key){return this.root=rootRemove(this.id,this.root,key),this},SortedMapBuilder.prototype.get=function(key){return this.root.get(key)},SortedMapBuilder.prototype.has=function(key){return this.root.contains(key)},SortedMapBuilder.prototype.set=function(key,value){return this.root=rootInsert(this.id,this.root,key,value),this},SortedMapBuilder.prototype.update=function(key,updater){return this.root=this.root.update(this.id,key,updater),this},SortedMapBuilder.prototype.finish=function(){return new sorted_map_SortedMap(this.root)},SortedMapBuilder}(),ordered_map_uid=new Uid,ordered_map_OrderedMap=function(){function OrderedMap(itemId,hashRoot,sortedRoot){this.id=ordered_map_uid.take(),this.itemId=itemId,this.hashRoot=hashRoot,this.sortedRoot=sortedRoot}return Object.defineProperty(OrderedMap.prototype,"size",{get:function get(){return this.hashRoot.size},enumerable:!1,configurable:!0}),OrderedMap.empty=function(){return ordered_map_OrderedMapBuilder.empty().finish()},OrderedMap.from=function(iterable){return ordered_map_OrderedMapBuilder.from(iterable).finish()},OrderedMap.prototype.delete=function(key){var tempId=ordered_map_uid.peek(),h=hashing(key),remove=this.hashRoot.remove(tempId,key,h,0);if(void 0===remove)return this;var hashRoot=remove[0],valueId=remove[1],sortedRoot=this.sortedRoot.remove(tempId,valueId);return new OrderedMap(this.itemId,hashRoot,sortedRoot)},OrderedMap.prototype.get=function(key){var h=hashing(key),id=this.hashRoot.get(key,h,0);if(void 0!==id){var got=this.sortedRoot.get(id);return null==got?void 0:got[1]}},OrderedMap.prototype.has=function(key){var h=hashing(key);return this.hashRoot.contains(key,h,0)},OrderedMap.prototype.set=function(key,value){var temp=ordered_map_uid.peek(),itemId=this.hashRoot.get(key,hashing(key),0),hashRoot=this.hashRoot;itemId||(itemId=this.itemId+1,hashRoot=this.hashRoot.insert(temp,key,itemId,hashing(key),0));var sortedRoot=rootInsert(temp,this.sortedRoot,itemId,[key,value]);return this.withRoot(this.itemId+1,hashRoot,sortedRoot)},OrderedMap.prototype.update=function(key,updater){var itemId=this.hashRoot.get(key,hashing(key),0);if(!itemId)return this;var sortedRoot=this.sortedRoot.update(ordered_map_uid.peek(),itemId,(function(prev){var prevKey=prev[0],prevValue=prev[1],value=updater(prevValue);return utils_is(value,prevValue)?prev:[prevKey,value]}));return this.withRoot(this.itemId,this.hashRoot,sortedRoot)},OrderedMap.prototype[Symbol.iterator]=function(){return this.entries()},OrderedMap.prototype.clone=function(){return new OrderedMap(this.itemId,this.hashRoot,this.sortedRoot)},OrderedMap.prototype.entries=function(){return new OrderedMapIterator(new BTreeIterator(this.sortedRoot))},OrderedMap.prototype.values=function(){return new MapIterator(this.entries(),(function(_a){return _a[1]}))},OrderedMap.prototype.mutate=function(){return new ordered_map_OrderedMapBuilder(this.itemId,this.hashRoot,this.sortedRoot)},OrderedMap.prototype.map=function(f){var id=ordered_map_uid.peek(),sortedRoot=this.sortedRoot.map(id,(function g(prev){var key=prev[0],value0=prev[1],value=f(value0,key);return utils_is(value0,value)?prev:[key,value]}));return new OrderedMap(this.itemId,this.hashRoot,sortedRoot)},OrderedMap.prototype.forEach=function(f){this.sortedRoot.forEach((function(_a){var key=_a[0],value=_a[1];f(value,key)}))},OrderedMap.prototype.find=function(predicate){var found=this.sortedRoot.find((function(_a){var value=_a[1];return predicate(value)}));return found?found[1]:void 0},OrderedMap.prototype.first=function(){var next=this.entries().next();if(!next.done)return next.value[1]},OrderedMap.prototype.filter=function(predicate){var map=this.mutate();return this.forEach((function(value,key){predicate(value,key)||map.delete(key)})),map.finish()},OrderedMap.prototype.withRoot=function(itemId,hashRoot,sortedRoot){return hashRoot===this.hashRoot&&sortedRoot===this.sortedRoot?this:new OrderedMap(itemId,hashRoot,sortedRoot)},OrderedMap}(),OrderedMapIterator=function(){function OrderedMapIterator(delegate){this.delegate=delegate}return OrderedMapIterator.prototype[Symbol.iterator]=function(){return this.clone()},OrderedMapIterator.prototype.next=function(){var next=this.delegate.next();return next.done?{done:!0,value:void 0}:{done:!1,value:next.value[1]}},OrderedMapIterator.prototype.clone=function(){return new OrderedMapIterator(this.delegate.clone())},OrderedMapIterator}(),ordered_map_OrderedMapBuilder=function(){function OrderedMapBuilder(itemId,hashRoot,sortedRoot){this.id=ordered_map_uid.take(),this.itemId=itemId,this.hashRoot=hashRoot,this.sortedRoot=sortedRoot}return OrderedMapBuilder.empty=function(){var tempId=ordered_map_uid.peek();return new OrderedMapBuilder(0,champ_BitmapIndexedNode.empty(tempId),emptyRoot(tempId))},OrderedMapBuilder.from=function(iterable){if(Array.isArray(iterable))return OrderedMapBuilder.fromArray(iterable);for(var builder=OrderedMapBuilder.empty(),iterator=iterable[Symbol.iterator](),next=iterator.next();!next.done;){var _a=next.value,key=_a[0],value=_a[1];builder.set(key,value),next=iterator.next()}return builder},OrderedMapBuilder.fromArray=function(list){for(var builder=OrderedMapBuilder.empty(),i=0;i<list.length;i+=1){var _a=list[i],key=_a[0],value=_a[1];builder.set(key,value)}return builder},OrderedMapBuilder.prototype.delete=function(key){var h=hashing(key),remove=this.hashRoot.remove(this.id,key,h,0);if(void 0===remove)return this;var id=remove[1];return this.hashRoot=remove[0],this.sortedRoot=rootRemove(this.id,this.sortedRoot,id),this},OrderedMapBuilder.prototype.get=function(key){var _a,h=hashing(key),id=this.hashRoot.get(key,h,0);if(void 0!==id)return null===(_a=this.sortedRoot.get(id))||void 0===_a?void 0:_a[1]},OrderedMapBuilder.prototype.has=function(key){var h=hashing(key);return this.hashRoot.contains(key,h,0)},OrderedMapBuilder.prototype.set=function(key,value){var itemId=this.hashRoot.get(key,hashing(key),0);return void 0===itemId&&(itemId=this.itemId+1,this.itemId+=1,this.hashRoot=this.hashRoot.insert(this.id,key,itemId,hashing(key),0)),this.sortedRoot=rootInsert(this.id,this.sortedRoot,itemId,[key,value]),this},OrderedMapBuilder.prototype.update=function(key,updater){var itemId=this.hashRoot.get(key,hashing(key),0);return itemId?(this.sortedRoot=this.sortedRoot.update(this.id,itemId,(function(prev){var prevKey=prev[0],prevValue=prev[1],value=updater(prevValue);return utils_is(value,prevValue)?prev:[prevKey,value]})),this):this},OrderedMapBuilder.prototype.finish=function(){return new ordered_map_OrderedMap(this.itemId,this.hashRoot,this.sortedRoot)},OrderedMapBuilder}();function preventSpread(obj){Object.defineProperty(obj,"__preventSpread",{enumerable:!0,configurable:!1,get:function get(){document.currentScript&&Debug.error(obj.constructor.name+" is a class, which should not be used in the spread syntax or argument of Object.assign")}})}var EdgeModel_EdgeModel=function(){function EdgeModel(edge){this.inner=edge,preventSpread(this)}return Object.defineProperty(EdgeModel.prototype,"id",{get:function get(){return this.inner.id},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"shape",{get:function get(){return this.inner.shape},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"automationId",{get:function get(){return this.inner.automationId},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"source",{get:function get(){return this.inner.source},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"target",{get:function get(){return this.inner.target},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"sourcePortId",{get:function get(){return this.inner.sourcePortId},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"targetPortId",{get:function get(){return this.inner.targetPortId},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"state",{get:function get(){return this.inner.state},enumerable:!1,configurable:!0}),Object.defineProperty(EdgeModel.prototype,"data",{get:function get(){return this.inner.data},enumerable:!1,configurable:!0}),EdgeModel.fromJSON=function(inner){return new EdgeModel(inner)},EdgeModel.prototype.updateState=function(f){return this.update(state_updateState(f))},EdgeModel.prototype.update=function(f){var edge=f(this.inner);return edge===this.inner?this:new EdgeModel(edge)},EdgeModel.prototype.shallow=function(){return new EdgeModel(this.inner)},EdgeModel.prototype.toJSON=function(){return this.inner},EdgeModel}();var CanvasMouseMode,GraphBehavior,NodeModel_NodeModel=function(){function NodeModel(node,portPositionCache,prev,next){this.inner=node,this.portPositionCache=portPositionCache,this.prev=prev,this.next=next,preventSpread(this)}return Object.defineProperty(NodeModel.prototype,"id",{get:function get(){return this.inner.id},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"state",{get:function get(){return this.inner.state},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"shape",{get:function get(){return this.inner.shape},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"ports",{get:function get(){return this.inner.ports},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"ariaLabel",{get:function get(){return this.inner.ariaLabel},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"name",{get:function get(){return this.inner.name},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"x",{get:function get(){return this.inner.x},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"y",{get:function get(){return this.inner.y},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"automationId",{get:function get(){return this.inner.automationId},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"isInSearchResults",{get:function get(){return this.inner.isInSearchResults},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"isCurrentSearchResult",{get:function get(){return this.inner.isCurrentSearchResult},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"data",{get:function get(){return this.inner.data},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"height",{get:function get(){return this.inner.height},enumerable:!1,configurable:!0}),Object.defineProperty(NodeModel.prototype,"width",{get:function get(){return this.inner.width},enumerable:!1,configurable:!0}),NodeModel.fromJSON=function(node,prev,next){return new NodeModel(node,new Map,prev,next)},NodeModel.prototype.getPort=function(id){var _a;return null===(_a=this.ports)||void 0===_a?void 0:_a.find((function(port){return port.id===id}))},NodeModel.prototype.link=function(_a){var prev=_a.prev,next=_a.next;return prev===this.prev&&next===this.next?this:new NodeModel(this.inner,this.portPositionCache,null!=prev?prev:this.prev,null!=next?next:this.next)},NodeModel.prototype.updateState=function(f){return this.update(state_updateState(f))},NodeModel.prototype.update=function(f){var node=f(this.inner);return node===this.inner?this:new NodeModel(node,new Map,this.prev,this.next)},NodeModel.prototype.updateData=function(f){return this.data?this.update((function(inner){var data=f(inner.data);return data===inner.data?inner:Object(tslib_es6.a)(Object(tslib_es6.a)({},inner),{data:data})})):this},NodeModel.prototype.getPortPosition=function(portId,graphConfig){var point=this.portPositionCache.get(portId);return point||(point=getPortPosition_getPortPositionByPortId(this.inner,portId,graphConfig),this.portPositionCache.set(portId,point)),point},NodeModel.prototype.hasPort=function(id){var _a;return Boolean(null===(_a=this.inner.ports)||void 0===_a?void 0:_a.find((function(port){return port.id===id})))},NodeModel.prototype.updatePositionAndSize=function(dummy){var x=dummy.x,y=dummy.y,width=dummy.width,height=dummy.height;return new NodeModel(Object(tslib_es6.a)(Object(tslib_es6.a)({},this.inner),{x:x,y:y,width:null!=width?width:this.inner.width,height:null!=height?height:this.inner.height}),new Map,this.prev,this.next)},NodeModel.prototype.updatePorts=function(f){if(!this.inner.ports)return this;var ports=function mapCow(list,f){for(var values=[],same=!0,i=0;i<list.length;i+=1){var value0=list[i],value=f(value0,i);same=same&&is(value0,value),values.push(value)}return same?list:values}(this.inner.ports,f),node=this.inner.ports===ports?this.inner:Object(tslib_es6.a)(Object(tslib_es6.a)({},this.inner),{ports:ports});return node===this.inner?this:new NodeModel(node,new Map,this.prev,this.next)},NodeModel.prototype.invalidCache=function(){return new NodeModel(this.inner,new Map,this.prev,this.next)},NodeModel.prototype.toJSON=function(){return this.inner},NodeModel}(),GraphModel_GraphModel=function(){function GraphModel(nodes,edges,groups,head,tail,edgesBySource,edgesByTarget){this.nodes=nodes,this.edges=edges,this.groups=groups,this.head=head,this.tail=tail,this.edgesBySource=edgesBySource,this.edgesByTarget=edgesByTarget,preventSpread(this)}return GraphModel.empty=function(){return new GraphModel(ordered_map_OrderedMap.empty(),hash_map_HashMap.empty(),[],void 0,void 0,hash_map_HashMap.empty(),hash_map_HashMap.empty())},GraphModel.fromJSON=function(init){var _a,head,tail,nodes=ordered_map_OrderedMap.empty().mutate(),edges=hash_map_HashMap.empty().mutate();if(0===init.nodes.length)head=void 0,tail=void 0;else if(1===init.nodes.length){var node=init.nodes[0];nodes.set(node.id,NodeModel_NodeModel.fromJSON(node,void 0,void 0)),head=node.id,tail=node.id}else{var first=init.nodes[0],second=init.nodes[1],last=init.nodes[init.nodes.length-1];head=first.id,tail=last.id,nodes.set(first.id,NodeModel_NodeModel.fromJSON(first,void 0,second.id));var prev=init.nodes[0];if(init.nodes.length>2)for(var i=1;i<init.nodes.length-1;i+=1){node=init.nodes[i];var next=init.nodes[i+1];nodes.set(node.id,NodeModel_NodeModel.fromJSON(node,prev.id,next.id)),prev=node}nodes.set(last.id,NodeModel_NodeModel.fromJSON(last,prev.id,void 0))}for(var edgesBySource=hash_map_HashMapBuilder.empty(),edgesByTarget=hash_map_HashMapBuilder.empty(),_i=0,_b=init.edges;_i<_b.length;_i++){var edge=_b[_i];edges.set(edge.id,EdgeModel_EdgeModel.fromJSON(edge)),setEdgeByPortMutable(edgesBySource,edge.id,edge.source,edge.sourcePortId),setEdgeByPortMutable(edgesByTarget,edge.id,edge.target,edge.targetPortId)}return new GraphModel(nodes.finish(),edges.finish(),null!==(_a=init.groups)&&void 0!==_a?_a:[],head,tail,edgesBySource.finish(),edgesByTarget.finish())},GraphModel.prototype.getNavigationFirstNode=function(){if(void 0!==this.head)return this.nodes.get(this.head)},GraphModel.prototype.updateNode=function(id,f){var _a,_b,nodes=this.nodes.update(id,(function(node){return node.update(f)}));if(nodes===this.nodes)return this;var edges=this.edges.mutate();return null===(_a=this.edgesBySource.get(id))||void 0===_a||_a.forEach((function(edgeIds){edgeIds.forEach((function(edgeId){markEdgeDirty(edges,edgeId)}))})),null===(_b=this.edgesByTarget.get(id))||void 0===_b||_b.forEach((function(edgeIds){edgeIds.forEach((function(edgeId){markEdgeDirty(edges,edgeId)}))})),new GraphModel(nodes,edges.finish(),this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.updateNodeData=function(id,f){return new GraphModel(this.nodes.update(id,(function(node){return node.updateData(f)})),this.edges,this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.updatePort=function(nodeId,portId,f){return new GraphModel(this.nodes.update(nodeId,(function(node){return node.updatePorts((function(port){return port.id===portId?f(port):port}))})),this.edges,this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.insertNode=function(node){var nodes=this.nodes.mutate().set(node.id,NodeModel_NodeModel.fromJSON(node,this.tail,void 0));return this.tail&&!this.nodes.has(node.id)&&nodes.update(this.tail,(function(tail){return tail.link({next:node.id})})),new GraphModel(nodes.finish(),this.edges,this.groups,0===this.nodes.size?node.id:this.head,node.id,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.deleteItems=function(predicate){for(var _a,prev,deleted=new Set,nodes=this.nodes.mutate(),first=void 0===this.head?void 0:this.nodes.get(this.head),node=first,edgesBySource=this.edgesBySource.mutate(),edgesByTarget=this.edgesByTarget.mutate();void 0!==node;){var next=node.next?this.nodes.get(node.next):void 0;(null===(_a=predicate.node)||void 0===_a?void 0:_a.call(predicate,node.inner))?(nodes.update(node.id,(function(current){return current.link({prev:null==prev?void 0:prev.id}).update((function(n){return hasState(GraphNodeState.editing)(n.state)?n:Object(tslib_es6.a)(Object(tslib_es6.a)({},n),{state:GraphNodeState.default})}))})),prev=node):(nodes.delete(node.id),edgesBySource.delete(node.id),edgesByTarget.delete(node.id),deleted.add(node.id),prev&&nodes.update(prev.id,(function(prevNode){return prevNode.link({next:null==node?void 0:node.next})})),next&&nodes.update(next.id,(function(nextNode){return nextNode.link({prev:null==prev?void 0:prev.id})})),node===first&&(first=next)),node=next}var edges=this.edges.mutate();return this.edges.forEach((function(edge){var _a,_b;deleted.has(edge.source)||deleted.has(edge.target)||null!==(_b=null===(_a=predicate.edge)||void 0===_a?void 0:_a.call(predicate,edge))&&void 0!==_b&&!_b?(edges.delete(edge.id),deleteEdgeByPort(edgesBySource,edge.id,edge.source,edge.sourcePortId),deleteEdgeByPort(edgesByTarget,edge.id,edge.target,edge.targetPortId)):edges.update(edge.id,(function(e){return e.update(state_updateState(resetState(GraphEdgeState.default)))}))})),new GraphModel(nodes.finish(),edges.finish(),this.groups,null==first?void 0:first.id,null==prev?void 0:prev.id,edgesBySource.finish(),edgesByTarget.finish())},GraphModel.prototype.insertEdge=function(edge){if(this.isEdgeExist(edge.source,edge.sourcePortId,edge.target,edge.targetPortId)||!this.nodes.has(edge.source)||!this.nodes.has(edge.target))return this;var edgesBySource=setEdgeByPort(this.edgesBySource,edge.id,edge.source,edge.sourcePortId),edgesByTarget=setEdgeByPort(this.edgesByTarget,edge.id,edge.target,edge.targetPortId);return new GraphModel(this.nodes.update(edge.source,(function(node){return node.invalidCache()})).update(edge.target,(function(node){return node.invalidCache()})),this.edges.set(edge.id,EdgeModel_EdgeModel.fromJSON(edge)).map((function(e){return e.updateState(resetState(GraphEdgeState.default))})),this.groups,this.head,this.tail,edgesBySource,edgesByTarget)},GraphModel.prototype.updateEdge=function(id,f){return new GraphModel(this.nodes,this.edges.update(id,(function(e){return e.update(f)})),this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.deleteEdge=function(id){var edge=this.edges.get(id);return edge?new GraphModel(this.nodes,this.edges.delete(id),this.groups,this.head,this.tail,deleteEdgeByPort(this.edgesBySource,edge.id,edge.source,edge.sourcePortId),deleteEdgeByPort(this.edgesByTarget,edge.id,edge.target,edge.targetPortId)):this},GraphModel.prototype.updateNodesPositionAndSize=function(dummies){var _this=this,updates=new Set,nodes=this.nodes.mutate(),edges=this.edges.mutate();return dummies.forEach((function(dummy){var _a,_b;updates.add(dummy.id),nodes.update(dummy.id,(function(node){return node.updatePositionAndSize(dummy)})),null===(_a=_this.edgesBySource.get(dummy.id))||void 0===_a||_a.forEach((function(ids){ids.forEach((function(id){markEdgeDirty(edges,id)}))})),null===(_b=_this.edgesByTarget.get(dummy.id))||void 0===_b||_b.forEach((function(ids){ids.forEach((function(id){markEdgeDirty(edges,id)}))}))})),new GraphModel(nodes.finish(),edges.finish(),this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.mapNodes=function(f){return new GraphModel(this.nodes.map(f),this.edges,this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.mapEdges=function(f){return new GraphModel(this.nodes,this.edges.map(f),this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.selectNodes=function(predicate,topNode){var selected=new Set,nodes=this.nodes.map((function(node){var isNodeSelected=predicate(node.inner);return isNodeSelected&&selected.add(node.id),node.updatePorts(state_updateState(resetState(GraphPortState.default))).updateState(function resetConnectState(state){return function(prevState){return prevState&GraphNodeState.activated|state}}(isNodeSelected?GraphNodeState.selected:GraphNodeState.unconnectedToSelected))})).mutate();if(0===selected.size)this.nodes.forEach((function(n){return nodes.update(n.id,(function(it){return it.updateState(resetState(GraphNodeState.default))}))}));else if(topNode){var n=nodes.get(topNode);n&&(nodes.delete(topNode),nodes.set(n.id,n))}var setConnected=function setConnected(id){nodes.update(id,(function(node){return node.update(state_updateState(resetState(state_isSelected(node)?GraphNodeState.selected:GraphNodeState.connectedToSelected)))}))},edges=selected.size?this.edges.map((function(edge){var state=GraphEdgeState.unconnectedToSelected;return selected.has(edge.source)&&(setConnected(edge.target),state=GraphEdgeState.connectedToSelected),selected.has(edge.target)&&(setConnected(edge.source),state=GraphEdgeState.connectedToSelected),edge.update(state_updateState(resetState(state)))})):this.edges.map((function(edge){return edge.updateState(resetState(GraphEdgeState.default))}));return new GraphModel(nodes.finish(),edges,this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.getEdgesBySource=function(nodeId,portId){var _a;return null===(_a=this.edgesBySource.get(nodeId))||void 0===_a?void 0:_a.get(portId)},GraphModel.prototype.getEdgesByTarget=function(nodeId,portId){var _a;return null===(_a=this.edgesByTarget.get(nodeId))||void 0===_a?void 0:_a.get(portId)},GraphModel.prototype.isPortConnectedAsSource=function(nodeId,portId){var _a,_b;return(null!==(_b=null===(_a=this.getEdgesBySource(nodeId,portId))||void 0===_a?void 0:_a.size)&&void 0!==_b?_b:0)>0},GraphModel.prototype.isPortConnectedAsTarget=function(nodeId,portId){var _a,_b;return(null!==(_b=null===(_a=this.getEdgesByTarget(nodeId,portId))||void 0===_a?void 0:_a.size)&&void 0!==_b?_b:0)>0},GraphModel.prototype.shallow=function(){return new GraphModel(this.nodes,this.edges,this.groups,this.head,this.tail,this.edgesBySource,this.edgesByTarget)},GraphModel.prototype.toJSON=function(){for(var nodes=[],current=this.head&&this.nodes.get(this.head);current;)nodes.push(current.inner),current=current.next&&this.nodes.get(current.next);return{nodes:nodes,edges:Array.from(this.edges.values()).map((function(it){return it.inner}))}},GraphModel.prototype.isEdgeExist=function(source,sourcePortId,target,targetPortId){var sources=this.getEdgesBySource(source,sourcePortId),targets=this.getEdgesByTarget(target,targetPortId);if(!sources||!targets)return!1;var exist=!1;return sources.forEach((function(id){targets.has(id)&&(exist=!0)})),exist},GraphModel}();function setEdgeByPort(edgesByPort,edgeId,nodeId,portId){return edgesByPort.has(nodeId)?edgesByPort.update(nodeId,(function(map){var edges=map.get(portId);return new Map(map).set(portId,(edges?new Set(edges):new Set).add(edgeId))})):edgesByPort.set(nodeId,new Map([[portId,new Set([edgeId])]]))}function setEdgeByPortMutable(edgesByPort,edgeId,nodeId,portId){edgesByPort.has(nodeId)?edgesByPort.update(nodeId,(function(map){var set=map.get(portId);return set||(set=new Set,map.set(portId,set)),set.add(edgeId),map})):edgesByPort.set(nodeId,new Map([[portId,new Set([edgeId])]]))}function deleteEdgeByPort(edgesByPort,edgeId,nodeId,portId){return edgesByPort.has(nodeId)?edgesByPort.update(nodeId,(function(edgeByPortsMap){var edgeIds=edgeByPortsMap.get(portId);if(!edgeIds)return edgeByPortsMap;var set=new Set(edgeIds);return set.delete(edgeId),new Map(edgeByPortsMap).set(portId,set)})):edgesByPort}!function(CanvasMouseMode){CanvasMouseMode.pan="pan",CanvasMouseMode.select="select"}(CanvasMouseMode||(CanvasMouseMode={})),function(GraphBehavior){GraphBehavior.default="default",GraphBehavior.dragging="dragging",GraphBehavior.panning="panning",GraphBehavior.multiSelect="multiSelect",GraphBehavior.connecting="connecting",GraphBehavior.addingNode="addingNode"}(GraphBehavior||(GraphBehavior={}));var EMPTY_TRANSFORM_MATRIX=[1,0,0,1,0,0],EMPTY_VIEW_PORT={rect:void 0,transformMatrix:EMPTY_TRANSFORM_MATRIX},DEFAULT_NODE_MIN_VISIBLE_SIZE={width:5,height:5},DEFAULT_NODE_MAX_VISIBLE_SIZE={width:500,height:500},DEFAULT_GRAPH_SETTINGS={features:defaultFeatures,graphConfig:GraphConfigBuilder_GraphConfigBuilder.default().build(),canvasBoundaryPadding:{top:0,right:0,bottom:0,left:0},nodeMinVisibleSize:DEFAULT_NODE_MIN_VISIBLE_SIZE,nodeMaxVisibleSize:DEFAULT_NODE_MAX_VISIBLE_SIZE},EMPTY_GRAPH_STATE={settings:DEFAULT_GRAPH_SETTINGS,behavior:GraphBehavior.default,data:resetUndoStack(GraphModel_GraphModel.empty()),viewport:{transformMatrix:[1,0,0,1,0,0],rect:void 0},dummyNodes:{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1},alignmentLines:[],activeKeys:new Set,selectBoxPosition:{startX:0,startY:0,height:0,width:0},connectState:void 0};function warnGraphStateContext(){Debug.warn("Missing GraphStateContext, GraphStateContext must be used as child of GraphStateStore")}var defaultGraphStateContext={get state(){return warnGraphStateContext(),EMPTY_GRAPH_STATE},dispatch:function dispatch(){warnGraphStateContext()}},EMPTY_CONNECT_STATE={sourceNode:void 0,sourcePort:void 0,targetNode:void 0,targetPort:void 0,movingPoint:{x:0,y:0}},GraphValueContext=react.createContext(new Proxy(GraphModel_GraphModel.empty(),{get:function get(target,prop){return console.warn("Default graph data value is being used. Please check if you forget rendering Graph component"),target[prop]}})),GraphStateContext=react.createContext(defaultGraphStateContext),ViewportContext=Object(react.createContext)(EMPTY_VIEW_PORT),react_dom=__webpack_require__(58),eventChannel_EventChannel=function(){function EventChannel(){this.listenersRef=Object(react.createRef)(),this.externalHandlerRef=Object(react.createRef)(),this.queue=[],this.working=!1}return EventChannel.prototype.trigger=function(event){var _this=this;this.working?this.queue.push(event):(this.working=!0,Object(react_dom.unstable_batchedUpdates)((function(){_this.callHandlers(event);for(var i=0;i<_this.queue.length;i+=1){var e=_this.queue[i];_this.callHandlers(e)}_this.queue=[]})),this.working=!1)},EventChannel.prototype.batch=function(events){var _a,_b;if(this.working)(_a=this.queue).push.apply(_a,events);else{var first=events[0];if(!first)return;(_b=this.queue).push.apply(_b,events.slice(1)),this.trigger(first)}},EventChannel.prototype.callHandlers=function(e){var _a,_b,_c,_d;null===(_b=(_a=this.listenersRef).current)||void 0===_b||_b.call(_a,e),e.intercepted||null===(_d=(_c=this.externalHandlerRef).current)||void 0===_d||_d.call(_c,e)},EventChannel}(),GraphController_GraphController=function(){function GraphController(state,dispatch){this.pointerId=null,this.canvasClickOnce=!1,this.nodeClickOnce=null,this.eventChannel=new eventChannel_EventChannel,this.behavior=GraphBehavior.default,this.state=state,this.UNSAFE_latestState=state,this.dispatch=dispatch}return GraphController.prototype.setMouseClientPosition=function(pos){this.mouseClientPoint=pos},GraphController.prototype.unsetMouseClientPosition=function(){this.mouseClientPoint=void 0},GraphController.prototype.getMouseClientPosition=function(){return this.mouseClientPoint},GraphController.prototype.getEnabledFeatures=function(){return this.state.settings.features},GraphController.prototype.getBehavior=function(){return this.behavior},GraphController.prototype.setBehavior=function(value){this.behavior=value},GraphController.prototype.getData=function(){return this.state.data.present},GraphController.prototype.getGlobalEventTarget=function(){var _a,_b;return null!==(_b=null===(_a=this.getGlobalEventTargetImpl)||void 0===_a?void 0:_a.call(this))&&void 0!==_b?_b:window},GraphController}();function useConst(init){var ref=Object(react.useRef)();return void 0===ref.current&&(ref.current=init()),ref.current}var noop=function noop(){},ErrorBoundary_ErrorBoundary=function(_super){function ErrorBoundary(props){var _this=_super.call(this,props)||this;return _this.state={hasError:!1},_this}return Object(tslib_es6.c)(ErrorBoundary,_super),ErrorBoundary.getDerivedStateFromError=function(error){return{hasError:!0,error:error}},ErrorBoundary.prototype.componentDidCatch=function(error,errorInfo){console.error(error),this.setState({error:error,errorInfo:errorInfo})},ErrorBoundary.prototype.render=function(){var _a;if(!this.state.hasError)return this.props.children;if(this.props.renderOnError)return null!==(_a=this.props.renderOnError(this.state.error,this.state.errorInfo,this.props.children))&&void 0!==_a?_a:null;var componentStackLines=this.state.errorInfo?this.state.errorInfo.componentStack.split("\n"):[];return react.createElement("div",{style:{color:"red"}},react.createElement("h1",null,"Something went wrong."),react.createElement("p",null,"Error: "+this.state.error),react.createElement("p",null,"ErrorInfo: "+JSON.stringify(this.state.errorInfo)),react.createElement("h2",null,"Component Stack"),componentStackLines.map((function(line,index){return react.createElement("p",{key:index},line)})))},ErrorBoundary}(react.Component);try{ErrorBoundary_ErrorBoundary.displayName="ErrorBoundary",ErrorBoundary_ErrorBoundary.__docgenInfo={description:"",displayName:"ErrorBoundary",props:{renderOnError:{defaultValue:null,description:"",name:"renderOnError",required:!1,type:{name:"((error?: Error, errorInfo?: ErrorInfo | undefined, children?: ReactNode) => ReactChild) | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundary"]={docgenInfo:ErrorBoundary_ErrorBoundary.__docgenInfo,name:"ErrorBoundary",path:"src/components/ErrorBoundary/ErrorBoundary.tsx#ErrorBoundary"})}catch(__react_docgen_typescript_loader_error){}var EMPTY_CONNECT_CONTEXT={sourceNode:void 0,sourcePort:void 0,targetNode:void 0,targetPort:void 0},ConnectingStateContext=Object(react.createContext)(EMPTY_CONNECT_CONTEXT);ConnectingStateContext.displayName="ConnectingStateContext";var ConnectingState_ConnectingState=function ConnectingState(_a){var sourceNode,sourcePort,targetNode,targetPort,children=_a.children,data=_a.data,connectState=_a.connectState;connectState&&(sourceNode=data.nodes.get(connectState.sourceNode),sourcePort=null==sourceNode?void 0:sourceNode.getPort(connectState.sourcePort),targetNode=connectState.targetNode?data.nodes.get(connectState.targetNode):void 0,targetPort=connectState.targetPort?null==targetNode?void 0:targetNode.getPort(connectState.targetPort):void 0);var context=react.useMemo((function(){return{sourceNode:sourceNode,sourcePort:sourcePort,targetNode:targetNode,targetPort:targetPort}}),[sourceNode,sourcePort,targetNode,targetPort]);return react.createElement(ConnectingStateContext.Provider,{value:context},children)};ConnectingState_ConnectingState.displayName="ConnectingState";try{ConnectingState_ConnectingState.displayName="ConnectingState",ConnectingState_ConnectingState.__docgenInfo={description:"",displayName:"ConnectingState",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},connectState:{defaultValue:null,description:"",name:"connectState",required:!0,type:{name:"IConnectingState | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ConnectingState.tsx#ConnectingState"]={docgenInfo:ConnectingState_ConnectingState.__docgenInfo,name:"ConnectingState",path:"src/ConnectingState.tsx#ConnectingState"})}catch(__react_docgen_typescript_loader_error){}var AlignmentLinesContext=Object(react.createContext)([]),GraphControllerContext=Object(react.createContext)(new GraphController_GraphController(EMPTY_GRAPH_STATE,noop));function GraphStateStore(props){var graphController=props.graphController,state=props.state,dispatch=props.dispatch,children=props.children,contextValue=react.useMemo((function(){return{state:state,dispatch:dispatch}}),[state,dispatch]);return react.createElement(GraphConfigContext.Provider,{value:state.settings.graphConfig},react.createElement(GraphControllerContext.Provider,{value:graphController},react.createElement(ConnectingState_ConnectingState,{data:state.data.present,connectState:state.connectState},react.createElement(GraphStateContext.Provider,{value:contextValue},react.createElement(ViewportContext.Provider,{value:state.viewport},react.createElement(GraphValueContext.Provider,{value:state.data.present},react.createElement(AlignmentLinesContext.Provider,{value:state.alignmentLines},children)))))))}try{GraphStateStore.displayName="GraphStateStore",GraphStateStore.__docgenInfo={description:"",displayName:"GraphStateStore",props:{state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"IGraphState<NodeData, EdgeData, PortData>"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"IDispatch<NodeData, EdgeData, PortData, Action>"}},graphController:{defaultValue:null,description:"",name:"graphController",required:!0,type:{name:"GraphController"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Graph/GraphStateStore.tsx#GraphStateStore"]={docgenInfo:GraphStateStore.__docgenInfo,name:"GraphStateStore",path:"src/components/Graph/GraphStateStore.tsx#GraphStateStore"})}catch(__react_docgen_typescript_loader_error){}var defaultTheme={controlPointColor:"#333333",primaryColor:"#0078D4",defaultColor:"#CCCCCC",borderColor:"#B3B0AD",defaultBorderColor:"#FFFFFF",unConnectableBgColor:"#E1DFDD",defaultBackgroundColor:"#FFFFFF",portStroke:"#ccc",portFill:"#fff",connectedPortColor:"gray",nodeActivateFill:"#ffffff",nodeActivateStroke:"#0078D4",nodeFill:"#ffffff",nodeStroke:"#cccccc",contextMenuBackground:"#FFFFFF",contextMenuBorder:"#E1DFDD",contextMenuHoverBackground:"rgba(0, 120, 212, 0.05)",fontColor:"#000000",canvasBackground:"#EDEDED",minimapBackground:"#EDEDED",edgeColor:"#ccc",edgeColorSelected:"#015cda",minimapShadow:"#000000",outlineStyle:"none",focusOutlineColor:"#000000",dummyNodeStroke:"#015cda",inputFocusBorderAlt:"#0078d4",buttonBorder:"#797775",scrollbarColor:"#c8c8c8"},ThemeProvider_ThemeProvider=function ThemeProvider(_a){var theme=_a.theme,_b=_a.setTheme,setTheme=void 0===_b?noop:_b,children=_a.children,themeContext=react.useMemo((function(){return{theme:Object(tslib_es6.a)(Object(tslib_es6.a)({},defaultTheme),theme),setTheme:setTheme}}),[setTheme,theme]);return react.createElement(ThemeContext.Provider,{value:themeContext},children)};try{ThemeProvider_ThemeProvider.displayName="ThemeProvider",ThemeProvider_ThemeProvider.__docgenInfo={description:"",displayName:"ThemeProvider",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"ITheme"}},setTheme:{defaultValue:{value:"() => {\n  // noop\n}"},description:"",name:"setTheme",required:!1,type:{name:"Dispatch<SetStateAction<ITheme>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ThemeProvider.tsx#ThemeProvider"]={docgenInfo:ThemeProvider_ThemeProvider.__docgenInfo,name:"ThemeProvider",path:"src/components/ThemeProvider.tsx#ThemeProvider"})}catch(__react_docgen_typescript_loader_error){}var ReactDagEditor_ReactDagEditor=function ReactDagEditor(props){var _a;react.useEffect((function(){props.handleWarning&&(Debug.warn=props.handleWarning)}),[]);var handleError=null===(_a=props.handleError)||void 0===_a?void 0:_a.bind(null),theme=props.theme,setTheme=props.setTheme,state=props.state,dispatch=props.dispatch,getGlobalEventTarget=props.getGlobalEventTarget,graphController=useConst((function(){return new GraphController_GraphController(state,dispatch)}));return graphController.UNSAFE_latestState=state,react.useLayoutEffect((function(){graphController.state=state,graphController.dispatch=dispatch,graphController.getGlobalEventTargetImpl=getGlobalEventTarget}),[dispatch,getGlobalEventTarget,graphController,state]),react.useEffect((function(){return function(){graphController.dispatch=noop}}),[graphController]),react.createElement(ErrorBoundary_ErrorBoundary,{renderOnError:handleError},react.createElement(GraphStateStore,{state:state,dispatch:dispatch,graphController:graphController},react.createElement(ContextMenuConfigContext.Provider,{value:useConst((function(){return new ContextMenuConfigContext_ContextMenuConfig}))},react.createElement(ThemeProvider_ThemeProvider,{theme:theme,setTheme:setTheme},react.createElement("div",{style:props.style,className:props.className},props.children)))))};try{ReactDagEditor_ReactDagEditor.displayName="ReactDagEditor",ReactDagEditor_ReactDagEditor.__docgenInfo={description:"ReactDagEditor top level container component",displayName:"ReactDagEditor",props:{style:{defaultValue:null,description:"Additional css styles to apply to the container element.",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"Additional css class to apply to the container element.",name:"className",required:!1,type:{name:"string"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"IGraphState<unknown, unknown, unknown>"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"IDispatch<unknown, unknown, unknown, never>"}},handleWarning:{defaultValue:null,description:"Fired when there is invalid data or config. The invalid data or config will be ignored to avoid crashing your app.",name:"handleWarning",required:!1,type:{name:"((message: string) => void)"}},handleError:{defaultValue:null,description:"Fired when ReactDagEditor catches an error. And the return value will be rendered.",name:"handleError",required:!1,type:{name:"((error?: Error, errorInfo?: ErrorInfo | undefined, children?: ReactNode) => ReactChild) | undefined"}},getGlobalEventTarget:{defaultValue:null,description:"Fallback to `window` if this is not provided or returns null or undefined",name:"getGlobalEventTarget",required:!1,type:{name:"(() => Window | Element | null) | undefined"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"ITheme"}},setTheme:{defaultValue:null,description:"",name:"setTheme",required:!1,type:{name:"Dispatch<SetStateAction<ITheme>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ReactDagEditor.tsx#ReactDagEditor"]={docgenInfo:ReactDagEditor_ReactDagEditor.__docgenInfo,name:"ReactDagEditor",path:"src/components/ReactDagEditor.tsx#ReactDagEditor"})}catch(__react_docgen_typescript_loader_error){}var GraphNodeEvent,GraphEdgeEvent,GraphPortEvent,GraphCanvasEvent,GraphScrollBarEvent,GraphMinimapEvent,GraphContextMenuEvent,useContextMenuConfigContext_useContextMenuConfigContext=function useContextMenuConfigContext(){return react.useContext(ContextMenuConfigContext)};!function(GraphNodeEvent){GraphNodeEvent.Click="[Node]Click",GraphNodeEvent.DoubleClick="[Node]DoubleClick",GraphNodeEvent.MouseDown="[Node]MouseDown",GraphNodeEvent.MouseUp="[Node]MouseUp",GraphNodeEvent.MouseEnter="[Node]MouseEnter",GraphNodeEvent.MouseLeave="[Node]MouseLeave",GraphNodeEvent.MouseOver="[Node]MouseOver",GraphNodeEvent.MouseOut="[Node]MouseOut",GraphNodeEvent.MouseMove="[Node]MouseMove",GraphNodeEvent.ContextMenu="[Node]ContextMenu",GraphNodeEvent.Drag="[Node]Drag",GraphNodeEvent.DragStart="[Node]DragStart",GraphNodeEvent.DragEnd="[Node]DragEnd",GraphNodeEvent.PointerDown="[Node]PointerDown",GraphNodeEvent.PointerEnter="[Node]PointerEnter",GraphNodeEvent.PointerMove="[Node]PointerMove",GraphNodeEvent.PointerLeave="[Node]PointerLeave",GraphNodeEvent.PointerUp="[Node]PointerUp",GraphNodeEvent.Resizing="[Node]Resizing",GraphNodeEvent.ResizingStart="[Node]ResizingStart",GraphNodeEvent.ResizingEnd="[Node]ResizingEnd",GraphNodeEvent.KeyDown="[Node]KeyDown",GraphNodeEvent.Select="[Node]Select",GraphNodeEvent.SelectAll="[Node]SelectAll",GraphNodeEvent.Centralize="[Node]Centralize",GraphNodeEvent.Locate="[Node]Locate",GraphNodeEvent.Add="[Node]Add"}(GraphNodeEvent||(GraphNodeEvent={})),function(GraphEdgeEvent){GraphEdgeEvent.Click="[Edge]Click",GraphEdgeEvent.DoubleClick="[Edge]DoubleClick",GraphEdgeEvent.MouseEnter="[Edge]MouseEnter",GraphEdgeEvent.MouseLeave="[Edge]MouseLeave",GraphEdgeEvent.MouseOver="[Edge]MouseOver",GraphEdgeEvent.MouseOut="[Edge]MouseOut",GraphEdgeEvent.MouseMove="[Edge]MouseMove",GraphEdgeEvent.MouseDown="[Edge]MouseDown",GraphEdgeEvent.MouseUp="[Edge]MouseUp",GraphEdgeEvent.ContextMenu="[Edge]ContextMenu",GraphEdgeEvent.ConnectStart="[Edge]ConnectStart",GraphEdgeEvent.ConnectMove="[Edge]ConnectMove",GraphEdgeEvent.ConnectEnd="[Edge]ConnectEnd",GraphEdgeEvent.ConnectNavigate="[Edge]ConnectNavigate",GraphEdgeEvent.Add="[Edge]Add"}(GraphEdgeEvent||(GraphEdgeEvent={})),function(GraphPortEvent){GraphPortEvent.Click="[Port]Click",GraphPortEvent.DoubleClick="[Port]DoubleClick",GraphPortEvent.MouseDown="[Port]MouseDown",GraphPortEvent.PointerDown="[Port]PointerDown",GraphPortEvent.PointerUp="[Port]PointerUp",GraphPortEvent.PointerEnter="[Port]PointerEnter",GraphPortEvent.PointerLeave="[Port]PointerLeave",GraphPortEvent.MouseUp="[Port]MouseUp",GraphPortEvent.MouseEnter="[Port]MouseEnter",GraphPortEvent.MouseLeave="[Port]MouseLeave",GraphPortEvent.MouseOver="[Port]MouseOver",GraphPortEvent.MouseOut="[Port]MouseOut",GraphPortEvent.MouseMove="[Port]MouseMove",GraphPortEvent.ContextMenu="[Port]ContextMenu",GraphPortEvent.KeyDown="[Port]KeyDown",GraphPortEvent.Focus="[Port]Focus",GraphPortEvent.Blur="[Port]Blur"}(GraphPortEvent||(GraphPortEvent={})),function(GraphCanvasEvent){GraphCanvasEvent.Click="[Canvas]Click",GraphCanvasEvent.DoubleClick="[Canvas]DoubleClick",GraphCanvasEvent.MouseDown="[Canvas]MouseDown",GraphCanvasEvent.MouseUp="[Canvas]MouseUp",GraphCanvasEvent.MouseEnter="[Canvas]MouseEnter",GraphCanvasEvent.MouseLeave="[Canvas]MouseLeave",GraphCanvasEvent.MouseOver="[Canvas]MouseOver",GraphCanvasEvent.MouseOut="[Canvas]MouseOut",GraphCanvasEvent.MouseMove="[Canvas]MouseMove",GraphCanvasEvent.ContextMenu="[Canvas]ContextMenu",GraphCanvasEvent.DragStart="[Canvas]DragStart",GraphCanvasEvent.Drag="[Canvas]Drag",GraphCanvasEvent.DragEnd="[Canvas]DragEnd",GraphCanvasEvent.Pan="[Canvas]Pan",GraphCanvasEvent.Focus="[Canvas]Focus",GraphCanvasEvent.Blur="[Canvas]Blur",GraphCanvasEvent.Zoom="[Canvas]Zoom",GraphCanvasEvent.Pinch="[Canvas]Pinch",GraphCanvasEvent.KeyDown="[Canvas]KeyDown",GraphCanvasEvent.KeyUp="[Canvas]KeyUp",GraphCanvasEvent.SelectStart="[Canvas]SelectStart",GraphCanvasEvent.SelectMove="[Canvas]SelectMove",GraphCanvasEvent.SelectEnd="[Canvas]SelectEnd",GraphCanvasEvent.UpdateNodeSelectionBySelectBox="[Canvas]UpdateNodeSelectionBySelectBox",GraphCanvasEvent.MouseWheelScroll="[Canvas]MouseWheelScroll",GraphCanvasEvent.DraggingNodeFromItemPanel="[Canvas]DraggingNodeFromItemPanel",GraphCanvasEvent.DraggingNodeFromItemPanelStart="[Canvas]DraggingNodeFromItemPanelStart",GraphCanvasEvent.DraggingNodeFromItemPanelEnd="[Canvas]DraggingNodeFromItemPanelEnd",GraphCanvasEvent.ViewportResize="[Canvas]ViewportResize",GraphCanvasEvent.Navigate="[Canvas]Navigate",GraphCanvasEvent.VirtualizationRecalculated="[Canvas]VirtualizationRecalculated",GraphCanvasEvent.ResetSelection="[Canvas]ResetSelection",GraphCanvasEvent.Copy="[Canvas]Copy",GraphCanvasEvent.Paste="[Canvas]Paste",GraphCanvasEvent.Delete="[Canvas]Delete",GraphCanvasEvent.Undo="[Canvas]Undo",GraphCanvasEvent.Redo="[Canvas]Redo",GraphCanvasEvent.ScrollIntoView="[Canvas]ScrollIntoView",GraphCanvasEvent.ResetUndoStack="[Canvas]ResetUndoStack",GraphCanvasEvent.ResetViewport="[Canvas]ResetViewport",GraphCanvasEvent.ZoomTo="[Canvas]ZoomTo",GraphCanvasEvent.ZoomToFit="[Canvas]ZoomToFit",GraphCanvasEvent.SetData="[Canvas]SetData",GraphCanvasEvent.UpdateData="[Canvas]UpdateData",GraphCanvasEvent.ScrollTo="[Canvas]ScrollTo",GraphCanvasEvent.UpdateSettings="[Canvas]UpdateSettings"}(GraphCanvasEvent||(GraphCanvasEvent={})),function(GraphScrollBarEvent){GraphScrollBarEvent.ScrollStart="[ScrollBar]ScrollStart",GraphScrollBarEvent.Scroll="[ScrollBar]Scroll",GraphScrollBarEvent.ScrollEnd="[ScrollBar]ScrollEnd"}(GraphScrollBarEvent||(GraphScrollBarEvent={})),function(GraphMinimapEvent){GraphMinimapEvent.PanStart="[Minimap]PanStart",GraphMinimapEvent.Pan="[Minimap]Pan",GraphMinimapEvent.PanEnd="[Minimap]PanEnd",GraphMinimapEvent.Click="[Minimap]Click"}(GraphMinimapEvent||(GraphMinimapEvent={})),function(GraphContextMenuEvent){GraphContextMenuEvent.Open="[ContextMenu]Open",GraphContextMenuEvent.Close="[ContextMenu]Close"}(GraphContextMenuEvent||(GraphContextMenuEvent={}));var scrollLineHeight=function getScrollLineHeight(){try{var iframe=document.createElement("iframe");iframe.src="#",document.body.appendChild(iframe);var contentWindow=iframe.contentWindow;if(!contentWindow)throw new Error("Fail to create iframe");var doc=contentWindow.document;if(!doc)throw new Error("Fail to create iframe");doc.open(),doc.write("<!DOCTYPE html><html><head></head><body><span>a</span></body></html>"),doc.close();var height=doc.body.firstElementChild.offsetHeight;return document.body.removeChild(iframe),height}catch(e){return Debug.error("failed to calculate scroll line height",e),16}}(),normalizeWheelDelta="function"==typeof WheelEvent?function(deltaMode,delta){switch(deltaMode){case WheelEvent.DOM_DELTA_PIXEL:return delta;case WheelEvent.DOM_DELTA_LINE:return delta*scrollLineHeight;case WheelEvent.DOM_DELTA_PAGE:return delta*window.innerHeight;default:return delta}}:function(deltaMode,delta){return delta};var useContainerRect_useContainerRect=function useContainerRect(svgRef,containerRef,updateViewport){Object(react.useLayoutEffect)(updateViewport,[updateViewport]),Object(react.useEffect)((function(){var container=containerRef.current;if(!container)return noop;var onResize=debounce_debounce((function(){return function nextFrame(callback){requestAnimationFrame((function(){requestAnimationFrame(callback)}))}((function(){updateViewport()}))}),20);if("undefined"!=typeof ResizeObserver){var resizeObserver_1=new ResizeObserver(onResize);return resizeObserver_1.observe(container),function(){resizeObserver_1.unobserve(container),resizeObserver_1.disconnect()}}return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[containerRef,updateViewport]),Object(react.useEffect)((function(){var listener=debounce_debounce((function(e){var svg=svgRef.current;svg&&e.target instanceof Element&&e.target.contains(svg)&&updateViewport()}),20),options={capture:!0,passive:!0};return document.body.addEventListener("scroll",listener,options),function(){document.body.removeEventListener("scroll",listener,options)}}),[svgRef,updateViewport])};function makeScheduledCallback(callback,schedule,cancel){var currentArgs,task,scheduled=!1,scheduledCallback=function scheduledCallback(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];currentArgs=args,scheduled||(scheduled=!0,task=schedule((function(){scheduled=!1,Object(react_dom.unstable_batchedUpdates)((function(){callback.apply(null,currentArgs)}))})))};return scheduledCallback.cancel=function(){cancel(task)},scheduledCallback}var animationFramed=function animationFramed(callback){return makeScheduledCallback(callback,requestAnimationFrame,cancelAnimationFrame)},throttle=function throttle(callback,limit){return makeScheduledCallback(callback,(function(cb){return setTimeout(cb,limit)}),clearTimeout)};var getMinimapRect=function getMinimapRect(svgRef){var _a,_b;return null===(_b=null===(_a=svgRef.current)||void 0===_a?void 0:_a.closest(".minimap-container"))||void 0===_b?void 0:_b.getBoundingClientRect()},DragController_DragController=function(){function DragController(eventProvider,getPositionFromEvent){var _this=this;this.onMove=noop,this.onEnd=noop,this.lastEvent=null,this.startX=0,this.startY=0,this.prevClientX=0,this.prevClientY=0,this.onMouseUp=function(e){_this.lastEvent=e,_this.doOnMouseUp(e),_this.lastEvent=null},this.onMouseMove=function(e){_this.lastEvent=e,e.preventDefault(),_this.mouseMove(e)},this.eventProvider=eventProvider,this.getPositionFromEvent=getPositionFromEvent,this.mouseMove=animationFramed((function(e){_this.doOnMouseMove(e)}))}return DragController.prototype.start=function(e){this.lastEvent=e;var _a=this.getPositionFromEvent(e),x=_a.x,y=_a.y;this.startX=x,this.startY=y,this.prevClientX=x,this.prevClientY=y,this.eventProvider.on("move",this.onMouseMove),this.eventProvider.on("end",this.onMouseUp)},DragController.prototype.stop=function(){this.mouseMove.cancel(),this.eventProvider.off("move",this.onMouseMove),this.eventProvider.off("end",this.onMouseUp)},DragController.prototype.getDelta=function(x,y){var clientDX=x-this.prevClientX,clientDY=y-this.prevClientY;return this.prevClientX=x,this.prevClientY=y,{x:clientDX,y:clientDY}},DragController.prototype.getTotalDelta=function(e){return{x:e.clientX-this.startX,y:e.clientY-this.startY}},DragController.prototype.doOnMouseMove=function(e){var _a=this.getPositionFromEvent(e),x=_a.x,y=_a.y,_b=this.getDelta(x,y),dx=_b.x,dy=_b.y,_c=this.getTotalDelta(e),totalDX=_c.x,totalDY=_c.y;this.onMove({clientX:x,clientY:y,dx:dx,dy:dy,totalDX:totalDX,totalDY:totalDY,e:e})},DragController.prototype.doOnMouseUp=function(e){e.preventDefault();var _a=this.getTotalDelta(e),totalDX=_a.x,totalDY=_a.y;this.onEnd({totalDX:totalDX,totalDY:totalDY,e:e}),this.stop()},DragController}();function defaultGetPositionFromEvent(e){return{x:e.clientX,y:e.clientY}}var DragNodeController_DragNodeController=function(_super){function DragNodeController(globalMoveEventProvider,getPositionFromEvent,rectRef){var _this=_super.call(this,globalMoveEventProvider,getPositionFromEvent)||this;return _this.rectRef=rectRef,_this}return Object(tslib_es6.c)(DragNodeController,_super),DragNodeController.prototype.doOnMouseMove=function(e){_super.prototype.doOnMouseMove.call(this,e);var rect=this.rectRef.current;rect&&this.lastEvent&&(e.clientX<rect.left||e.clientX>rect.right||e.clientY<rect.top||e.clientY>rect.bottom)&&this.mouseMove(this.lastEvent)},DragNodeController}(DragController_DragController),TouchController_TouchController=function(){function TouchController(handlers){var _this=this;this.eventHandlers={onPointerDown:function onPointerDown(e){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];"touch"===e.pointerType&&(e.preventDefault(),_this.pointers=new Map(_this.pointers),_this.pointers.set(e.pointerId,e.nativeEvent),_this.updateHandler.apply(_this,Object(tslib_es6.f)([e.nativeEvent],args)))},onPointerMove:function onPointerMove(e){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];"touch"===e.pointerType&&(e.preventDefault(),_this.pointers.set(e.pointerId,e.nativeEvent),_this.onMove.apply(_this,Object(tslib_es6.f)([e.nativeEvent],args)))},onPointerUp:function onPointerUp(e){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];"touch"===e.pointerType&&(e.preventDefault(),_this.pointers=new Map(_this.pointers),_this.pointers.delete(e.pointerId),_this.updateHandler.apply(_this,Object(tslib_es6.f)([e.nativeEvent],args)))}},this.pointers=new Map,this.onMove=animationFramed((function(e){for(var _a,args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];null===(_a=_this.currentHandler)||void 0===_a||_a.onMove.apply(_a,Object(tslib_es6.f)([_this.pointers,e],args))})),this.handlers=handlers}return TouchController.prototype.updateHandler=function(e){for(var _a,_b,args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var handler=this.handlers.get(this.pointers.size);handler!==this.currentHandler&&(null===(_a=this.currentHandler)||void 0===_a||_a.onEnd.apply(_a,Object(tslib_es6.f)([e],args)),this.currentHandler=handler,null===(_b=this.currentHandler)||void 0===_b||_b.onStart.apply(_b,Object(tslib_es6.f)([this.pointers,e],args)))},TouchController}(),TwoFingerHandler_TwoFingerHandler=function(){function TwoFingerHandler(rectRef,eventChannel){this.prevDistance=0,this.rectRef=rectRef,this.eventChannel=eventChannel}return TwoFingerHandler.prototype.onEnd=function(){},TwoFingerHandler.prototype.onMove=function(pointers,e){var events=Array.from(pointers.values()),currentDistance=geometric_distance(events[0].clientX,events[0].clientY,events[1].clientX,events[1].clientY),prevEvents=this.prevEvents,prevDistance=this.prevDistance;if(this.prevDistance=currentDistance,this.prevEvents=events,prevEvents){var dx=(events[0].clientX-prevEvents[0].clientX+(events[1].clientX-prevEvents[1].clientX))/2,dy=(events[0].clientY-prevEvents[0].clientY+(events[1].clientY-prevEvents[1].clientY))/2,scale=(currentDistance-prevDistance)/prevDistance+1,anchor=getContainerCenter(this.rectRef);anchor&&this.eventChannel.trigger({type:GraphCanvasEvent.Pinch,rawEvent:e,dx:dx,dy:dy,scale:scale,anchor:anchor})}},TwoFingerHandler.prototype.onStart=function(pointers){if(2!==pointers.size)throw new Error("Unexpected touch event with "+pointers.size+" touches");this.prevEvents=Array.from(pointers.values()),this.prevDistance=geometric_distance(this.prevEvents[0].clientX,this.prevEvents[0].clientY,this.prevEvents[1].clientX,this.prevEvents[1].clientY)},TwoFingerHandler}(),isSafari=getBrowser()===BrowserType.safari,prevScale=0;function useDeferredValue(value,_a){var timeout=_a.timeout,_b=Object(react.useState)(value),state=_b[0],setState=_b[1];return Object(react.useEffect)((function(){var timer=setTimeout((function(){setState(value)}),timeout);return function(){clearTimeout(timer)}}),[value,timeout]),state}var VirtualizationContext=Object(react.createContext)({viewport:{rect:{height:0,width:0,x:0,y:0,bottom:0,left:0,right:0,top:0,toJSON:function toJSON(){return this}},transformMatrix:EMPTY_TRANSFORM_MATRIX},renderedArea:{minX:0,minY:0,maxX:0,maxY:0},visibleArea:{minX:0,minY:0,maxX:0,maxY:0},renderedNodes:new Set,renderedEdges:new Set,timestamp:0});function useGraphConfig(){return Object(react.useContext)(GraphConfigContext)}function useGraphController(){return Object(react.useContext)(GraphControllerContext)}function useViewport(){return Object(react.useContext)(ViewportContext)}function useAlignmentLines(){return Object(react.useContext)(AlignmentLinesContext)}function useVirtualization(){return Object(react.useContext)(VirtualizationContext)}__webpack_require__(157);var eventemitter3=__webpack_require__(449),PointerEventProvider_PointerEventProvider=function(){function PointerEventProvider(target,pointerId){var _this=this;void 0===pointerId&&(pointerId=null),this.eventEmitter=new eventemitter3.EventEmitter,this.onMove=function(e){null!==_this.pointerId&&_this.pointerId!==e.pointerId||_this.eventEmitter.emit("move",e)},this.onUp=function(e){null!==_this.pointerId&&_this.pointerId!==e.pointerId||_this.eventEmitter.emit("end",e)},this.target=target,this.pointerId=pointerId}return PointerEventProvider.prototype.off=function(type,callback){return this.eventEmitter.off(type,callback),this.ensureRemoveListener(type),this},PointerEventProvider.prototype.on=function(type,callback){return this.ensureAddListener(type),this.eventEmitter.on(type,callback),this},PointerEventProvider.prototype.ensureAddListener=function(type){if(!this.eventEmitter.listeners(type).length)switch(type){case"move":this.target.addEventListener("pointermove",this.onMove);break;case"end":this.target.addEventListener("pointerup",this.onUp)}},PointerEventProvider.prototype.ensureRemoveListener=function(type){if(!this.eventEmitter.listeners(type).length)switch(type){case"move":this.target.removeEventListener("pointermove",this.onMove);break;case"end":this.target.removeEventListener("pointerup",this.onUp)}},PointerEventProvider}(),MouseMoveEventProvider=function(){function MouseMoveEventProvider(target){this.target=target}return MouseMoveEventProvider.prototype.off=function(type,callback){switch(type){case"move":this.target.removeEventListener("mousemove",callback);break;case"end":this.target.removeEventListener("mouseup",callback)}return this},MouseMoveEventProvider.prototype.on=function(type,callback){switch(type){case"move":this.target.addEventListener("mousemove",callback);break;case"end":this.target.addEventListener("mouseup",callback)}return this},MouseMoveEventProvider}(),container_withSimulatedClick=function withSimulatedClick(params,type){return function(_a){var _b,totalDX=_a.totalDX,totalDY=_a.totalDY,rawEvent=_a.e,eventChannel=params.eventChannel,dragThreshold=params.dragThreshold,containerRef=params.containerRef,events=[];events.push({type:type,rawEvent:rawEvent}),rawEvent.target instanceof Node&&(null===(_b=containerRef.current)||void 0===_b?void 0:_b.contains(rawEvent.target))&&isWithinThreshold(totalDX,totalDY,dragThreshold)&&events.push({type:GraphCanvasEvent.Click,rawEvent:rawEvent}),eventChannel.batch(events)}},container_onContainerMouseDown=function onContainerMouseDown(e,params){var _a;if(e.preventDefault(),e.stopPropagation(),e.button===MouseEventButton.Primary){var canvasMouseMode=params.canvasMouseMode,isPanDisabled=params.isPanDisabled,isMultiSelectDisabled=params.isMultiSelectDisabled,state=params.state,isLassoSelectEnable=params.isLassoSelectEnable,graphController=params.graphController,isPanMode=canvasMouseMode===CanvasMouseMode.pan&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey||(null===(_a=state.activeKeys)||void 0===_a?void 0:_a.has(" "));!isPanDisabled&&isPanMode?function dragPan(e,params){var getPositionFromEvent=params.getPositionFromEvent,graphController=params.graphController,eventChannel=params.eventChannel,dragging=new DragController_DragController(new MouseMoveEventProvider(graphController.getGlobalEventTarget()),getPositionFromEvent);dragging.onMove=function(_a){var dx=_a.dx,dy=_a.dy,rawEvent=_a.e;eventChannel.trigger({type:GraphCanvasEvent.Drag,rawEvent:rawEvent,dx:dx,dy:dy})},dragging.onEnd=container_withSimulatedClick(params,GraphCanvasEvent.DragEnd),dragging.start(e),eventChannel.trigger({type:GraphCanvasEvent.DragStart,rawEvent:e})}(e.nativeEvent,params):!isMultiSelectDisabled||isLassoSelectEnable&&!e.ctrlKey&&!e.metaKey?function dragMultiSelect(e,params){var getPositionFromEvent=params.getPositionFromEvent,graphController=params.graphController,eventChannel=params.eventChannel,dragging=new DragController_DragController(new MouseMoveEventProvider(graphController.getGlobalEventTarget()),getPositionFromEvent);dragging.onMove=function(_a){var dx=_a.dx,dy=_a.dy,rawEvent=_a.e;eventChannel.trigger({type:GraphCanvasEvent.SelectMove,rawEvent:rawEvent,dx:dx,dy:dy})},dragging.onEnd=container_withSimulatedClick(params,GraphCanvasEvent.SelectEnd),eventChannel.trigger({type:GraphCanvasEvent.SelectStart,rawEvent:e}),dragging.start(e)}(e.nativeEvent,params):graphController.canvasClickOnce=!0}},behaviorReducer_handleBehaviorChange=function handleBehaviorChange(prevBehavior,event){switch(event.type){case GraphNodeEvent.DragStart:return GraphBehavior.dragging;case GraphEdgeEvent.ConnectStart:return GraphBehavior.connecting;case GraphCanvasEvent.SelectStart:return GraphBehavior.multiSelect;case GraphCanvasEvent.DragStart:return GraphBehavior.panning;case GraphCanvasEvent.DraggingNodeFromItemPanelStart:return GraphBehavior.addingNode;case GraphNodeEvent.DragEnd:case GraphEdgeEvent.ConnectEnd:case GraphCanvasEvent.SelectEnd:case GraphCanvasEvent.DragEnd:case GraphCanvasEvent.DraggingNodeFromItemPanelEnd:return GraphBehavior.default;default:return prevBehavior}},VisitPortHelper_VisitPortHelper=function VisitPortHelper(props){var neighborPorts=props.neighborPorts,data=props.data,selectRef=react.useRef(null),_a=react.useState(),selectedItem=_a[0],setSelectedItem=_a[1],onContainerKeyDown=react.useCallback((function(evt){"Escape"===evt.key&&(evt.stopPropagation(),evt.preventDefault(),selectedItem&&props.onComplete(selectedItem))}),[selectedItem,props]),onContainerBlur=react.useCallback((function(evt){}),[]),onContainerChange=react.useCallback((function(evt){var value=JSON.parse(evt.target.value);value.nodeId&&value.portId&&setSelectedItem({nodeId:value.nodeId,portId:value.portId})}),[setSelectedItem]);return react.useEffect((function(){selectRef.current&&selectRef.current.focus({preventScroll:!0})}),[]),react.createElement("select",{onKeyDown:onContainerKeyDown,onBlur:onContainerBlur,ref:selectRef,onChange:onContainerChange},neighborPorts.map((function(s){var isSelected=selectedItem&&selectedItem.portId===s.portId&&selectedItem.nodeId===s.nodeId,value=JSON.stringify(s),node=data.nodes.get(s.nodeId);if(!node)return null;var port=node.ports?node.ports.filter((function(p){return p.id===s.portId}))[0]:null;if(!port)return null;var label=(node.ariaLabel||node.name||node.id)+": "+(port.ariaLabel||port.name||port.id);return react.createElement("option",{key:s.nodeId+"-"+s.portId,value:value,"aria-selected":isSelected,"aria-label":label},label)})))};try{VisitPortHelper_VisitPortHelper.displayName="VisitPortHelper",VisitPortHelper_VisitPortHelper.__docgenInfo={description:"",displayName:"VisitPortHelper",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},neighborPorts:{defaultValue:null,description:"",name:"neighborPorts",required:!0,type:{name:"INeighborItem[]"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!0,type:{name:"(item: INeighborItem) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/A11yHelpers/VisitPortHelper.tsx#VisitPortHelper"]={docgenInfo:VisitPortHelper_VisitPortHelper.__docgenInfo,name:"VisitPortHelper",path:"src/components/A11yHelpers/VisitPortHelper.tsx#VisitPortHelper"})}catch(__react_docgen_typescript_loader_error){}var a11yUtils_item=function item(node,port){return void 0===node&&(node=void 0),void 0===port&&(port=void 0),{node:node,port:port}},a11yUtils_findDOMElement=function findDOMElement(svg,_a){var _b,_c,id,node=_a.node,port=_a.port;if(node&&port)id=getPortUid(null!==(_b=svg.dataset.graphId)&&void 0!==_b?_b:"",node,port);else{if(!node)return null;id=getNodeUid(null!==(_c=svg.dataset.graphId)&&void 0!==_c?_c:"",node)}return svg.getElementById(id)},a11yUtils_focusItem=function focusItem(svgRef,nextItem,evt,eventChannel){if(svgRef.current){var el=a11yUtils_findDOMElement(svgRef.current,nextItem);el?(evt.preventDefault(),evt.stopPropagation(),el.focus({preventScroll:!0}),eventChannel.trigger({type:GraphCanvasEvent.Navigate,node:nextItem.node,port:nextItem.port,rawEvent:evt})):nextItem.node||nextItem.port||eventChannel.trigger({type:GraphCanvasEvent.Navigate,node:nextItem.node,port:nextItem.port,rawEvent:evt})}},getNextItem=function getNextItem(data,curNode,port){if(curNode.ports){var nextPortIndex=(port?curNode.ports.findIndex((function(p){return p.id===port.id})):-1)+1;if(nextPortIndex<curNode.ports.length)return a11yUtils_item(curNode,curNode.ports[nextPortIndex])}var nextNode=curNode.next&&data.nodes.get(curNode.next);return nextNode?a11yUtils_item(nextNode):a11yUtils_item()},getPrevItem=function getPrevItem(data,curNode,port){if(port&&curNode.ports){var prevPortIndex=curNode.ports.findIndex((function(p){return p.id===port.id}))-1;return prevPortIndex>=0?a11yUtils_item(curNode,curNode.ports[prevPortIndex]):a11yUtils_item(curNode)}var prevNode=curNode.prev&&data.nodes.get(curNode.prev);return prevNode?a11yUtils_item(prevNode,prevNode.ports&&prevNode.ports.length?prevNode.ports[prevNode.ports.length-1]:void 0):a11yUtils_item()},a11yUtils_getFocusNodeHandler=function getFocusNodeHandler(compareFn){return function(data,curNodeId,svgRef,graphController,evt,eventChannel){var sortedNodes=Array.from(data.nodes.values()).sort(compareFn),curNodeIndex=sortedNodes.findIndex((function(n){return n.id===curNodeId})),nextNode=sortedNodes[(curNodeIndex+1)%sortedNodes.length];nextNode&&svgRef.current&&(graphController.dispatch({type:GraphNodeEvent.Select,nodes:[nextNode.id]}),graphController.dispatch({type:GraphNodeEvent.Centralize,nodes:[nextNode.id]}),a11yUtils_focusItem(svgRef,{node:nextNode,port:void 0},evt,eventChannel))}},focusLeftNode=a11yUtils_getFocusNodeHandler((function(n1,n2){return 10*n1.x+n1.y-10*n2.x-n2.y})),focusRightNode=a11yUtils_getFocusNodeHandler((function(n1,n2){return 10*n2.x+n2.y-10*n1.x-n1.y})),focusDownNode=a11yUtils_getFocusNodeHandler((function(n1,n2){return n1.x+10*n1.y-n2.x-10*n2.y})),focusUpNode=a11yUtils_getFocusNodeHandler((function(n1,n2){return n2.x+10*n2.y-n1.x-10*n1.y}));function defaultGetPortAriaLabel(data,node,port){return port.ariaLabel}function defaultGetNodeAriaLabel(node){return node.ariaLabel}try{defaultGetNodeAriaLabel.displayName="defaultGetNodeAriaLabel",defaultGetNodeAriaLabel.__docgenInfo={description:"",displayName:"defaultGetNodeAriaLabel",props:{shape:{defaultValue:null,description:"",name:"shape",required:!1,type:{name:"string"}},x:{defaultValue:null,description:"",name:"x",required:!0,type:{name:"number"}},y:{defaultValue:null,description:"",name:"y",required:!0,type:{name:"number"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},state:{defaultValue:null,description:"",name:"state",required:!1,type:{name:"GraphNodeState"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"number"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number"}},automationId:{defaultValue:null,description:"",name:"automationId",required:!1,type:{name:"string"}},isInSearchResults:{defaultValue:null,description:"",name:"isInSearchResults",required:!1,type:{name:"boolean"}},isCurrentSearchResult:{defaultValue:null,description:"",name:"isCurrentSearchResult",required:!1,type:{name:"boolean"}},ports:{defaultValue:null,description:"",name:"ports",required:!1,type:{name:"readonly ICanvasPort<unknown>[]"}},ariaLabel:{defaultValue:null,description:"",name:"ariaLabel",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"Readonly<unknown>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/utils/a11yUtils.tsx#defaultGetNodeAriaLabel"]={docgenInfo:defaultGetNodeAriaLabel.__docgenInfo,name:"defaultGetNodeAriaLabel",path:"src/utils/a11yUtils.tsx#defaultGetNodeAriaLabel"})}catch(__react_docgen_typescript_loader_error){}try{a11yUtils_getFocusNodeHandler.displayName="getFocusNodeHandler",a11yUtils_getFocusNodeHandler.__docgenInfo={description:"",displayName:"getFocusNodeHandler",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/utils/a11yUtils.tsx#getFocusNodeHandler"]={docgenInfo:a11yUtils_getFocusNodeHandler.__docgenInfo,name:"getFocusNodeHandler",path:"src/utils/a11yUtils.tsx#getFocusNodeHandler"})}catch(__react_docgen_typescript_loader_error){}var prevMouseDownPortId,prevMouseDownPortTime;function useEventChannel(_a){var props=_a.props,dispatch=_a.dispatch,rectRef=_a.rectRef,svgRef=_a.svgRef,containerRef=_a.containerRef,featureControl=_a.featureControl,graphConfig=_a.graphConfig,setFocusedWithoutMouse=_a.setFocusedWithoutMouse,setCurHoverNode=_a.setCurHoverNode,setCurHoverPort=_a.setCurHoverPort,eventChannel=_a.eventChannel,updateViewport=_a.updateViewport,graphController=_a.graphController,_b=props.dragThreshold,dragThreshold=void 0===_b?10:_b,_c=props.autoAlignThreshold,autoAlignThreshold=void 0===_c?50:_c,_d=props.getPositionFromEvent,getPositionFromEvent=void 0===_d?defaultGetPositionFromEvent:_d,canvasMouseMode=props.canvasMouseMode,edgeWillAdd=props.edgeWillAdd,isNodesDraggable=featureControl.isNodesDraggable,isAutoAlignEnable=featureControl.isAutoAlignEnable,isClickNodeToSelectDisabled=featureControl.isClickNodeToSelectDisabled,isPanDisabled=featureControl.isPanDisabled,isMultiSelectDisabled=featureControl.isMultiSelectDisabled,isLassoSelectEnable=featureControl.isLassoSelectEnable,isConnectDisabled=featureControl.isConnectDisabled,isPortHoverViewEnable=featureControl.isPortHoverViewEnable,isNodeEditDisabled=featureControl.isNodeEditDisabled,isA11yEnable=featureControl.isA11yEnable,animationFramedDispatch=react.useMemo((function(){return animationFramed(dispatch)}),[dispatch]),keyDownHandler=function useCanvasKeyboardEventHandlers(args){var featureControl=args.featureControl,graphConfig=args.graphConfig,setCurHoverNode=args.setCurHoverNode,setCurHoverPort=args.setCurHoverPort,eventChannel=args.eventChannel,isDeleteDisabled=featureControl.isDeleteDisabled,isPasteDisabled=featureControl.isPasteDisabled,isUndoEnabled=featureControl.isUndoEnabled;return react.useMemo((function(){var keyDownHandlerMap=new Map,deleteKeyDownHandler=function deleteKeyDownHandler(){return function(evt){evt.preventDefault(),evt.stopPropagation(),isDeleteDisabled||(eventChannel.trigger({type:GraphCanvasEvent.Delete}),setCurHoverNode(void 0),setCurHoverPort(void 0))}};keyDownHandlerMap.set("delete",deleteKeyDownHandler()),keyDownHandlerMap.set("backspace",deleteKeyDownHandler());keyDownHandlerMap.set("c",(function cKeyDownHandler(evt){keyboard_metaControl(evt)&&(evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphCanvasEvent.Copy}))}));keyDownHandlerMap.set("v",(function vKeyDownHandler(evt){if(keyboard_metaControl(evt)){if(evt.preventDefault(),evt.stopPropagation(),isPasteDisabled)return;var data=graphConfig.getClipboard().read();data&&eventChannel.trigger({type:GraphCanvasEvent.Paste,data:data})}}));keyDownHandlerMap.set("z",(function zKeyDownHandler(evt){keyboard_metaControl(evt)&&(evt.preventDefault(),evt.stopPropagation(),isUndoEnabled&&eventChannel.trigger({type:GraphCanvasEvent.Undo}))}));keyDownHandlerMap.set("y",(function yKeyDownHandler(evt){keyboard_metaControl(evt)&&(evt.preventDefault(),evt.stopPropagation(),isUndoEnabled&&eventChannel.trigger({type:GraphCanvasEvent.Redo}))}));keyDownHandlerMap.set("a",(function aKeyDownHandler(evt){keyboard_metaControl(evt)&&(evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphNodeEvent.SelectAll}))}));return keyDownHandlerMap.set(" ",(function spaceKeyDownHandler(evt){evt.preventDefault(),evt.stopPropagation()})),keyDownHandlerMap.set("control",(function ctrlKeyDownHandler(evt){evt.preventDefault(),evt.stopPropagation()})),keyDownHandlerMap.set("meta",(function metaKeyDownHandler(evt){evt.preventDefault(),evt.stopPropagation()})),keyDownHandlerMap.set("shift",(function shiftKeyDownHandler(evt){evt.preventDefault(),evt.stopPropagation()})),function(evt){if(!evt.repeat){var key=evt.key.toLowerCase(),handler=keyDownHandlerMap.get(key);handler&&handler.call(null,evt)}}}),[eventChannel,graphConfig,isDeleteDisabled,isPasteDisabled,isUndoEnabled,setCurHoverNode,setCurHoverPort])}({featureControl:featureControl,eventChannel:eventChannel,graphConfig:graphConfig,setCurHoverNode:setCurHoverNode,setCurHoverPort:setCurHoverPort}),handleCanvasEvent=function handleCanvasEvent(event){var _a,_b;switch(event.type){case GraphCanvasEvent.ViewportResize:case GraphCanvasEvent.Drag:case GraphCanvasEvent.MouseWheelScroll:case GraphCanvasEvent.Zoom:case GraphCanvasEvent.Pinch:case GraphCanvasEvent.Click:case GraphCanvasEvent.SelectStart:case GraphCanvasEvent.SelectMove:case GraphCanvasEvent.SelectEnd:case GraphCanvasEvent.ResetSelection:case GraphCanvasEvent.Navigate:case GraphCanvasEvent.Paste:case GraphCanvasEvent.Undo:case GraphCanvasEvent.Redo:case GraphCanvasEvent.Delete:case GraphCanvasEvent.KeyUp:case GraphCanvasEvent.DraggingNodeFromItemPanelStart:case GraphCanvasEvent.DraggingNodeFromItemPanel:case GraphCanvasEvent.DraggingNodeFromItemPanelEnd:dispatch(event);break;case GraphCanvasEvent.Copy:var selectedData=function filterSelectedItems(data){var nodes=new Map,edges=[];return data.nodes.forEach((function(_a){var inner=_a.inner;state_isSelected(inner)&&nodes.set(inner.id,inner)})),data.edges.forEach((function(_a){var inner=_a.inner;(state_isSelected(inner)||nodes.has(inner.source)&&nodes.has(inner.target))&&edges.push(inner)})),{nodes:Array.from(nodes.values()),edges:edges}}(graphController.getData());graphConfig.getClipboard().write(selectedData);break;case GraphCanvasEvent.KeyDown:event.rawEvent.repeat||event.rawEvent.target!==event.rawEvent.currentTarget||event.rawEvent.shiftKey||"Tab"!==event.rawEvent.key?keyDownHandler(event.rawEvent):(event.rawEvent.preventDefault(),event.rawEvent.stopPropagation(),setFocusedWithoutMouse(!0),function focusFirstNode(e){var data=graphController.getData();if(data.nodes.size>0&&svgRef.current){var firstNode=data.head&&data.nodes.get(data.head);firstNode&&a11yUtils_focusItem(svgRef,{node:firstNode,port:void 0},e,eventChannel)}}(event.rawEvent)),dispatch(event);break;case GraphCanvasEvent.MouseDown:graphController.nodeClickOnce=null,null===(_a=svgRef.current)||void 0===_a||_a.focus({preventScroll:!0}),setFocusedWithoutMouse(!1);var evt=event.rawEvent;updateViewport(),container_onContainerMouseDown(evt,{state:graphController.state,canvasMouseMode:canvasMouseMode,isPanDisabled:isPanDisabled,isMultiSelectDisabled:isMultiSelectDisabled,isLassoSelectEnable:isLassoSelectEnable,dragThreshold:dragThreshold,containerRef:containerRef,getPositionFromEvent:defaultGetPositionFromEvent,eventChannel:eventChannel,graphController:graphController});break;case GraphCanvasEvent.MouseUp:if(graphController.canvasClickOnce)graphController.canvasClickOnce=!1,(evt=event.rawEvent).target instanceof Node&&(null===(_b=svgRef.current)||void 0===_b?void 0:_b.contains(evt.target))&&"svg"===evt.target.nodeName&&eventChannel.trigger({type:GraphCanvasEvent.Click,rawEvent:event.rawEvent});break;case GraphCanvasEvent.ContextMenu:event.rawEvent.preventDefault(),event.rawEvent.stopPropagation(),dispatch(event);break;case GraphCanvasEvent.MouseMove:evt=event.rawEvent;graphController.setMouseClientPosition({x:evt.clientX,y:evt.clientY});break;case GraphCanvasEvent.MouseLeave:graphController.unsetMouseClientPosition(),graphController.canvasClickOnce=!1;break;case GraphCanvasEvent.Blur:setFocusedWithoutMouse(!1)}},handleNodeEvent=function handleNodeEvent(event){var _a;switch(event.type){case GraphNodeEvent.ResizingStart:case GraphNodeEvent.Resizing:case GraphNodeEvent.ResizingEnd:case GraphNodeEvent.DragStart:case GraphNodeEvent.Drag:case GraphNodeEvent.DragEnd:case GraphNodeEvent.SelectAll:dispatch(event);break;case GraphNodeEvent.PointerMove:event.rawEvent.pointerId===graphController.pointerId&&animationFramedDispatch(event);break;case GraphNodeEvent.PointerDown:if(graphController.nodeClickOnce=null,graphController.getBehavior()!==GraphBehavior.default)return;var evt=event.rawEvent;updateViewport(),function onNodePointerDown(evt,target,params){evt.preventDefault();var svgRef=params.svgRef,isNodesDraggable=params.isNodesDraggable,getPositionFromEvent=params.getPositionFromEvent,isClickNodeToSelectDisabled=params.isClickNodeToSelectDisabled,eventChannel=params.eventChannel,dragThreshold=params.dragThreshold,rectRef=params.rectRef,isAutoAlignEnable=params.isAutoAlignEnable,autoAlignThreshold=params.autoAlignThreshold,graphController=params.graphController;isNodesDraggable&&evt.stopPropagation();var isMouseRight="mouse"===evt.pointerType&&evt.button!==MouseEventButton.Primary;if(!isClickNodeToSelectDisabled&&!isMouseRight){svgRef.current&&svgRef.current.focus({preventScroll:!0});var isMultiSelect=checkIsMultiSelect(evt),dragging=new DragNodeController_DragNodeController(new PointerEventProvider_PointerEventProvider(graphController.getGlobalEventTarget(),evt.pointerId),getPositionFromEvent,rectRef);dragging.onMove=function(_a){var dx=_a.dx,dy=_a.dy,totalDX=_a.totalDX,totalDY=_a.totalDY,e=_a.e;isNodesDraggable&&eventChannel.trigger({type:GraphNodeEvent.Drag,node:target,dx:dx,dy:dy,rawEvent:e,isVisible:!isWithinThreshold(totalDX,totalDY,dragThreshold),isAutoAlignEnable:isAutoAlignEnable,autoAlignThreshold:autoAlignThreshold})},dragging.onEnd=function(_a){var totalDX=_a.totalDX,totalDY=_a.totalDY,e=_a.e;graphController.pointerId=null;var events=[],isDragCanceled=isWithinThreshold(totalDX,totalDY,dragThreshold);events.push({type:GraphNodeEvent.DragEnd,node:target,rawEvent:e,isDragCanceled:isDragCanceled}),!isDragCanceled&&isNodesDraggable||(graphController.nodeClickOnce=target),eventChannel.batch(events)},graphController.pointerId=evt.pointerId,evt.target instanceof Element&&"mouse"!==evt.pointerType&&evt.target.releasePointerCapture(evt.pointerId),eventChannel.trigger({type:GraphNodeEvent.DragStart,node:target,rawEvent:evt,isMultiSelect:isMultiSelect}),dragging.start(evt.nativeEvent)}}(evt,event.node,{svgRef:svgRef,rectRef:rectRef,isNodesDraggable:isNodesDraggable,isAutoAlignEnable:isAutoAlignEnable,dragThreshold:dragThreshold,getPositionFromEvent:getPositionFromEvent,isClickNodeToSelectDisabled:isClickNodeToSelectDisabled,autoAlignThreshold:autoAlignThreshold,eventChannel:eventChannel,graphController:graphController});break;case GraphNodeEvent.PointerEnter:!function onNodePointerEnter(event){var node=event.node,isNodeHoverViewEnabled=featureControl.isNodeHoverViewEnabled;switch(graphController.getBehavior()){case GraphBehavior.connecting:case GraphBehavior.default:isNodeHoverViewEnabled&&(setCurHoverNode(node.id),setCurHoverPort(void 0))}dispatch(event)}(event);break;case GraphNodeEvent.PointerLeave:!function onNodePointerLeave(event){dispatch(event),setCurHoverNode(void 0)}(event);break;case GraphNodeEvent.MouseDown:graphController.nodeClickOnce=null,event.rawEvent.preventDefault(),isNodesDraggable&&event.rawEvent.stopPropagation(),setFocusedWithoutMouse(!1);break;case GraphNodeEvent.Click:if((null===(_a=graphController.nodeClickOnce)||void 0===_a?void 0:_a.id)===event.node.id){var currentTarget=event.rawEvent.currentTarget;currentTarget instanceof SVGElement&&currentTarget.focus({preventScroll:!0}),event.node=graphController.nodeClickOnce,dispatch(event),graphController.nodeClickOnce=null}else event.intercepted=!0;break;case GraphNodeEvent.ContextMenu:event.rawEvent.preventDefault(),event.rawEvent.stopPropagation(),dispatch(event);break;case GraphNodeEvent.DoubleClick:!function onNodeDoubleClick(event){isNodeEditDisabled||(event.rawEvent.stopPropagation(),dispatch(event))}(event);break;case GraphNodeEvent.KeyDown:!function onNodeKeyDown(event){if(svgRef&&isA11yEnable){var data=graphController.getData(),node=event.node,evt=event.rawEvent;switch(evt.key){case"Tab":evt.preventDefault(),evt.stopPropagation();var nextItem=evt.shiftKey?getPrevItem(data,node):getNextItem(data,node);a11yUtils_focusItem(svgRef,nextItem,evt,eventChannel);break;case"ArrowUp":evt.preventDefault(),evt.stopPropagation(),focusUpNode(data,node.id,svgRef,graphController,evt,eventChannel);break;case"ArrowDown":evt.preventDefault(),evt.stopPropagation(),focusDownNode(data,node.id,svgRef,graphController,evt,eventChannel);break;case"ArrowLeft":evt.preventDefault(),evt.stopPropagation(),focusLeftNode(data,node.id,svgRef,graphController,evt,eventChannel);break;case"ArrowRight":evt.preventDefault(),evt.stopPropagation(),focusRightNode(data,node.id,svgRef,graphController,evt,eventChannel)}}}(event)}},onPortPointerDown=react.useCallback((function(event){var evt=event.rawEvent,node=event.node,port=event.port;if(setFocusedWithoutMouse(!1),evt.stopPropagation(),evt.preventDefault(),prevMouseDownPortId=node.id+":"+port.id,prevMouseDownPortTime=performance.now(),!(isConnectDisabled||"mouse"===evt.pointerType&&evt.button!==MouseEventButton.Primary)){updateViewport();var globalEventTarget=graphController.getGlobalEventTarget(),dragging=new DragController_DragController(new PointerEventProvider_PointerEventProvider(globalEventTarget,evt.pointerId),getPositionFromEvent);dragging.onMove=function(_a){var clientX=_a.clientX,clientY=_a.clientY,e=_a.e;eventChannel.trigger({type:GraphEdgeEvent.ConnectMove,rawEvent:e,clientX:clientX,clientY:clientY})},dragging.onEnd=function(_a){var e=_a.e;eventChannel.trigger({type:GraphEdgeEvent.ConnectEnd,rawEvent:e,edgeWillAdd:edgeWillAdd,isCancel:!1}),graphController.pointerId=null},eventChannel.trigger({type:GraphEdgeEvent.ConnectStart,nodeId:node.id,portId:port.id,rawEvent:evt,clientPoint:{x:evt.clientX,y:evt.clientY}}),evt.target instanceof Element&&"mouse"!==evt.pointerType&&evt.target.releasePointerCapture(evt.pointerId),graphController.pointerId=evt.pointerId,dragging.start(evt.nativeEvent)}}),[edgeWillAdd,eventChannel,getPositionFromEvent,graphController,isConnectDisabled,setFocusedWithoutMouse,updateViewport]),onPortPointerUp=react.useCallback((function(event){var evt=event.rawEvent,node=event.node,port=event.port;prevMouseDownPortId===node.id+":"+port.id&&performance.now()-(prevMouseDownPortTime||0)<500&&(prevMouseDownPortId=void 0,prevMouseDownPortTime=void 0,eventChannel.trigger({type:GraphPortEvent.Click,node:node,port:port,rawEvent:evt}))}),[eventChannel]),onPortKeyDown=function onPortKeyDown(event){var _a,_b,_c;if(isA11yEnable){var evt=event.rawEvent;if(evt.altKey&&("KeyC"===evt.nativeEvent.code||"c"===evt.key))return evt.preventDefault(),evt.stopPropagation(),void eventChannel.trigger({type:GraphEdgeEvent.ConnectStart,nodeId:event.node.id,portId:event.port.id,rawEvent:evt});var data=graphController.getData(),node=event.node,port=event.port;switch(evt.key){case"Tab":if(isA11yEnable&&graphController.getBehavior()===GraphBehavior.connecting)evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphEdgeEvent.ConnectNavigate,rawEvent:evt});else{var nextItem=evt.shiftKey?getPrevItem(data,node,port):getNextItem(data,node,port);a11yUtils_focusItem(svgRef,nextItem,evt,eventChannel)}break;case"ArrowUp":case"ArrowLeft":evt.preventDefault(),evt.stopPropagation(),function focusPrevPort(ports,node,curPortId,svgRef,evt,eventChannel){var curPortIndex=ports.findIndex((function(p){return p.id===curPortId})),prevPort=ports[(curPortIndex-1+ports.length)%ports.length];prevPort&&svgRef.current&&a11yUtils_focusItem(svgRef,{node:node,port:prevPort},evt,eventChannel)}(null!==(_a=node.ports)&&void 0!==_a?_a:[],node,port.id,svgRef,evt,eventChannel);break;case"ArrowDown":case"ArrowRight":evt.preventDefault(),evt.stopPropagation(),function focusNextPort(ports,node,curPortId,svgRef,evt,eventChannel){var curPortIndex=ports.findIndex((function(p){return p.id===curPortId})),nextPort=ports[(curPortIndex+1)%ports.length];nextPort&&svgRef.current&&a11yUtils_focusItem(svgRef,{node:node,port:nextPort},evt,eventChannel)}(null!==(_b=node.ports)&&void 0!==_b?_b:[],node,port.id,svgRef,evt,eventChannel);break;case"g":evt.preventDefault(),evt.stopPropagation(),function goToConnectedPort(data,node,port,svgRef,evt,eventChannel){var _a,neighborPorts=function getNeighborPorts(data,nodeId,portId){var neighbors=[],edgesBySource=data.getEdgesBySource(nodeId,portId),edgesByTarget=data.getEdgesByTarget(nodeId,portId);return null==edgesBySource||edgesBySource.forEach((function(edgeId){var edge=data.edges.get(edgeId);edge&&neighbors.push({nodeId:edge.target,portId:edge.targetPortId})})),null==edgesByTarget||edgesByTarget.forEach((function(edgeId){var edge=data.edges.get(edgeId);edge&&neighbors.push({nodeId:edge.source,portId:edge.sourcePortId})})),neighbors}(data,node.id,port.id);if(1===neighborPorts.length&&svgRef.current){var targetNode=data.nodes.get(neighborPorts[0].nodeId);if(!targetNode)return;var targetPort=null===(_a=targetNode.ports)||void 0===_a?void 0:_a.find((function(p){return p.id===neighborPorts[0].portId}));if(!targetPort)return;a11yUtils_focusItem(svgRef,{node:targetNode,port:targetPort},evt,eventChannel)}else if(neighborPorts.length>1&&svgRef.current){var visitPortHelperContainer_1=document.createElement("div"),editorContainer=svgRef.current.closest(".react-dag-editor-container");editorContainer&&editorContainer.appendChild(visitPortHelperContainer_1),visitPortHelperContainer_1.style.position="fixed",visitPortHelperContainer_1.style.top="0",react_dom.render(react.createElement(VisitPortHelper_VisitPortHelper,{neighborPorts:neighborPorts,onComplete:function onComplete(nextPort){var _a;if(react_dom.unmountComponentAtNode(visitPortHelperContainer_1),svgRef.current){var curEditorContainer=svgRef.current.closest(".react-dag-editor-container");curEditorContainer&&curEditorContainer.removeChild(visitPortHelperContainer_1)}var targetNode=data.nodes.get(nextPort.nodeId);if(targetNode){var targetPort=null===(_a=targetNode.ports)||void 0===_a?void 0:_a.find((function(p){return p.id===nextPort.portId}));targetPort&&a11yUtils_focusItem(svgRef,{node:targetNode,port:targetPort},evt,eventChannel)}},data:data}),visitPortHelperContainer_1)}}(data,node,port,svgRef,evt,eventChannel);break;case"Escape":graphController.getBehavior()===GraphBehavior.connecting&&(evt.preventDefault(),evt.stopPropagation(),svgRef.current&&(null===(_c=a11yUtils_findDOMElement(svgRef.current,{node:node,port:port}))||void 0===_c||_c.blur()));break;case"Enter":evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphEdgeEvent.ConnectEnd,rawEvent:evt.nativeEvent,edgeWillAdd:edgeWillAdd,isCancel:!1})}}},handlePortEvent=function handlePortEvent(event){switch(event.type){case GraphPortEvent.Click:dispatch(event);break;case GraphPortEvent.PointerDown:onPortPointerDown(event);break;case GraphPortEvent.PointerUp:onPortPointerUp(event);break;case GraphPortEvent.PointerEnter:!function onPortPointerEnter(event){switch(graphController.getBehavior()){case GraphBehavior.default:setCurHoverPort([event.node.id,event.port.id])}isPortHoverViewEnable&&setCurHoverPort([event.node.id,event.port.id]),event.rawEvent.pointerId===graphController.pointerId&&dispatch(event)}(event);break;case GraphPortEvent.PointerLeave:!function onPortPointerLeave(event){setCurHoverPort(void 0),dispatch(event)}(event);break;case GraphPortEvent.ContextMenu:event.rawEvent.preventDefault(),event.rawEvent.stopPropagation(),dispatch(event);break;case GraphPortEvent.Focus:event.rawEvent.stopPropagation(),dispatch(event);break;case GraphPortEvent.Blur:graphController.getBehavior()===GraphBehavior.connecting&&eventChannel.trigger({type:GraphEdgeEvent.ConnectEnd,rawEvent:event.rawEvent.nativeEvent,edgeWillAdd:edgeWillAdd,isCancel:!0});break;case GraphPortEvent.KeyDown:onPortKeyDown(event)}},handleEvent=function handleEvent(event){var behavior=behaviorReducer_handleBehaviorChange(graphController.getBehavior(),event);switch(graphController.setBehavior(behavior),function handleEdgeEvent(event){switch(event.type){case GraphEdgeEvent.ConnectStart:case GraphEdgeEvent.ConnectMove:case GraphEdgeEvent.ConnectEnd:case GraphEdgeEvent.ConnectNavigate:case GraphEdgeEvent.Click:case GraphEdgeEvent.MouseEnter:case GraphEdgeEvent.MouseLeave:case GraphEdgeEvent.DoubleClick:dispatch(event);break;case GraphEdgeEvent.ContextMenu:event.rawEvent.stopPropagation(),event.rawEvent.preventDefault(),dispatch(event)}}(event),handleCanvasEvent(event),handleNodeEvent(event),handlePortEvent(event),event.type){case GraphMinimapEvent.Pan:case GraphScrollBarEvent.Scroll:case GraphContextMenuEvent.Open:case GraphContextMenuEvent.Close:dispatch(event)}};react.useImperativeHandle(eventChannel.listenersRef,(function(){return handleEvent})),react.useImperativeHandle(eventChannel.externalHandlerRef,(function(){return props.onEvent}))}var Line_Line=function Line(props){var _a,line=props.line,style=props.style,lineStyle=Object(tslib_es6.a)(Object(tslib_es6.a)({strokeWidth:1},style),{stroke:line.visible?null!==(_a=null==style?void 0:style.stroke)&&void 0!==_a?_a:"#ea4300":"none"});return react.createElement("line",{className:"auto-align-hint",x1:line.x1,y1:line.y1,x2:line.x2,y2:line.y2,style:lineStyle})};try{Line_Line.displayName="Line",Line_Line.__docgenInfo={description:"",displayName:"Line",props:{line:{defaultValue:null,description:"",name:"line",required:!0,type:{name:"ILine"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Line.tsx#Line"]={docgenInfo:Line_Line.__docgenInfo,name:"Line",path:"src/components/Line.tsx#Line"})}catch(__react_docgen_typescript_loader_error){}var AlignmentLines=react.memo((function(_a){var style=_a.style,alignmentLines=useAlignmentLines();return react.createElement(react.Fragment,null,alignmentLines.map((function(l,index){return l.visible?react.createElement(Line_Line,{key:index,line:l,style:style}):null})))}));AlignmentLines.displayName="AlignmentLines";var AnimatingNodeGroup_AnimatingNodeGroup=function AnimatingNodeGroup(props){var _a,_b,dummyNodes=props.dummyNodes,graphData=props.graphData,graphConfig=useGraphConfig(),theme=useTheme_useTheme().theme,dWidth=dummyNodes.dWidth,dHeight=dummyNodes.dHeight,dx=null!==(_a=dummyNodes.alignedDX)&&void 0!==_a?_a:dummyNodes.dx,dy=null!==(_b=dummyNodes.alignedDY)&&void 0!==_b?_b:dummyNodes.dy;return react.createElement("g",null,dummyNodes.nodes.map((function(dummyNode){var node=graphData.nodes.get(dummyNode.id);if(!node)return null;var x=dummyNode.x+dx,y=dummyNode.y+dy,width=dummyNode.width+dWidth,height=dummyNode.height+dHeight,nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig);return(null==nodeConfig?void 0:nodeConfig.renderDummy)?nodeConfig.renderDummy(Object(tslib_es6.a)(Object(tslib_es6.a)({},node.inner),{x:x,y:y,width:width,height:height}),theme):react.createElement("rect",{key:node.id,transform:"translate("+x+","+y+")",height:height,width:width,stroke:theme.dummyNodeStroke,strokeDasharray:"4",fill:"none"})})))};try{AnimatingNodeGroup_AnimatingNodeGroup.displayName="AnimatingNodeGroup",AnimatingNodeGroup_AnimatingNodeGroup.__docgenInfo={description:"",displayName:"AnimatingNodeGroup",props:{dummyNodes:{defaultValue:null,description:"",name:"dummyNodes",required:!0,type:{name:"IDummyNodes"}},graphData:{defaultValue:null,description:"",name:"graphData",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/AnimatingNodeGroup.tsx#AnimatingNodeGroup"]={docgenInfo:AnimatingNodeGroup_AnimatingNodeGroup.__docgenInfo,name:"AnimatingNodeGroup",path:"src/components/AnimatingNodeGroup.tsx#AnimatingNodeGroup"})}catch(__react_docgen_typescript_loader_error){}var ConnectingLine_ConnectingLine=function ConnectingLine(props){var autoAttachLine=props.autoAttachLine,connectingLine=props.connectingLine,styles=props.styles,theme=useTheme_useTheme().theme,strokeColor=(null==styles?void 0:styles.stroke)||theme.primaryColor,fill=(null==styles?void 0:styles.fill)||"none",strokeDasharray=(null==styles?void 0:styles.strokeDasharray)||"4,4",connectingLineStroke=connectingLine.visible?strokeColor:"none";return react.createElement("g",null,react.createElement("defs",null,react.createElement("marker",{id:"markerArrow",markerWidth:"10",markerHeight:"10",refX:"6",refY:"5",orient:"auto",markerUnits:"strokeWidth"},react.createElement("path",{d:"M0,0 L6,5 L0,10",style:{stroke:connectingLineStroke,fill:"none"}}))),react.createElement("line",{x1:connectingLine.x1,y1:connectingLine.y1,x2:connectingLine.x2,y2:connectingLine.y2,style:{stroke:connectingLineStroke,fill:fill,strokeDasharray:strokeDasharray},markerEnd:"url(#markerArrow)"}),react.createElement("path",{d:getCurvePathD(autoAttachLine.x2,autoAttachLine.x1,autoAttachLine.y2,autoAttachLine.y1),style:{stroke:autoAttachLine.visible?strokeColor:"none",fill:"none"}}))};try{ConnectingLine_ConnectingLine.displayName="ConnectingLine",ConnectingLine_ConnectingLine.__docgenInfo={description:"",displayName:"ConnectingLine",props:{connectingLine:{defaultValue:null,description:"",name:"connectingLine",required:!0,type:{name:"ILine"}},autoAttachLine:{defaultValue:null,description:"",name:"autoAttachLine",required:!0,type:{name:"ILine"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Connecting/ConnectingLine.tsx#ConnectingLine"]={docgenInfo:ConnectingLine_ConnectingLine.__docgenInfo,name:"ConnectingLine",path:"src/components/Connecting/ConnectingLine.tsx#ConnectingLine"})}catch(__react_docgen_typescript_loader_error){}var Connecting=react.memo((function(props){var styles=props.styles,graphConfig=props.graphConfig,viewport=props.viewport,movingPoint=props.movingPoint,_a=function useConnectingState(){return Object(react.useContext)(ConnectingStateContext)}(),sourcePort=_a.sourcePort,sourceNode=_a.sourceNode,targetPort=_a.targetPort,targetNode=_a.targetNode;if(!sourceNode||!sourcePort)return null;var targetPortPosition,sourcePortPosition=sourceNode.getPortPosition(sourcePort.id,graphConfig),isAttach=!1;if(targetNode&&targetPort?(isAttach=!0,targetPortPosition=null==targetNode?void 0:targetNode.getPortPosition(targetPort.id,graphConfig)):targetPortPosition=sourcePortPosition,!sourcePortPosition||!targetPortPosition)return null;var sourcePoint=transformPoint(sourcePortPosition.x,sourcePortPosition.y,viewport.transformMatrix),targetPoint=transformPoint(targetPortPosition.x,targetPortPosition.y,viewport.transformMatrix),connectingLine=movingPoint?{x1:sourcePoint.x,y1:sourcePoint.y,x2:movingPoint.x,y2:movingPoint.y,visible:!isAttach}:{x1:0,y1:0,x2:0,y2:0,visible:!1},autoAttachLine={x1:sourcePoint.x,y1:sourcePoint.y,x2:targetPoint.x,y2:targetPoint.y,visible:isAttach};return react.createElement(ConnectingLine_ConnectingLine,{connectingLine:connectingLine,autoAttachLine:autoAttachLine,styles:styles})}));Connecting.displayName="Connecting";try{Connecting.displayName="Connecting",Connecting.__docgenInfo={description:"",displayName:"Connecting",props:{graphConfig:{defaultValue:null,description:"",name:"graphConfig",required:!0,type:{name:"IGraphConfig<unknown, unknown, unknown>"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"CSSProperties"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"IViewport"}},movingPoint:{defaultValue:null,description:"",name:"movingPoint",required:!0,type:{name:"IPoint | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Connecting/Connecting.tsx#Connecting"]={docgenInfo:Connecting.__docgenInfo,name:"Connecting",path:"src/components/Connecting/Connecting.tsx#Connecting"})}catch(__react_docgen_typescript_loader_error){}var defaultStyle={position:"fixed",userSelect:"none"},GraphContextMenu_GraphContextMenu=function GraphContextMenu(_a){var _b,_c,state=_a.state,onClick=_a.onClick,ref=react.useRef(null),_d=react.useState(Object(tslib_es6.a)({},defaultStyle)),style=_d[0],setStyle=_d[1];react.useLayoutEffect((function(){var el=ref.current;if(el&&state.contextMenuPosition){var _a=state.contextMenuPosition,x=_a.x,y=_a.y,_b=document.documentElement,clientWidth=_b.clientWidth,clientHeight=_b.clientHeight,_c=el.getBoundingClientRect(),width=_c.width,height=_c.height,nextStyle=Object(tslib_es6.a)({},defaultStyle);x+width>=clientWidth?nextStyle.right=0:nextStyle.left=x,y+height>clientHeight?nextStyle.bottom=0:nextStyle.top=y,setStyle(nextStyle)}}),[null===(_b=state.contextMenuPosition)||void 0===_b?void 0:_b.x,null===(_c=state.contextMenuPosition)||void 0===_c?void 0:_c.y]);var contextMenuConfig=useContextMenuConfigContext_useContextMenuConfigContext(),_e=react.useState(react.createElement(react.Fragment,null)),content=_e[0],setContent=_e[1];react.useEffect((function(){var menu,data=state.data.present,selectedNodesCount=0,selectedPortsCount=0,selectedEdgesCount=0;data.nodes.forEach((function(node){var _a;state_isSelected(node)&&(selectedNodesCount+=1),null===(_a=node.ports)||void 0===_a||_a.forEach((function(port){state_isSelected(port)&&(selectedPortsCount+=1)}))})),data.edges.forEach((function(edge){state_isSelected(edge)&&(selectedEdgesCount+=1)})),menu=selectedPortsCount+selectedNodesCount+selectedEdgesCount>1?contextMenuConfig.getMenu(MenuType.Multi):selectedPortsCount+selectedNodesCount+selectedEdgesCount===0?contextMenuConfig.getMenu(MenuType.Canvas):1===selectedNodesCount?contextMenuConfig.getMenu(MenuType.Node):1===selectedPortsCount?contextMenuConfig.getMenu(MenuType.Port):contextMenuConfig.getMenu(MenuType.Edge),setContent(menu)}),[state.data.present,contextMenuConfig]);var handleContextMenu=react.useCallback((function(evt){evt.stopPropagation(),evt.preventDefault()}),[]);return react.createElement(react.Fragment,null,state.contextMenuPosition&&react.createElement("div",{ref:ref,onClick:onClick,onContextMenu:handleContextMenu,role:"button",style:style},content))};try{GraphContextMenu_GraphContextMenu.displayName="GraphContextMenu",GraphContextMenu_GraphContextMenu.__docgenInfo={description:"",displayName:"GraphContextMenu",props:{state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"IGraphState<unknown, unknown, unknown>"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(evt: MouseEvent<HTMLDivElement, MouseEvent>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GraphContextMenu.tsx#GraphContextMenu"]={docgenInfo:GraphContextMenu_GraphContextMenu.__docgenInfo,name:"GraphContextMenu",path:"src/components/GraphContextMenu.tsx#GraphContextMenu"})}catch(__react_docgen_typescript_loader_error){}var Group_Group=function Group(props){var _a,data=props.data,group=props.group,graphConfig=useGraphConfig(),_b=react.useMemo((function(){return getGroupRect(group,data.nodes,graphConfig)}),[group,data.nodes,graphConfig]),x=_b.x,y=_b.y,width=_b.width,height=_b.height,groupConfig=null!==(_a=graphConfig.getGroupConfigByName(group.shape))&&void 0!==_a?_a:defaultGroup,automationId="group-container-"+group.id;return react.createElement("g",{"data-automation-id":automationId,key:group.id,transform:"translate("+x+", "+y+")"},groupConfig.render({group:group,height:height,width:width}))};try{Group_Group.displayName="Group",Group_Group.__docgenInfo={description:"",displayName:"Group",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"ICanvasGroup"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Group/Group.tsx#Group"]={docgenInfo:Group_Group.__docgenInfo,name:"Group",path:"src/components/Group/Group.tsx#Group"})}catch(__react_docgen_typescript_loader_error){}var GraphGroupsRenderer_GraphGroupsRenderer=function GraphGroupsRenderer(props){return react.createElement("g",null,react.useMemo((function(){return props.groups.map((function(group){return react.createElement(Group_Group,{key:group.id,group:group,data:props.data})}))}),[props.groups,props.data]))};try{GraphGroupsRenderer_GraphGroupsRenderer.displayName="GraphGroupsRenderer",GraphGroupsRenderer_GraphGroupsRenderer.__docgenInfo={description:"",displayName:"GraphGroupsRenderer",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},groups:{defaultValue:null,description:"",name:"groups",required:!0,type:{name:"ICanvasGroup[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Group/GraphGroupsRenderer.tsx#GraphGroupsRenderer"]={docgenInfo:GraphGroupsRenderer_GraphGroupsRenderer.__docgenInfo,name:"GraphGroupsRenderer",path:"src/components/Group/GraphGroupsRenderer.tsx#GraphGroupsRenderer"})}catch(__react_docgen_typescript_loader_error){}var NodeTooltips_NodeTooltips=function NodeTooltips(props){var node=props.node,viewport=props.viewport,graphConfig=useGraphConfig(),theme=useTheme_useTheme().theme;if(!node)return null;if(!hasState(GraphNodeState.activated)(node.state))return null;var nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig);return(null==nodeConfig?void 0:nodeConfig.renderTooltips)?react.createElement("div",{className:"node-tooltips"},nodeConfig.renderTooltips({model:node,theme:theme,viewport:viewport})):null};try{NodeTooltips_NodeTooltips.displayName="NodeTooltips",NodeTooltips_NodeTooltips.__docgenInfo={description:"",displayName:"NodeTooltips",props:{node:{defaultValue:null,description:"",name:"node",required:!1,type:{name:"NodeModel<unknown, unknown>"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/NodeTooltips.tsx#NodeTooltips"]={docgenInfo:NodeTooltips_NodeTooltips.__docgenInfo,name:"NodeTooltips",path:"src/components/NodeTooltips.tsx#NodeTooltips"})}catch(__react_docgen_typescript_loader_error){}var PortTooltips_PortTooltips=function PortTooltips(props){var graphConfig=useGraphConfig(),theme=useTheme_useTheme().theme,parentNode=props.parentNode,port=props.port,viewport=props.viewport;if(!hasState(GraphPortState.activated)(port.state))return null;var portShape=port.shape?port.shape:graphConfig.defaultPortShape,portConfig=graphConfig.getPortConfigByName(portShape);if(!portConfig||!portConfig.renderTooltips)return null;var pos=parentNode.getPortPosition(port.id,graphConfig);return pos?react.createElement("div",{className:"port-tooltips"},react.createElement(ConnectingStateContext.Consumer,null,(function(_a){var sourceNode=_a.sourceNode,sourcePort=_a.sourcePort;return portConfig.renderTooltips&&portConfig.renderTooltips(Object(tslib_es6.a)({model:port,parentNode:parentNode,data:props.data,theme:theme,anotherNode:sourceNode,anotherPort:sourcePort,viewport:viewport},pos))}))):null};try{PortTooltips_PortTooltips.displayName="PortTooltips",PortTooltips_PortTooltips.__docgenInfo={description:"",displayName:"PortTooltips",props:{port:{defaultValue:null,description:"",name:"port",required:!0,type:{name:"ICanvasPort<unknown>"}},parentNode:{defaultValue:null,description:"",name:"parentNode",required:!0,type:{name:"NodeModel<unknown, unknown>"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/PortTooltips.tsx#PortTooltips"]={docgenInfo:PortTooltips_PortTooltips.__docgenInfo,name:"PortTooltips",path:"src/components/PortTooltips.tsx#PortTooltips"})}catch(__react_docgen_typescript_loader_error){}var react_jss_esm=__webpack_require__(454);function useRefValue(value){var ref=Object(react.useRef)(value);return Object(react.useLayoutEffect)((function(){ref.current=value}),[value]),ref}var wrapperCommonStyle={position:"absolute",cursor:"initial"},useStyles=Object(react_jss_esm.a)({verticalScrollWrapper:Object(tslib_es6.a)(Object(tslib_es6.a)({},wrapperCommonStyle),{height:"100%",width:10,top:0,right:0}),horizontalScrollWrapper:Object(tslib_es6.a)(Object(tslib_es6.a)({},wrapperCommonStyle),{height:10,width:"100%",bottom:0,left:0}),verticalScrollStyle:function verticalScrollStyle(args){return{height:args.scrollbarLayout.verticalScrollHeight,width:"100%",backgroundColor:args.theme.scrollbarColor,position:"absolute",top:0,right:0,transform:"translateY("+args.scrollbarLayout.verticalScrollTop+"px)"}},horizontalScrollStyle:function horizontalScrollStyle(args){return{width:args.scrollbarLayout.horizontalScrollWidth-10,height:"100%",backgroundColor:args.theme.scrollbarColor,position:"absolute",left:0,bottom:0,transform:"translateX("+args.scrollbarLayout.horizontalScrollLeft+"px)"}}}),Scrollbar_Scrollbar=function Scrollbar(props){var _a=props.vertical,vertical=void 0===_a||_a,_b=props.horizontal,horizontal=void 0===_b||_b,offsetLimit=props.offsetLimit,eventChannel=props.eventChannel,viewport=props.viewport,graphController=useGraphController(),theme=useTheme_useTheme().theme,scrollbarLayout=function getScrollbarLayout(viewport,offsetLimit){var rect=viewport.rect,transformMatrix=viewport.transformMatrix,totalContentHeight=function getTotalContentHeight(containerHeight,offsetLimit){var minY=offsetLimit.minY,maxY=offsetLimit.maxY;return containerHeight+maxY-minY}(rect.height,offsetLimit),totalContentWidth=function getTotalContentWidth(containerWidth,offsetLimit){var minX=offsetLimit.minX,maxX=offsetLimit.maxX;return containerWidth+maxX-minX}(rect.width,offsetLimit);return{totalContentHeight:totalContentHeight,totalContentWidth:totalContentWidth,verticalScrollHeight:rect.height*rect.height/totalContentHeight,horizontalScrollWidth:rect.width*rect.width/totalContentWidth,verticalScrollTop:(offsetLimit.maxY-transformMatrix[5])*rect.height/totalContentHeight,horizontalScrollLeft:(offsetLimit.maxX-transformMatrix[4])*rect.width/totalContentWidth}}(viewport,offsetLimit),classes=useStyles({scrollbarLayout:scrollbarLayout,theme:theme}),scrollbarLayoutRef=useRefValue(scrollbarLayout);return react.createElement(react.Fragment,null,vertical&&react.createElement("div",{className:classes.verticalScrollWrapper},react.createElement("div",{className:classes.verticalScrollStyle,onMouseDown:function onVerticalScrollMouseDown(e){e.preventDefault(),e.stopPropagation();var containerHeight=viewport.rect.height,dragging=new DragController_DragController(new MouseMoveEventProvider(graphController.getGlobalEventTarget()),defaultGetPositionFromEvent);dragging.onMove=function(_a){var scrollbarDy=_a.dy,rawEvent=_a.e,dy=-scrollbarDy*scrollbarLayoutRef.current.totalContentHeight/containerHeight;eventChannel.trigger({type:GraphScrollBarEvent.Scroll,rawEvent:rawEvent,dx:0,dy:dy})},dragging.onEnd=function(){eventChannel.trigger({type:GraphScrollBarEvent.ScrollEnd})},dragging.start(e.nativeEvent),eventChannel.trigger({type:GraphScrollBarEvent.ScrollStart})},role:"button","aria-label":"vertical scrollbar","aria-roledescription":"vertical scrollbar",id:"canvas-vertical-scrollbar"})),horizontal&&react.createElement("div",{className:classes.horizontalScrollWrapper},react.createElement("div",{className:classes.horizontalScrollStyle,onMouseDown:function onHorizontalScrollMouseDown(e){e.preventDefault(),e.stopPropagation();var containerWidth=viewport.rect.width,dragging=new DragController_DragController(new MouseMoveEventProvider(graphController.getGlobalEventTarget()),defaultGetPositionFromEvent);dragging.onMove=function(_a){var scrollbarDx=_a.dx,rawEvent=_a.e,dx=-scrollbarDx*scrollbarLayoutRef.current.totalContentWidth/containerWidth;eventChannel.trigger({type:GraphScrollBarEvent.Scroll,rawEvent:rawEvent,dx:dx,dy:0})},dragging.onEnd=function(){eventChannel.trigger({type:GraphScrollBarEvent.ScrollEnd})},dragging.start(e.nativeEvent),eventChannel.trigger({type:GraphScrollBarEvent.ScrollStart})},role:"button","aria-label":"horizontal scrollbar","aria-roledescription":"horizontal scrollbar",id:"canvas-horizontal-scrollbar"})))};try{Scrollbar_Scrollbar.displayName="Scrollbar",Scrollbar_Scrollbar.__docgenInfo={description:"",displayName:"Scrollbar",props:{viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}},horizontal:{defaultValue:null,description:"",name:"horizontal",required:!1,type:{name:"boolean"}},vertical:{defaultValue:null,description:"",name:"vertical",required:!1,type:{name:"boolean"}},offsetLimit:{defaultValue:null,description:"",name:"offsetLimit",required:!0,type:{name:"IOffsetLimit"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"IDispatch<unknown, unknown, unknown, never>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Scrollbar.tsx#Scrollbar"]={docgenInfo:Scrollbar_Scrollbar.__docgenInfo,name:"Scrollbar",path:"src/components/Scrollbar.tsx#Scrollbar"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__(48);var Transform_Transform=function Transform(_a){var matrix=_a.matrix,children=_a.children,transform=react.useMemo((function(){return"matrix("+matrix.join(" ")+")"}),matrix);return react.createElement("g",{transform:transform},children)};try{Transform_Transform.displayName="Transform",Transform_Transform.__docgenInfo={description:"",displayName:"Transform",props:{matrix:{defaultValue:null,description:"",name:"matrix",required:!0,type:{name:"ITransformMatrix"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Transform.tsx#Transform"]={docgenInfo:Transform_Transform.__docgenInfo,name:"Transform",path:"src/components/Transform.tsx#Transform"})}catch(__react_docgen_typescript_loader_error){}var GraphEdge=react.memo((function(props){var _a,edge=props.edge,graphModel=props.data,eventChannel=props.eventChannel,source=props.source,target=props.target,graphId=props.graphId,graphConfig=useGraphConfig(),virtualization=useVirtualization(),viewport=virtualization.viewport,renderedArea=virtualization.renderedArea,visibleArea=virtualization.visibleArea,theme=useTheme_useTheme().theme,edgeEvent=function edgeEvent(type){return function(e){e.persist(),eventChannel.trigger({type:type,edge:edge,rawEvent:e})}},isSourceRendered=isPointInRect(renderedArea,source),isTargetRendered=isPointInRect(renderedArea,target),isVisible=isSourceRendered&&isTargetRendered;if(react.useLayoutEffect((function(){isVisible&&virtualization.renderedEdges.add(edge.id)}),[virtualization]),!isVisible)return null;var shape=edge.shape?edge.shape:graphConfig.defaultEdgeShape,edgeConfig=graphConfig.getEdgeConfigByName(shape);if(!edgeConfig)return Debug.warn("invalid shape in edge "+JSON.stringify(edge)),null;if(!edgeConfig.render)return Debug.warn('Missing "render" method in edge config '+JSON.stringify(edge)),null;var isSourceVisible=isPointInRect(visibleArea,source),isTargetVisible=isPointInRect(visibleArea,target),edgeNode=edgeConfig.render({model:edge,data:graphModel,x1:source.x,y1:source.y,x2:target.x,y2:target.y,theme:theme,viewport:viewport});if(hasState(GraphEdgeState.connectedToSelected)(edge.state)&&(!isSourceVisible||!isTargetVisible)){var linearFunction=getLinearFunction(source.x,source.y,target.x,target.y),inverseLinearFunction=getLinearFunction(source.y,source.x,target.y,target.x),hintPoint=function getHintPoints(source,target,_a,yOnRightAxis,xOnBottomAxis,xOnTopAxis,yOnLeftAxis){var minX=_a.minX,minY=_a.minY,maxX=_a.maxX,maxY=_a.maxY;return source.x===target.x?{x:source.x,y:source.y<target.y?maxY:minY}:source.x<target.x?source.y<target.y?yOnRightAxis<=maxY?{x:maxX,y:yOnRightAxis}:{x:xOnBottomAxis,y:maxY}:yOnRightAxis>=minY?{x:maxX,y:yOnRightAxis}:{x:xOnTopAxis,y:minY}:source.y<target.y?xOnBottomAxis>minX?{x:xOnBottomAxis,y:maxY}:{x:minX,y:yOnLeftAxis}:yOnLeftAxis>minY?{x:minX,y:yOnLeftAxis}:{x:xOnTopAxis,y:minY}}(isSourceVisible?source:target,isSourceVisible?target:source,visibleArea,linearFunction(visibleArea.maxX),inverseLinearFunction(visibleArea.maxY),inverseLinearFunction(visibleArea.minY),linearFunction(visibleArea.minX));isSourceVisible&&edgeConfig.renderWithTargetHint?edgeNode=edgeConfig.renderWithTargetHint({model:edge,data:graphModel,x1:source.x,y1:source.y,x2:hintPoint.x,y2:hintPoint.y,theme:theme,viewport:viewport}):isTargetVisible&&edgeConfig.renderWithSourceHint&&(edgeNode=edgeConfig.renderWithSourceHint({model:edge,data:graphModel,x1:hintPoint.x,y1:hintPoint.y,x2:target.x,y2:target.y,theme:theme,viewport:viewport}))}var id=function getEdgeUid(graphId,edge){return"edge:"+graphId+":"+edge.id}(graphId,edge),className="edge-container-"+edge.id,automationId=null!==(_a=edge.automationId)&&void 0!==_a?_a:className;return react.createElement("g",{id:id,onClick:edgeEvent(GraphEdgeEvent.Click),onDoubleClick:edgeEvent(GraphEdgeEvent.DoubleClick),onMouseDown:edgeEvent(GraphEdgeEvent.MouseDown),onMouseUp:edgeEvent(GraphEdgeEvent.MouseUp),onMouseEnter:edgeEvent(GraphEdgeEvent.MouseEnter),onMouseLeave:edgeEvent(GraphEdgeEvent.MouseLeave),onContextMenu:edgeEvent(GraphEdgeEvent.ContextMenu),onMouseMove:edgeEvent(GraphEdgeEvent.MouseMove),onMouseOver:edgeEvent(GraphEdgeEvent.MouseOver),onMouseOut:edgeEvent(GraphEdgeEvent.MouseOut),onFocus:void 0,onBlur:void 0,className:className,"data-automation-id":automationId},edgeNode)}));try{GraphEdge.displayName="GraphEdge",GraphEdge.__docgenInfo={description:"",displayName:"GraphEdge",props:{edge:{defaultValue:null,description:"",name:"edge",required:!0,type:{name:"EdgeModel<unknown>"}},source:{defaultValue:null,description:"",name:"source",required:!0,type:{name:"IPoint"}},target:{defaultValue:null,description:"",name:"target",required:!0,type:{name:"IPoint"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},graphId:{defaultValue:null,description:"",name:"graphId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GraphEdge.tsx#GraphEdge"]={docgenInfo:GraphEdge.__docgenInfo,name:"GraphEdge",path:"src/components/GraphEdge.tsx#GraphEdge"})}catch(__react_docgen_typescript_loader_error){}function compareEqual(prev,props){return prev.node===props.node}var EdgeChampNodeRender=react.memo((function(props){for(var _a,_b,node=props.node,data=props.data,others=Object(tslib_es6.e)(props,["node","data"]),graphConfig=useGraphConfig(),values=[],valueCount=node.valueCount,i=0;i<valueCount;i+=1){var it=node.getValue(i),source=null===(_a=data.nodes.get(it.source))||void 0===_a?void 0:_a.getPortPosition(it.sourcePortId,graphConfig),target=null===(_b=data.nodes.get(it.target))||void 0===_b?void 0:_b.getPortPosition(it.targetPortId,graphConfig);source&&target&&values.push(react.createElement(GraphEdge,Object(tslib_es6.a)({},others,{key:it.id,data:data,edge:it,source:source,target:target})))}var children=[],nodeCount=node.nodeCount;for(i=0;i<nodeCount;i+=1){(it=node.getNode(i)).type===NodeType.Bitmap?children.push(react.createElement(EdgeChampNodeRender,Object(tslib_es6.a)({key:node.getHash(i)},props,{node:it}))):children.push(react.createElement(EdgeHashCollisionNodeRender,Object(tslib_es6.a)({key:it.getHash()},props,{node:it})))}return react.createElement(react.Fragment,null,values,children)}),compareEqual);EdgeChampNodeRender.displayName="EdgeChampNodeRender";var EdgeHashCollisionNodeRender=react.memo((function(props){var data=props.data,node=props.node,others=Object(tslib_es6.e)(props,["data","node"]),graphConfig=useGraphConfig();return react.createElement(react.Fragment,null,node.values.map((function(edge){var _a,_b,source=null===(_a=data.nodes.get(edge.source))||void 0===_a?void 0:_a.getPortPosition(edge.sourcePortId,graphConfig),target=null===(_b=data.nodes.get(edge.target))||void 0===_b?void 0:_b.getPortPosition(edge.targetPortId,graphConfig);return source&&target?react.createElement(GraphEdge,Object(tslib_es6.a)({},others,{key:edge.id,data:data,edge:edge,source:source,target:target})):null})))}),compareEqual);EdgeHashCollisionNodeRender.displayName="EdgeHashCollisionNodeRender";var EdgeTree_EdgeTree=function EdgeTree(props){var tree=props.tree,others=Object(tslib_es6.e)(props,["tree"]);return react.createElement(EdgeChampNodeRender,Object(tslib_es6.a)({},others,{node:tree.root}))};try{EdgeTree_EdgeTree.displayName="EdgeTree",EdgeTree_EdgeTree.__docgenInfo={description:"",displayName:"EdgeTree",props:{tree:{defaultValue:null,description:"",name:"tree",required:!0,type:{name:"HashMap<string, EdgeModel<unknown>>"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},graphId:{defaultValue:null,description:"",name:"graphId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/tree/EdgeTree.tsx#EdgeTree"]={docgenInfo:EdgeTree_EdgeTree.__docgenInfo,name:"EdgeTree",path:"src/components/tree/EdgeTree.tsx#EdgeTree"})}catch(__react_docgen_typescript_loader_error){}var injectStylesIntoStyleTag=__webpack_require__(451),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),Graph_styles_m=__webpack_require__(289),Graph_styles_m_options={insert:"head",singleton:!1},components_Graph_styles_m=(injectStylesIntoStyleTag_default()(Graph_styles_m.a,Graph_styles_m_options),Graph_styles_m.a.locals||{}),GraphNode_GraphNode=function GraphNode(props){var _a,node=props.node,eventChannel=props.eventChannel,getNodeAriaLabel=props.getNodeAriaLabel,viewport=props.viewport,graphId=props.graphId,graphConfig=useGraphConfig(),shape=node.shape?node.shape:graphConfig.defaultNodeShape,nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig),theme=useTheme_useTheme().theme,nodeEvent=function nodeEvent(type){return function(evt){evt.persist();var e={type:type,node:node,rawEvent:evt};eventChannel.trigger(e)}},id=getNodeUid(graphId,node),automationId=null!==(_a=node.automationId)&&void 0!==_a?_a:function getNodeAutomationId(node){var _a;return"node-container-"+(null!==(_a=node.name)&&void 0!==_a?_a:"unnamed")+"-"+node.id}(node);return(null==nodeConfig?void 0:nodeConfig.render)?react.createElement("g",{id:id,focusable:"true",tabIndex:0,className:components_Graph_styles_m.node,onPointerDown:nodeEvent(GraphNodeEvent.PointerDown),onPointerEnter:nodeEvent(GraphNodeEvent.PointerEnter),onPointerMove:nodeEvent(GraphNodeEvent.PointerMove),onPointerLeave:nodeEvent(GraphNodeEvent.PointerLeave),onPointerUp:nodeEvent(GraphNodeEvent.PointerUp),onDoubleClick:nodeEvent(GraphNodeEvent.DoubleClick),onMouseDown:nodeEvent(GraphNodeEvent.MouseDown),onMouseUp:nodeEvent(GraphNodeEvent.MouseUp),onMouseEnter:nodeEvent(GraphNodeEvent.MouseEnter),onMouseLeave:nodeEvent(GraphNodeEvent.MouseLeave),onContextMenu:nodeEvent(GraphNodeEvent.ContextMenu),onMouseMove:nodeEvent(GraphNodeEvent.MouseMove),onMouseOver:nodeEvent(GraphNodeEvent.MouseOver),onMouseOut:nodeEvent(GraphNodeEvent.MouseOut),onKeyDown:nodeEvent(GraphNodeEvent.KeyDown),onClick:function clickEvent(e){e.persist(),eventChannel.trigger({type:GraphNodeEvent.Click,rawEvent:e,isMultiSelect:checkIsMultiSelect(e),node:node})},"aria-label":getNodeAriaLabel(node),role:"group","aria-roledescription":"node","data-automation-id":automationId},react.createElement("g",{className:"node-box-container"},nodeConfig.render({model:node,theme:theme,viewport:viewport}))):(Debug.warn('Missing "render" method in node config '+shape),null)};try{GraphNode_GraphNode.displayName="GraphNode",GraphNode_GraphNode.__docgenInfo={description:"",displayName:"GraphNode",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"NodeModel<unknown, unknown>"}},isNodeEditDisabled:{defaultValue:null,description:"",name:"isNodeEditDisabled",required:!1,type:{name:"boolean"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}},getNodeAriaLabel:{defaultValue:null,description:"",name:"getNodeAriaLabel",required:!0,type:{name:"(node: ICanvasNode<unknown, unknown>) => string | undefined"}},graphId:{defaultValue:null,description:"",name:"graphId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GraphNode.tsx#GraphNode"]={docgenInfo:GraphNode_GraphNode.__docgenInfo,name:"GraphNode",path:"src/components/GraphNode.tsx#GraphNode"})}catch(__react_docgen_typescript_loader_error){}var GraphNodeControlPoints_ResizePoint=function ResizePoint(_a){var x=_a.x,y=_a.y,cursor=_a.cursor,theme=_a.theme,onMouseDown=_a.onMouseDown;return react.createElement("rect",{x:x,y:y,height:8,width:8,stroke:theme.controlPointColor,fill:"transparent",cursor:cursor,onMouseDown:onMouseDown})},GraphNodeControlPoints_GraphNodeControlPoints=function GraphNodeControlPoints(props){var _a,_b,node=props.node,eventChannel=props.eventChannel,graphConfig=useGraphConfig(),nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig),graphController=useGraphController(),minWidth=null!==(_a=null==nodeConfig?void 0:nodeConfig.getMinWidth(node))&&void 0!==_a?_a:0,minHeight=null!==(_b=null==nodeConfig?void 0:nodeConfig.getMinHeight(node))&&void 0!==_b?_b:0,theme=useTheme_useTheme().theme,height=getRectHeight(nodeConfig,node),width=getRectWidth(nodeConfig,node),getMouseDown=function getMouseDown(f){return function(evt){evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphNodeEvent.ResizingStart,rawEvent:evt,node:node});var drag=new DragController_DragController(new MouseMoveEventProvider(graphController.getGlobalEventTarget()),defaultGetPositionFromEvent);drag.onMove=function(_a){var totalDX=_a.totalDX,totalDY=_a.totalDY,rawEvent=_a.e;eventChannel.trigger(Object(tslib_es6.a)({type:GraphNodeEvent.Resizing,rawEvent:rawEvent,node:node,dx:0,dy:0,dWidth:0,dHeight:0},f(totalDX,totalDY)))},drag.onEnd=function(_a){var rawEvent=_a.e;eventChannel.trigger({type:GraphNodeEvent.ResizingEnd,rawEvent:rawEvent,node:node})},eventChannel.trigger({type:GraphNodeEvent.ResizingStart,rawEvent:evt,node:node}),drag.start(evt.nativeEvent)}},nw=getMouseDown((function(dx,dy){var finalDx=Math.min(dx,width-minWidth),finalDy=Math.min(dy,height-minHeight);return{dx:+finalDx,dy:+finalDy,dWidth:-finalDx,dHeight:-finalDy}})),n=getMouseDown((function(dx,dy){var finalDy=Math.min(dy,height-minHeight);return{dy:+finalDy,dHeight:-finalDy}})),ne=getMouseDown((function(dx,dy){var finalDx=Math.max(dx,minWidth-width),finalDy=Math.min(dy,height-minHeight);return{dy:+finalDy,dWidth:+finalDx,dHeight:-finalDy}})),e=getMouseDown((function(dx){return{dWidth:+Math.max(dx,minWidth-width)}})),se=getMouseDown((function(dx,dy){return{dWidth:+Math.max(dx,minWidth-width),dHeight:+Math.max(dy,minHeight-height)}})),s=getMouseDown((function(dx,dy){return{dHeight:+Math.max(dy,minHeight-height)}})),sw=getMouseDown((function(dx,dy){var finalDx=Math.min(dx,width-minWidth);return{dx:+finalDx,dWidth:-finalDx,dHeight:+Math.max(dy,minHeight-height)}})),w=getMouseDown((function(dx){var finalDx=Math.min(dx,width-minWidth);return{dx:finalDx,dWidth:-finalDx}}));return react.createElement(react.Fragment,null,react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,cursor:"nw-resize",x:node.x-15,y:node.y-15,onMouseDown:nw}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x+width/2,y:node.y-15,cursor:"n-resize",onMouseDown:n}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x+width+15,y:node.y-15,cursor:"ne-resize",onMouseDown:ne}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x+width+15,y:node.y+height/2,cursor:"e-resize",onMouseDown:e}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x+width+15,y:node.y+height+15,cursor:"se-resize",onMouseDown:se}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x+width/2,y:node.y+height+15,cursor:"s-resize",onMouseDown:s}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x-15,y:node.y+height+15,cursor:"sw-resize",onMouseDown:sw}),react.createElement(GraphNodeControlPoints_ResizePoint,{theme:theme,x:node.x-15,y:node.y+height/2,cursor:"w-resize",onMouseDown:w}))};try{GraphNodeControlPoints_GraphNodeControlPoints.displayName="GraphNodeControlPoints",GraphNodeControlPoints_GraphNodeControlPoints.__docgenInfo={description:"",displayName:"GraphNodeControlPoints",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"NodeModel<unknown, unknown>"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GraphNodeControlPoints.tsx#GraphNodeControlPoints"]={docgenInfo:GraphNodeControlPoints_GraphNodeControlPoints.__docgenInfo,name:"GraphNodeControlPoints",path:"src/components/GraphNodeControlPoints.tsx#GraphNodeControlPoints"})}catch(__react_docgen_typescript_loader_error){}var GraphOneNodePorts_GraphOneNodePorts=function GraphOneNodePorts(props){var data=props.data,node=props.node,getPortAriaLabel=props.getPortAriaLabel,eventChannel=props.eventChannel,viewport=props.viewport,graphId=props.graphId,graphConfig=useGraphConfig(),theme=useTheme_useTheme().theme,ports=node.ports;if(!ports)return null;var portEvent=function portEvent(type,port){return function(e){e.persist(),eventChannel.trigger({type:type,node:node,port:port,rawEvent:e})}};return react.createElement("g",null,ports.map((function(p){var _a,portShape=p.shape?p.shape:graphConfig.defaultPortShape,portConfig=graphConfig.getPortConfigByName(portShape);if(!portConfig||!portConfig.render)return Debug.warn("invalid port config "+node.id+":"+node.name+" - "+p.id+":"+p.name+", shape: "+p.shape),null;var pos=node.getPortPosition(p.id,graphConfig);if(!pos)return null;var portKey=getPortUid(graphId,node,p),automationId=null!==(_a=p.automationId)&&void 0!==_a?_a:function getPortAutomationId(port,parentNode){return"port-"+parentNode.name+"-"+parentNode.id+"-"+port.name+"-"+port.id}(p,node);return react.createElement("g",{key:portKey,id:portKey,tabIndex:0,focusable:"true",onPointerDown:portEvent(GraphPortEvent.PointerDown,p),onPointerUp:portEvent(GraphPortEvent.PointerUp,p),onDoubleClick:portEvent(GraphPortEvent.DoubleClick,p),onMouseDown:portEvent(GraphPortEvent.MouseDown,p),onMouseUp:portEvent(GraphPortEvent.MouseUp,p),onContextMenu:portEvent(GraphPortEvent.ContextMenu,p),onPointerEnter:portEvent(GraphPortEvent.PointerEnter,p),onPointerLeave:portEvent(GraphPortEvent.PointerLeave,p),onMouseMove:portEvent(GraphPortEvent.MouseMove,p),onMouseOver:portEvent(GraphPortEvent.MouseOver,p),onMouseOut:portEvent(GraphPortEvent.MouseOut,p),onFocus:portEvent(GraphPortEvent.Focus,p),onBlur:portEvent(GraphPortEvent.Blur,p),onKeyDown:portEvent(GraphPortEvent.KeyDown,p),"aria-label":getPortAriaLabel(data,node,p),role:"group","aria-roledescription":"port","data-automation-id":automationId},react.createElement(ConnectingStateContext.Consumer,null,(function(_a){var sourceNode=_a.sourceNode,sourcePort=_a.sourcePort;return null==portConfig?void 0:portConfig.render(Object(tslib_es6.a)({model:p,data:data,parentNode:node,theme:theme,anotherNode:sourceNode,anotherPort:sourcePort,viewport:viewport},pos))})))})))};try{GraphOneNodePorts_GraphOneNodePorts.displayName="GraphOneNodePorts",GraphOneNodePorts_GraphOneNodePorts.__docgenInfo={description:"",displayName:"GraphOneNodePorts",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"NodeModel<unknown, unknown>"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},getPortAriaLabel:{defaultValue:null,description:"",name:"getPortAriaLabel",required:!0,type:{name:"(data: GraphModel<unknown, unknown, unknown>, node: NodeModel<unknown, unknown>, port: ICanvasPort<unknown>) => string | undefined"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},getNodeAriaLabel:{defaultValue:null,description:"",name:"getNodeAriaLabel",required:!0,type:{name:"(node: ICanvasNode<unknown, unknown>) => string | undefined"}},graphId:{defaultValue:null,description:"",name:"graphId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/GraphOneNodePorts.tsx#GraphOneNodePorts"]={docgenInfo:GraphOneNodePorts_GraphOneNodePorts.__docgenInfo,name:"GraphOneNodePorts",path:"src/components/GraphOneNodePorts.tsx#GraphOneNodePorts"})}catch(__react_docgen_typescript_loader_error){}var GraphNodeParts_GraphNodeParts=function GraphNodeParts(_a){var node=_a.node,isNodeResizable=_a.isNodeResizable,commonProps=Object(tslib_es6.e)(_a,["node","isNodeResizable"]),virtualization=useVirtualization(),renderedArea=virtualization.renderedArea,viewport=virtualization.viewport,isVisible=isPointInRect(renderedArea,node);return react.useLayoutEffect((function(){isVisible&&virtualization.renderedEdges.add(node.id)}),[virtualization]),isVisible?react.createElement(react.Fragment,null,react.createElement(GraphNode_GraphNode,Object(tslib_es6.a)({},commonProps,{node:node,viewport:viewport})),react.createElement(GraphOneNodePorts_GraphOneNodePorts,Object(tslib_es6.a)({},commonProps,{node:node,viewport:viewport})),isNodeResizable&&state_isNodeEditing(node)&&react.createElement(GraphNodeControlPoints_GraphNodeControlPoints,{node:node,eventChannel:commonProps.eventChannel})):null},GraphNodePartsMemo=react.memo(GraphNodeParts_GraphNodeParts),NodeTreeNode=react.memo((function(_a){var node=_a.node,others=Object(tslib_es6.e)(_a,["node"]),values=node.values.map((function(arg){var it=arg[1];return react.createElement(GraphNodePartsMemo,Object(tslib_es6.a)({key:it.id,node:it},others))})),children=node.type===b_tree_NodeType.Internal?node.children.map((function(child,index){var key=index<node.selfSize?node.getKey(index):"last";return react.createElement(NodeTreeNode,Object(tslib_es6.a)({key:key,node:child},others))})):void 0;return react.createElement(react.Fragment,null,values,children)}),(function(prevProps,nextProps){return prevProps.node===nextProps.node}));NodeTreeNode.displayName="NodeTreeNode";var NodeTree_NodeTree=function NodeTree(_a){var tree=_a.tree,others=Object(tslib_es6.e)(_a,["tree"]);return react.createElement(NodeTreeNode,Object(tslib_es6.a)({node:tree.sortedRoot},others))};try{NodeTree_NodeTree.displayName="NodeTree",NodeTree_NodeTree.__docgenInfo={description:"",displayName:"NodeTree",props:{tree:{defaultValue:null,description:"",name:"tree",required:!0,type:{name:"OrderedMap<string, NodeModel<unknown, unknown>>"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}},isNodeEditDisabled:{defaultValue:null,description:"",name:"isNodeEditDisabled",required:!1,type:{name:"boolean"}},getNodeAriaLabel:{defaultValue:null,description:"",name:"getNodeAriaLabel",required:!0,type:{name:"(node: ICanvasNode<unknown, unknown>) => string | undefined"}},graphId:{defaultValue:null,description:"",name:"graphId",required:!0,type:{name:"string"}},getPortAriaLabel:{defaultValue:null,description:"",name:"getPortAriaLabel",required:!0,type:{name:"(data: GraphModel<unknown, unknown, unknown>, node: NodeModel<unknown, unknown>, port: ICanvasPort<unknown>) => string | undefined"}},isNodeResizable:{defaultValue:null,description:"",name:"isNodeResizable",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/tree/NodeTree.tsx#NodeTree"]={docgenInfo:NodeTree_NodeTree.__docgenInfo,name:"NodeTree",path:"src/components/tree/NodeTree.tsx#NodeTree"})}catch(__react_docgen_typescript_loader_error){}var VirtualizationProvider_VirtualizationProvider=function VirtualizationProvider(_a){var viewport=_a.viewport,isVirtualizationEnabled=_a.isVirtualizationEnabled,virtualizationDelay=_a.virtualizationDelay,eventChannel=_a.eventChannel,children=_a.children,renderedArea=function useRenderedArea(viewport,isVirtualizationEnabled){return Object(react.useMemo)((function(){return isVirtualizationEnabled?viewport_getRenderedArea(viewport):{minX:-Number.MAX_SAFE_INTEGER,minY:-Number.MAX_SAFE_INTEGER,maxX:Number.MAX_SAFE_INTEGER,maxY:Number.MAX_SAFE_INTEGER}}),[viewport,isVirtualizationEnabled])}(viewport,isVirtualizationEnabled),visibleArea=react.useMemo((function(){return viewport_getVisibleArea(viewport)}),[viewport]),context=useDeferredValue(react.useMemo((function(){return{viewport:viewport,renderedArea:renderedArea,visibleArea:visibleArea,renderedEdges:new Set,renderedNodes:new Set,timestamp:performance.now()}}),[viewport,renderedArea,visibleArea]),{timeout:virtualizationDelay}),previousContextRef=react.useRef(context);return react.useEffect((function(){var previousContext=previousContextRef.current;previousContextRef.current=context,eventChannel.trigger({type:GraphCanvasEvent.VirtualizationRecalculated,performanceStartTime:context.timestamp,renderedNodes:previousContext.renderedNodes,renderedEdges:previousContext.renderedEdges,previousRenderedNodes:previousContext.renderedNodes,previousRenderedEdges:previousContext.renderedEdges})}),[context,eventChannel]),react.createElement(VirtualizationContext.Provider,{value:context},children)};try{VirtualizationProvider_VirtualizationProvider.displayName="VirtualizationProvider",VirtualizationProvider_VirtualizationProvider.__docgenInfo={description:"",displayName:"VirtualizationProvider",props:{viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"Required<IViewport>"}},isVirtualizationEnabled:{defaultValue:null,description:"",name:"isVirtualizationEnabled",required:!0,type:{name:"boolean"}},virtualizationDelay:{defaultValue:null,description:"",name:"virtualizationDelay",required:!0,type:{name:"number"}},eventChannel:{defaultValue:null,description:"",name:"eventChannel",required:!0,type:{name:"EventChannel"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/VirtualizationProvider.tsx#VirtualizationProvider"]={docgenInfo:VirtualizationProvider_VirtualizationProvider.__docgenInfo,name:"VirtualizationProvider",path:"src/components/VirtualizationProvider.tsx#VirtualizationProvider"})}catch(__react_docgen_typescript_loader_error){}var mergeStyleSets=__webpack_require__(838),Graph_styles_getCursorStyle=function getCursorStyle(_a){var canvasMouseMode=_a.canvasMouseMode,state=_a.state,isPanDisabled=_a.isPanDisabled,isMultiSelecting=_a.isMultiSelecting;return state.behavior===GraphBehavior.connecting||["meta","control"].some((function(key){return state.activeKeys.has(key)}))?"initial":state.activeKeys.has("shift")?"crosshair":canvasMouseMode!==CanvasMouseMode.pan?state.activeKeys.has(" ")&&!isPanDisabled?"grab":isMultiSelecting?"crosshair":"inherit":isPanDisabled?"inherit":"grab"};function getNodeCursor(isNodeDraggable){return isNodeDraggable?"move":"initial"}function Graph(props){var _a,_b,_c,_d,_e,_f,_g,_h=react.useState(!1),focusedWithoutMouse=_h[0],setFocusedWithoutMouse=_h[1],graphController=useGraphController(),_j=function useGraphState(){return Object(react.useContext)(GraphStateContext)}(),state=_j.state,dispatch=_j.dispatch,data=state.data.present,viewport=state.viewport,eventChannel=graphController.eventChannel,graphId=useConst((function(){return"graph-"+Object(v4.a)()})),defaultSVGRef=react.useRef(null),_k=props.focusCanvasAccessKey,focusCanvasAccessKey=void 0===_k?"f":_k,_l=props.zoomSensitivity,zoomSensitivity=void 0===_l?.1:_l,_m=props.scrollSensitivity,scrollSensitivity=void 0===_m?.5:_m,_o=props.svgRef,svgRef=void 0===_o?defaultSVGRef:_o,_p=props.virtualizationDelay,virtualizationDelay=void 0===_p?500:_p,theme=useTheme_useTheme().theme,graphConfig=useGraphConfig(),featureControl=function useFeatureControl(features){return react.useMemo((function(){return{isNodesDraggable:features.has(GraphFeatures.nodeDraggable),isNodeResizable:features.has(GraphFeatures.nodeResizable),isAutoFitDisabled:!features.has(GraphFeatures.autoFit),isPanDisabled:!features.has(GraphFeatures.panCanvas),isMultiSelectDisabled:!features.has(GraphFeatures.multipleSelect),isLassoSelectEnable:features.has(GraphFeatures.lassoSelect),isNodeHoverViewEnabled:features.has(GraphFeatures.nodeHoverView),isClickNodeToSelectDisabled:!features.has(GraphFeatures.clickNodeToSelect),isConnectDisabled:!features.has(GraphFeatures.addNewEdges),isPortHoverViewEnable:features.has(GraphFeatures.portHoverView),isNodeEditDisabled:!features.has(GraphFeatures.editNode),isVerticalScrollDisabled:!features.has(GraphFeatures.canvasVerticalScrollable),isHorizontalScrollDisabled:!features.has(GraphFeatures.canvasHorizontalScrollable),isA11yEnable:features.has(GraphFeatures.a11yFeatures),isAutoAlignEnable:features.has(GraphFeatures.autoAlign),isCtrlKeyZoomEnable:features.has(GraphFeatures.ctrlKeyZoom),isLimitBoundary:features.has(GraphFeatures.limitBoundary),isVirtualizationEnabled:!features.has(GraphFeatures.autoFit),isEdgeEditable:features.has(GraphFeatures.editEdge),isDeleteDisabled:!features.has(GraphFeatures.delete),isPasteDisabled:!features.has(GraphFeatures.addNewNodes)||!features.has(GraphFeatures.addNewEdges),isUndoEnabled:features.has(GraphFeatures.undoStack)}}),[features])}(state.settings.features),_q=react.useState(),curHoverNode=_q[0],setCurHoverNode=_q[1],_r=react.useState(void 0),curHoverPort=_r[0],setCurHoverPort=_r[1],containerRef=react.useRef(null),rectRef=react.useRef(void 0),updateViewport=function useUpdateViewportCallback(rectRef,svgRef,eventChannel){return Object(react.useCallback)((function(){var _a,viewportRect=null===(_a=svgRef.current)||void 0===_a?void 0:_a.getBoundingClientRect();(function isRectChanged(a,b){return!a||!b||a!==b&&(a.top!==b.top||a.left!==b.left||a.width!==b.width||a.height!==b.height)})(rectRef.current,viewportRect)&&(rectRef.current=viewportRect,eventChannel.trigger({type:GraphCanvasEvent.ViewportResize,viewportRect:viewportRect}))}),[eventChannel,rectRef,svgRef])}(rectRef,svgRef,eventChannel);useEventChannel({props:props,dispatch:dispatch,rectRef:rectRef,svgRef:svgRef,setFocusedWithoutMouse:setFocusedWithoutMouse,containerRef:containerRef,featureControl:featureControl,graphConfig:graphConfig,setCurHoverNode:setCurHoverNode,setCurHoverPort:setCurHoverPort,updateViewport:updateViewport,eventChannel:eventChannel,graphController:graphController}),useContainerRect_useContainerRect(svgRef,containerRef,updateViewport);var isNodesDraggable=featureControl.isNodesDraggable,isNodeResizable=featureControl.isNodeResizable,isPanDisabled=featureControl.isPanDisabled,isMultiSelectDisabled=featureControl.isMultiSelectDisabled,isLassoSelectEnable=featureControl.isLassoSelectEnable,isNodeEditDisabled=featureControl.isNodeEditDisabled,isVerticalScrollDisabled=featureControl.isVerticalScrollDisabled,isHorizontalScrollDisabled=featureControl.isHorizontalScrollDisabled,isA11yEnable=featureControl.isA11yEnable,isCtrlKeyZoomEnable=featureControl.isCtrlKeyZoomEnable,isLimitBoundary=featureControl.isLimitBoundary,isVirtualizationEnabled=featureControl.isVirtualizationEnabled;!function useSelectBox(dispatch,selectBoxPositionState){var selectBoxPosition=useDeferredValue(selectBoxPositionState,{timeout:100});react.useEffect((function(){dispatch({type:GraphCanvasEvent.UpdateNodeSelectionBySelectBox})}),[selectBoxPosition])}(dispatch,state.selectBoxPosition);var canvasEventHandler=function canvasEventHandler(type){return function(rawEvent){rawEvent.persist(),eventChannel.trigger({type:type,rawEvent:rawEvent})}},classes=function getGraphStyles(props,state,theme,isPanDisabled,isNodeDraggable,focusedWithoutMouse,isMultiSelecting){var _a,_b,_c,_d;return Object(mergeStyleSets.a)({svg:["react-dag-editor-svg-container",components_Graph_styles_m.svg,null===(_c=props.styles)||void 0===_c?void 0:_c.svg,(_a={"& *:focus":{outline:theme.outlineStyle}},_a["& ."+components_Graph_styles_m.node]={cursor:getNodeCursor(isNodeDraggable)},_a)],container:["react-dag-editor-container",components_Graph_styles_m.container,(_b={cursor:Graph_styles_getCursorStyle({canvasMouseMode:props.canvasMouseMode,state:state,isPanDisabled:isPanDisabled,isMultiSelecting:isMultiSelecting})},_b["&."+components_Graph_styles_m.container]=Object(tslib_es6.a)(Object(tslib_es6.a)({background:theme.canvasBackground},props.style),null===(_d=props.styles)||void 0===_d?void 0:_d.root),_b),focusedWithoutMouse&&{outline:theme.focusOutlineColor+" solid 1px"}],buttonA11y:["react-dag-editor-a11y-help-button",components_Graph_styles_m.buttonA11Y],node:[components_Graph_styles_m.node]})}(props,state,theme,isPanDisabled,isNodesDraggable,focusedWithoutMouse,state.behavior===GraphBehavior.multiSelect);!function useWheelHandler(args){var containerRef=args.containerRef,svgRef=args.svgRef,rectRef=args.rectRef,zoomSensitivity=args.zoomSensitivity,scrollSensitivity=args.scrollSensitivity,isHorizontalScrollDisabled=args.isHorizontalScrollDisabled,isVerticalScrollDisabled=args.isVerticalScrollDisabled,isCtrlKeyZoomEnable=args.isCtrlKeyZoomEnable,eventChannel=args.eventChannel,graphConfig=args.graphConfig,dispatch=args.dispatch;Object(react.useLayoutEffect)((function(){var svg=svgRef.current,container=containerRef.current;if(!svg||!container)return noop;var onWheel=function onWheel(e){var rect=rectRef.current;if(rect&&svg.contains(document.activeElement))if(e.preventDefault(),e.ctrlKey&&isCtrlKeyZoomEnable){var scale=(normalizeWheelDelta(e.deltaMode,e.deltaY)>0?-zoomSensitivity:zoomSensitivity)+1;eventChannel.trigger({type:GraphCanvasEvent.Zoom,rawEvent:e,scale:scale,anchor:getRelativePoint(rect,e)})}else{var dx=isHorizontalScrollDisabled?0:-normalizeWheelDelta(e.deltaMode,e.shiftKey?e.deltaY:e.deltaX)*scrollSensitivity,dy=isVerticalScrollDisabled||e.shiftKey?0:-normalizeWheelDelta(e.deltaMode,e.deltaY)*scrollSensitivity;eventChannel.trigger({type:GraphCanvasEvent.MouseWheelScroll,dx:dx,dy:dy,rawEvent:e})}};return container.addEventListener("wheel",onWheel),function(){container.removeEventListener("wheel",onWheel)}}),[svgRef,rectRef,zoomSensitivity,scrollSensitivity,dispatch,isHorizontalScrollDisabled,isVerticalScrollDisabled,graphConfig,eventChannel,isCtrlKeyZoomEnable])}({containerRef:containerRef,svgRef:svgRef,rectRef:rectRef,zoomSensitivity:zoomSensitivity,scrollSensitivity:scrollSensitivity,dispatch:dispatch,isHorizontalScrollDisabled:isHorizontalScrollDisabled,isVerticalScrollDisabled:isVerticalScrollDisabled,isCtrlKeyZoomEnable:isCtrlKeyZoomEnable,eventChannel:eventChannel,graphConfig:graphConfig});var onContextMenuClick=react.useCallback((function(evt){evt.preventDefault(),evt.stopPropagation(),eventChannel.trigger({type:GraphContextMenuEvent.Close}),svgRef.current&&svgRef.current.focus({preventScroll:!0})}),[eventChannel,svgRef]),onFocusButtonClick=react.useCallback((function(){setFocusedWithoutMouse(!0),svgRef.current&&svgRef.current.focus({preventScroll:!0})}),[svgRef]);!function useSafariScale(_a){var rectRef=_a.rectRef,svgRef=_a.svgRef,eventChannel=_a.eventChannel;Object(react.useEffect)((function(){var el=svgRef.current;if(!isSafari||!el||isMobile())return function(){};var onGestureEvent=animationFramed((function(e){var scale=e.scale,delta=scale/prevScale;prevScale=scale,eventChannel.trigger({type:GraphCanvasEvent.Zoom,rawEvent:e,scale:delta,anchor:getContainerCenter(rectRef)})})),onGestureStart=function onGestureStart(e){e.stopPropagation(),e.preventDefault(),prevScale=e.scale,eventChannel.trigger({type:GraphCanvasEvent.Zoom,rawEvent:e,scale:e.scale,anchor:getContainerCenter(rectRef)})},onGestureChange=function onGestureChange(e){e.stopPropagation(),e.preventDefault(),onGestureEvent(e)},onGestureEnd=function onGestureEnd(e){e.stopPropagation(),e.preventDefault(),onGestureEvent(e)};return el.addEventListener("gesturestart",onGestureStart),el.addEventListener("gesturechange",onGestureChange),el.addEventListener("gestureend",onGestureEnd),function(){el.removeEventListener("gesturestart",onGestureStart),el.removeEventListener("gesturechange",onGestureChange),el.removeEventListener("gestureend",onGestureEnd)}}),[])}({rectRef:rectRef,svgRef:svgRef,eventChannel:eventChannel});var accessKey=isA11yEnable?focusCanvasAccessKey:void 0,touchHandlers=function useGraphTouchHandler(rectRef,eventChannel){return react.useMemo((function(){return new TouchController_TouchController((new Map).set(2,new TwoFingerHandler_TwoFingerHandler(rectRef,eventChannel))).eventHandlers}),[rectRef,eventChannel])}(rectRef,eventChannel);if(!function isSupported(){if(isMobile())return!1;var browser=getBrowser();return[BrowserType.chrome,BrowserType.edgeChromium,BrowserType.firefox,BrowserType.safari,BrowserType.electron].indexOf(browser)>-1}()){var _s=props.onBrowserNotSupported,onBrowserNotSupported=void 0===_s?function(){return react.createElement("p",null,"Your browser is not supported")}:_s;return react.createElement(react.Fragment,null,onBrowserNotSupported())}return react.createElement("div",Object(tslib_es6.a)({ref:containerRef,role:"application",id:graphId,className:classes.container},touchHandlers,{onDoubleClick:canvasEventHandler(GraphCanvasEvent.DoubleClick),onMouseDown:canvasEventHandler(GraphCanvasEvent.MouseDown),onMouseUp:canvasEventHandler(GraphCanvasEvent.MouseUp),onContextMenu:canvasEventHandler(GraphCanvasEvent.ContextMenu),onMouseMove:canvasEventHandler(GraphCanvasEvent.MouseMove),onMouseOver:canvasEventHandler(GraphCanvasEvent.MouseOver),onMouseOut:canvasEventHandler(GraphCanvasEvent.MouseOut),onFocus:canvasEventHandler(GraphCanvasEvent.Focus),onBlur:canvasEventHandler(GraphCanvasEvent.Blur),onKeyDown:canvasEventHandler(GraphCanvasEvent.KeyDown),onKeyUp:canvasEventHandler(GraphCanvasEvent.KeyUp)}),react.createElement("button",{className:classes.buttonA11y,onClick:onFocusButtonClick,accessKey:accessKey,hidden:!0}),react.createElement("svg",{tabIndex:0,focusable:"true",preserveAspectRatio:"xMidYMid meet",ref:svgRef,className:classes.svg,"data-graph-id":graphId},react.createElement("title",null,props.title),react.createElement("desc",null,props.desc),react.createElement(Transform_Transform,{matrix:viewport.transformMatrix},state.viewport.rect&&react.createElement(VirtualizationProvider_VirtualizationProvider,{viewport:state.viewport,isVirtualizationEnabled:isVirtualizationEnabled,virtualizationDelay:virtualizationDelay,eventChannel:eventChannel},react.createElement(GraphGroupsRenderer_GraphGroupsRenderer,{data:data,groups:null!==(_a=data.groups)&&void 0!==_a?_a:emptyArrayInstance}),react.createElement(EdgeTree_EdgeTree,{graphId:graphId,tree:data.edges,data:data,eventChannel:eventChannel}),react.createElement(NodeTree_NodeTree,{graphId:graphId,isNodeResizable:isNodeResizable,tree:data.nodes,data:data,isNodeEditDisabled:isNodeEditDisabled,eventChannel:eventChannel,getNodeAriaLabel:null!==(_b=props.getNodeAriaLabel)&&void 0!==_b?_b:defaultGetNodeAriaLabel,getPortAriaLabel:null!==(_c=props.getPortAriaLabel)&&void 0!==_c?_c:defaultGetPortAriaLabel})),state.dummyNodes.isVisible&&react.createElement(AnimatingNodeGroup_AnimatingNodeGroup,{dummyNodes:state.dummyNodes,graphData:state.data.present}),react.createElement(AlignmentLines,{style:null===(_d=props.styles)||void 0===_d?void 0:_d.alignmentLine})),(!isMultiSelectDisabled||isLassoSelectEnable)&&react.createElement(SelectBox_SelectBox,{selectBoxPosition:state.selectBoxPosition,style:null===(_e=props.styles)||void 0===_e?void 0:_e.selectBox}),state.connectState&&react.createElement(Connecting,{graphConfig:graphConfig,eventChannel:eventChannel,viewport:state.viewport,styles:null===(_f=props.styles)||void 0===_f?void 0:_f.connectingLine,movingPoint:state.connectState.movingPoint})),(!isVerticalScrollDisabled||!isHorizontalScrollDisabled||!isPanDisabled)&&isLimitBoundary&&isViewportComplete(state.viewport)&&react.createElement(Scrollbar_Scrollbar,{viewport:state.viewport,offsetLimit:getOffsetLimit_getOffsetLimit({data:data,graphConfig:graphConfig,rect:state.viewport.rect,transformMatrix:viewport.transformMatrix,canvasBoundaryPadding:state.settings.canvasBoundaryPadding,groupPadding:null===(_g=data.groups[0])||void 0===_g?void 0:_g.padding}),dispatch:dispatch,horizontal:!isHorizontalScrollDisabled,vertical:!isVerticalScrollDisabled,eventChannel:eventChannel}),react.createElement(GraphContextMenu_GraphContextMenu,{state:state,onClick:onContextMenuClick,"data-automation-id":"context-menu-container"}),function renderNodeTooltip(){var _a;return curHoverNode&&isViewportComplete(state.viewport)?state.contextMenuPosition&&curHoverNode===(null===(_a=state.data.present.nodes.find(state_isSelected))||void 0===_a?void 0:_a.id)?null:react.createElement(NodeTooltips_NodeTooltips,{node:data.nodes.get(curHoverNode),viewport:state.viewport}):null}(),function renderPortTooltip(){if(!curHoverPort||!isViewportComplete(state.viewport))return null;var nodeId=curHoverPort[0],portId=curHoverPort[1],node=data.nodes.get(nodeId);if(!node)return null;var port=node.getPort(portId);return port?react.createElement(PortTooltips_PortTooltips,{port:port,parentNode:node,data:data,viewport:state.viewport}):null}())}try{Graph.displayName="Graph",Graph.__docgenInfo={description:"",displayName:"Graph",props:{title:{defaultValue:null,description:"Title of the svg",name:"title",required:!1,type:{name:"string"}},desc:{defaultValue:null,description:"Desc of the svg",name:"desc",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"Custom styling for the graph container",name:"style",required:!1,type:{name:"CSSProperties"}},classes:{defaultValue:null,description:"",name:"classes",required:!1,type:{name:"IGraphClasses"}},styles:{defaultValue:null,description:"Custom styling for the elements in graph",name:"styles",required:!1,type:{name:"IGraphStyles"}},canvasMouseMode:{defaultValue:null,description:"The mouse mode: select or pan",name:"canvasMouseMode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"pan"'},{value:'"select"'}]}},svgRef:{defaultValue:null,description:"The ref of the svg element",name:"svgRef",required:!1,type:{name:"RefObject<SVGSVGElement>"}},focusCanvasAccessKey:{defaultValue:{value:'"f"'},description:"The access key to focus the canvas\n@",name:"focusCanvasAccessKey",required:!1,type:{name:"string"}},zoomSensitivity:{defaultValue:{value:"0.1"},description:"Zoom sensitivity",name:"zoomSensitivity",required:!1,type:{name:"number"}},scrollSensitivity:{defaultValue:{value:"0.5"},description:"Scroll/wheel sensitivity",name:"scrollSensitivity",required:!1,type:{name:"number"}},dragThreshold:{defaultValue:{value:"10"},description:"The threshold of drag/click",name:"dragThreshold",required:!1,type:{name:"number"}},autoAlignThreshold:{defaultValue:{value:"50"},description:"The threshold of numbers of visible nodes to disable auto align",name:"autoAlignThreshold",required:!1,type:{name:"number"}},getPositionFromEvent:{defaultValue:{value:'"(e: MouseEvent) => ({ x: e.clientX, y: e.clientY })"'},description:"Custom overrides to get the client position",name:"getPositionFromEvent",required:!1,type:{name:"TGetPositionFromEvent"}},virtualizationDelay:{defaultValue:{value:"500"},description:"Delay time of virtualization calculation in ms",name:"virtualizationDelay",required:!1,type:{name:"number"}},onBrowserNotSupported:{defaultValue:null,description:"Render function when browser not supported.",name:"onBrowserNotSupported",required:!1,type:{name:"(() => ReactChild)"}},edgeWillAdd:{defaultValue:null,description:"Triggered before add an edge",name:"edgeWillAdd",required:!1,type:{name:"((edge: ICanvasEdge<EdgeData>, data: GraphModel<NodeData, EdgeData, PortData>) => ICanvasEdge<unknown>)"}},getNodeAriaLabel:{defaultValue:null,description:"Custom overrides the nodes aria-label",name:"getNodeAriaLabel",required:!1,type:{name:"((node: ICanvasNode<NodeData, PortData>) => string) | undefined"}},getPortAriaLabel:{defaultValue:null,description:"Custom overrides the ports aria-label",name:"getPortAriaLabel",required:!1,type:{name:"((data: GraphModel<NodeData, EdgeData, PortData>, node: NodeModel<NodeData, PortData>, port: ICanvasPort<PortData>) => string) | undefined"}},onEvent:{defaultValue:null,description:"The events handler function\n@param event",name:"onEvent",required:!1,type:{name:"((event: IEvent<NodeData, EdgeData, PortData>) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Graph/Graph.tsx#Graph"]={docgenInfo:Graph.__docgenInfo,name:"Graph",path:"src/components/Graph/Graph.tsx#Graph"})}catch(__react_docgen_typescript_loader_error){}var mergeStyles=__webpack_require__(835),getAlignmentLines=function getAlignmentLines(draggingNodes,nodes,graphConfig,threshold){void 0===threshold&&(threshold=2);var dummyDraggingNodeHW=autoAlign_getDummyDraggingNode(draggingNodes),closestNodes=getClosestNodes(dummyDraggingNodeHW,draggingNodes,nodes,graphConfig,threshold);return autoAlign_getLines(dummyDraggingNodeHW,closestNodes,draggingNodes.length)},getAutoAlignDisplacement=function getAutoAlignDisplacement(alignmentLines,nodes,graphConfig,alignDirection){var min=1/0,res=0,nodeHW=autoAlign_getDummyDraggingNode(nodes),widthOrHeight="x"===alignDirection?nodeHW.width||0:nodeHW.height||0;return alignmentLines.forEach((function(item){var alignLine;if("x"===alignDirection&&item.x1===item.x2)alignLine=item.x1;else{if("y"!==alignDirection||item.y1!==item.y2)return;alignLine=item.y1}var distance1=nodeHW[alignDirection]-alignLine,distanceMiddle=nodeHW[alignDirection]+(widthOrHeight||0)/2-alignLine,distance2=nodeHW[alignDirection]+(widthOrHeight||0)-alignLine;Math.abs(distance1)<min&&(min=Math.abs(distance1),res=distance1>0?-min:min),Math.abs(distanceMiddle)<min&&(min=Math.abs(distanceMiddle),res=distanceMiddle>0?-min:min),Math.abs(distance2)<min&&(min=Math.abs(distance2),res=distance2>0?-min:min)})),res},getMinCoordinate=function getMinCoordinate(nodes,field){if(nodes.length)return Math.min.apply(Math,nodes.map((function(n){return n[field]})))},getMaxCoordinate=function getMaxCoordinate(nodes,field){if(nodes.length)return Math.max.apply(Math,nodes.map((function(n){return n[field]+("y"===field?n.height||0:n.width||0)})))},autoAlign_getDummyDraggingNode=function getDummyDraggingNode(draggingNodes){var _a=function getBoundingBoxOfNodes(nodes){var minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0;return nodes.forEach((function(n){var tempMinX=n.x,tempMinY=n.y,tempMaxX=n.x+(n.width||0),tempMaxY=n.y+(n.height||0);tempMinX<minX&&(minX=tempMinX),tempMinY<minY&&(minY=tempMinY),tempMaxX>maxX&&(maxX=tempMaxX),tempMaxY>maxY&&(maxY=tempMaxY)})),{x:minX,y:minY,width:maxX-minX,height:maxY-minY}}(draggingNodes),x=_a.x,y=_a.y,width=_a.width,height=_a.height;return{id:Object(v4.a)(),x:x,y:y,width:width,height:height}},getClosestNodes=function getClosestNodes(dummyDraggingNode,draggingNodes,nodes,graphConfig,threshold){void 0===threshold&&(threshold=2);var resX=[],resY=[],draggingNodeX=dummyDraggingNode.x,draggingNodeY=dummyDraggingNode.y,_a=dummyDraggingNode.width,draggingNodeWidth=void 0===_a?0:_a,_b=dummyDraggingNode.height,draggingNodeHeight=void 0===_b?0:_b,minDistanceX=threshold,minDistanceY=threshold;return nodes.forEach((function(node){if(!draggingNodes.find((function(dn){return dn.id===node.id}))){var nodeHW=function setSizeForNode(node,graphConfig){return Object(tslib_es6.a)(Object(tslib_es6.a)({},node),getNodeSize(node,graphConfig))}(node,graphConfig),_a=nodeHW.width,nodeWidth=void 0===_a?0:_a,_b=nodeHW.height,nodeHeight=void 0===_b?0:_b;[draggingNodeX,draggingNodeX+draggingNodeWidth/2,draggingNodeX+draggingNodeWidth].forEach((function(draggingNodeValue,alignPos){resX[alignPos]||(resX[alignPos]={}),resX[alignPos].closestNodes||(resX[alignPos].closestNodes=[]),[nodeHW.x,nodeHW.x+nodeWidth/2,nodeHW.x+nodeWidth].forEach((function(comparedValue){var _a,distance=Math.abs(draggingNodeValue-comparedValue);distance<=minDistanceX&&(null===(_a=resX[alignPos].closestNodes)||void 0===_a||_a.push(nodeHW),resX[alignPos].alignCoordinateValue=comparedValue,minDistanceX=distance)}))})),[draggingNodeY,draggingNodeY+draggingNodeHeight/2,draggingNodeY+draggingNodeHeight].forEach((function(draggingNodeValue,alignPos){resY[alignPos]||(resY[alignPos]={}),resY[alignPos].closestNodes||(resY[alignPos].closestNodes=[]),[nodeHW.y,nodeHW.y+nodeHeight/2,nodeHW.y+nodeHeight].forEach((function(comparedValue){var _a,distance=Math.abs(draggingNodeValue-comparedValue);distance<=minDistanceY&&(null===(_a=resY[alignPos].closestNodes)||void 0===_a||_a.push(nodeHW),resY[alignPos].alignCoordinateValue=comparedValue,minDistanceY=distance)}))}))}})),{closestX:resX,closestY:resY}},autoAlign_getLines=function getLines(draggingNode,closestNodes,numberOfDraggingNodes){void 0===numberOfDraggingNodes&&(numberOfDraggingNodes=1);var xLines=[],yLines=[],closestXNodes=closestNodes.closestX,closestYNodes=closestNodes.closestY;return closestXNodes.forEach((function(item,alignPos){var _a;if(!(void 0===item.alignCoordinateValue||1===alignPos&&(xLines.length||numberOfDraggingNodes>1))){var sameXNodes=[],x=item.alignCoordinateValue;null===(_a=item.closestNodes)||void 0===_a||_a.forEach((function(node){node.x!==x&&node.x+(node.width||0)/2!==x&&node.x+(node.width||0)!==x||sameXNodes.push(node)}));var y1=getMinCoordinate(Object(tslib_es6.f)([draggingNode],sameXNodes),"y"),y2=getMaxCoordinate(Object(tslib_es6.f)([draggingNode],sameXNodes),"y");void 0!==y1&&void 0!==y2&&xLines.push({x1:x,y1:y1,x2:x,y2:y2,visible:!0})}})),closestYNodes.forEach((function(item,alignPos){var _a;if(!(void 0===item.alignCoordinateValue||1===alignPos&&(yLines.length||numberOfDraggingNodes>1))){var sameYNodes=[],y=item.alignCoordinateValue;null===(_a=item.closestNodes)||void 0===_a||_a.forEach((function(node){node.y!==y&&node.y+(node.height||0)/2!==y&&node.y+(node.height||0)!==y||sameYNodes.push(node)}));var x1=getMinCoordinate(Object(tslib_es6.f)([draggingNode],sameYNodes),"x"),x2=getMaxCoordinate(Object(tslib_es6.f)([draggingNode],sameYNodes),"x");void 0!==x1&&void 0!==x2&&yLines.push({x1:x1,y1:y,x2:x2,y2:y,visible:!0})}})),Object(tslib_es6.f)(Object(tslib_es6.f)([],xLines),yLines)};var AddingNodeSvg_AddingNodeSvg=function AddingNodeSvg(_a){var model=_a.model,svgRef=_a.svgRef,nextNodeRef=_a.nextNodeRef,rect=function useSvgRect(svgRef){var _a=Object(react.useState)(void 0),rect=_a[0],setRect=_a[1];return Object(react.useLayoutEffect)((function(){svgRef.current&&setRect(svgRef.current.getBoundingClientRect())}),[svgRef]),rect}(svgRef),graphConfig=useGraphConfig(),graphController=useGraphController(),alignmentLines=useAlignmentLines(),viewport=useViewport(),dummyNode=react.useMemo((function(){if(!model||!viewport.rect)return null;var transformMatrix=viewport.transformMatrix,_a=viewport.rect,left=_a.left,top=_a.top,diffLeft=left/transformMatrix[0],diffTop=top/transformMatrix[3];return Object(tslib_es6.a)({id:model.id,x:model.x-diffLeft,y:model.y-diffTop},getNodeSize(model,graphConfig))}),[graphConfig,viewport,model]);react.useLayoutEffect((function(){dummyNode&&graphController.eventChannel.trigger({type:GraphCanvasEvent.DraggingNodeFromItemPanel,node:dummyNode})}),[null==dummyNode?void 0:dummyNode.x,null==dummyNode?void 0:dummyNode.y]);var attachedNode=react.useMemo((function(){if(!dummyNode||!model)return null;var dxAligned=getAutoAlignDisplacement(alignmentLines,[dummyNode],0,"x"),dyAligned=getAutoAlignDisplacement(alignmentLines,[dummyNode],0,"y");return Object(tslib_es6.a)(Object(tslib_es6.a)({},model),{x:model.x+dxAligned,y:model.y+dyAligned})}),[alignmentLines,dummyNode,graphConfig,model]);react.useEffect((function(){nextNodeRef.current=attachedNode}),[nextNodeRef,attachedNode]);var eventChannel=useConst((function(){return new eventChannel_EventChannel})),tempGraphId=useConst(v4.a),node=react.useMemo((function(){return NodeModel_NodeModel.fromJSON(null!=attachedNode?attachedNode:model,void 0,void 0)}),[attachedNode,model]);return react.createElement("svg",{id:tempGraphId,ref:svgRef,className:components_Graph_styles_m.addingNodeSvg,preserveAspectRatio:"xMidYMid meet"},react.createElement(Transform_Transform,{matrix:viewport.transformMatrix},rect&&react.createElement(GraphNode_GraphNode,{graphId:tempGraphId,node:node,viewport:{rect:rect,transformMatrix:viewport.transformMatrix},eventChannel:eventChannel,getNodeAriaLabel:defaultGetNodeAriaLabel})))};try{AddingNodeSvg_AddingNodeSvg.displayName="AddingNodeSvg",AddingNodeSvg_AddingNodeSvg.__docgenInfo={description:"",displayName:"AddingNodeSvg",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"ICanvasNode<unknown, unknown>"}},nextNodeRef:{defaultValue:null,description:"",name:"nextNodeRef",required:!0,type:{name:"MutableRefObject<ICanvasNode<unknown, unknown> | null>"}},svgRef:{defaultValue:null,description:"",name:"svgRef",required:!0,type:{name:"RefObject<SVGSVGElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ItemPanel/AddingNodeSvg.tsx#AddingNodeSvg"]={docgenInfo:AddingNodeSvg_AddingNodeSvg.__docgenInfo,name:"AddingNodeSvg",path:"src/components/ItemPanel/AddingNodeSvg.tsx#AddingNodeSvg"})}catch(__react_docgen_typescript_loader_error){}var Item_el=document.createElement("div");document.body.appendChild(Item_el);var Item_adjustPosition=function adjustPosition(clientX,clientY,rect,transformMatrix,node,nodeConfig){var rectWidth=getRectWidth(nodeConfig,node),rectHeight=getRectHeight(nodeConfig,node);return function adjustedClientPoint(x,y,rect,transformMatrix){var adjustedX=x,adjustedY=y;rect&&(adjustedX=x-rect.left,adjustedY=y-rect.top);return reverseTransformPoint(adjustedX,adjustedY,transformMatrix)}(clientX-(transformMatrix[0]*rectWidth+transformMatrix[2]*rectHeight)/2,clientY-(transformMatrix[1]*rectWidth+transformMatrix[3]*rectHeight)/2,rect,transformMatrix)},Item_Item=function Item(props){var graphConfig=useGraphConfig(),graphController=useGraphController(),_a=react.useState(null),workingModel=_a[0],setWorkingModel=_a[1],nextNodeRef=useRefValue(workingModel),svgRef=react.useRef(null),style=props.style,children=props.children,model=props.model,_b=props.nodeWillAdd,nodeWillAdd=void 0===_b?identical:_b,_c=props.nodeDidAdd,nodeDidAdd=void 0===_c?noop:_c,_d=props.dragWillStart,dragWillStart=void 0===_d?noop:_d,onPointerDown=react.useCallback((function(evt){if(evt.stopPropagation(),("mouse"!==evt.pointerType||evt.button===MouseEventButton.Primary)&&graphController.getEnabledFeatures().has(GraphFeatures.addNewNodes)){var shape=props.shape||model.shape,nodeConfig=graphConfig.getNodeConfigByName(shape),node=Object(tslib_es6.a)(Object(tslib_es6.a)(Object(tslib_es6.a)({},function deepClone(obj){if("object"!==_typeof(obj))return obj;var newObj=obj instanceof Array?[]:{};for(var key in obj)"object"===_typeof(obj[key])&&null!==obj[key]?newObj[key]=deepClone(obj[key]):newObj[key]=obj[key];return newObj}(model)),Item_adjustPosition(evt.clientX,evt.clientY,void 0,graphController.state.viewport.transformMatrix,model,nodeConfig)),{id:model.id||Object(v4.a)()}),drag=new DragController_DragController(new PointerEventProvider_PointerEventProvider(graphController.getGlobalEventTarget()),defaultGetPositionFromEvent),eventChannel=graphController.eventChannel;eventChannel.trigger({type:GraphCanvasEvent.DraggingNodeFromItemPanelStart,rawEvent:evt}),drag.onMove=function(_a){var e=_a.e;setWorkingModel((function(n){return n?Object(tslib_es6.a)(Object(tslib_es6.a)({},n),Item_adjustPosition(e.clientX,e.clientY,void 0,graphController.state.viewport.transformMatrix,model,nodeConfig)):n}))},drag.onEnd=function(_a){var e=_a.e,viewport=graphController.state.viewport,nextNode=nextNodeRef.current;if(!isViewportComplete(viewport)||!nextNode||!function isWithInBound(rect,clientX,clientY){var top=rect.top,right=rect.right,bottom=rect.bottom;return clientX>=rect.left&&clientX<=right&&clientY>=top&&clientY<=bottom}(viewport.rect,e.clientX,e.clientY))return setWorkingModel(null),void eventChannel.trigger({type:GraphCanvasEvent.DraggingNodeFromItemPanelEnd,node:null});nextNodeRef.current=null,nextNode=Object(tslib_es6.a)(Object(tslib_es6.a)({},nextNode),Item_adjustPosition(e.clientX,e.clientY,viewport.rect,viewport.transformMatrix,model,nodeConfig)),nextNode=nodeWillAdd(nextNode),eventChannel.trigger({type:GraphCanvasEvent.DraggingNodeFromItemPanelEnd,node:nextNode}),nodeDidAdd(nextNode),setWorkingModel(null)},dragWillStart(node),setWorkingModel(node),drag.start(evt.nativeEvent)}}),[graphController,props.shape,model,graphConfig,dragWillStart,nextNodeRef,nodeWillAdd,nodeDidAdd]),className=Object(mergeStyles.a)(components_Graph_styles_m.moduleItem,props.className);return react.createElement(react.Fragment,null,react.createElement("div",{className:className,style:style,onPointerDown:onPointerDown,role:"button"},children),workingModel&&react_dom.createPortal(react.createElement(AddingNodeSvg_AddingNodeSvg,{svgRef:svgRef,model:workingModel,nextNodeRef:nextNodeRef}),Item_el))};try{Item_Item.displayName="Item",Item_Item.__docgenInfo={description:"The Item in the item panel from which we can add node to the canvas.",displayName:"Item",props:{style:{defaultValue:null,description:"Custom styling for the Item",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"ClassName for the Item",name:"className",required:!1,type:{name:"string"}},model:{defaultValue:null,description:"The node model of type ICanvasNode",name:"model",required:!0,type:{name:"Partial<ICanvasNode<unknown, unknown>>"}},shape:{defaultValue:null,description:"The shape of the node model",name:"shape",required:!1,type:{name:"string"}},dragWillStart:{defaultValue:null,description:"Triggered just before drag the model node from the item panel",name:"dragWillStart",required:!1,type:{name:"((node: ICanvasNode<unknown, unknown>) => void)"}},nodeWillAdd:{defaultValue:null,description:"Triggered just before the node will be added on the canvas",name:"nodeWillAdd",required:!1,type:{name:"((node: ICanvasNode<unknown, unknown>) => ICanvasNode<unknown, unknown>)"}},nodeDidAdd:{defaultValue:null,description:"Triggered just after the node added on the canvas",name:"nodeDidAdd",required:!1,type:{name:"((node: ICanvasNode<unknown, unknown>) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ItemPanel/Item.tsx#Item"]={docgenInfo:Item_Item.__docgenInfo,name:"Item",path:"src/components/ItemPanel/Item.tsx#Item"})}catch(__react_docgen_typescript_loader_error){}var TouchDragAdapter_TouchDragAdapter=function(){function TouchDragAdapter(){this.startListeners=new Set,this.moveListeners=new Set,this.endListeners=new Set}return TouchDragAdapter.prototype.off=function(type,callback){switch(type){case"start":this.startListeners.delete(callback);break;case"move":this.moveListeners.delete(callback);break;case"end":this.endListeners.delete(callback)}return this},TouchDragAdapter.prototype.on=function(type,callback){switch(type){case"start":this.startListeners.add(callback);break;case"move":this.moveListeners.add(callback);break;case"end":this.endListeners.add(callback)}return this},TouchDragAdapter.prototype.onStart=function(events,e){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];this.startListeners.forEach((function(cb){cb.call.apply(cb,Object(tslib_es6.f)([void 0,e],args))}))},TouchDragAdapter.prototype.onMove=function(events,e){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];this.moveListeners.forEach((function(cb){cb.call.apply(cb,Object(tslib_es6.f)([void 0,e],args))}))},TouchDragAdapter.prototype.onEnd=function(e){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.endListeners.forEach((function(cb){cb.call.apply(cb,Object(tslib_es6.f)([void 0,e],args))}))},TouchDragAdapter}(),StaticNode_StaticNode=function StaticNode(props){var node=props.node,graphConfig=useGraphConfig(),theme=useTheme_useTheme().theme,nodeConfig=getNodeConfig_getNodeConfig(node,graphConfig);if(null==nodeConfig?void 0:nodeConfig.renderStatic)return react.createElement("g",null,nodeConfig.renderStatic({model:node,theme:theme}));var rectHeight=getRectHeight(nodeConfig,node),rectWidth=getRectWidth(nodeConfig,node);return react.createElement("rect",{transform:"translate("+node.x+", "+node.y+")",height:rectHeight,width:rectWidth,fill:theme.dummyNodeStroke})},StaticNodeWithMemo=react.memo(StaticNode_StaticNode,(function(prevProps,nextProps){var prevNode=prevProps.node,nextNode=nextProps.node;return prevNode.x===nextNode.x&&prevNode.y===nextNode.y&&prevNode.height===nextNode.height&&prevNode.width===nextNode.width&&prevNode.isInSearchResults===nextNode.isInSearchResults&&prevNode.isCurrentSearchResult===nextNode.isCurrentSearchResult})),ReadonlyNodeTreeNode=react.memo((function(_a){var node=_a.node,values=node.values.map((function(it){return react.createElement(StaticNodeWithMemo,{key:it[1].id,node:it[1]})})),children=node.type===b_tree_NodeType.Internal?node.children.map((function(child,index){var key=index<node.selfSize?node.getKey(index):"last";return react.createElement(ReadonlyNodeTreeNode,{key:key,node:child})})):void 0;return react.createElement(react.Fragment,null,values,children)}));ReadonlyNodeTreeNode.displayName="ReadonlyNodeTreeNode";var ReadonlyNodeTree_ReadonlyNodeTree=function ReadonlyNodeTree(_a){var tree=_a.tree;return react.createElement(ReadonlyNodeTreeNode,{node:tree.sortedRoot})};try{ReadonlyNodeTree_ReadonlyNodeTree.displayName="ReadonlyNodeTree",ReadonlyNodeTree_ReadonlyNodeTree.__docgenInfo={description:"",displayName:"ReadonlyNodeTree",props:{tree:{defaultValue:null,description:"",name:"tree",required:!0,type:{name:"OrderedMap<string, NodeModel<unknown, unknown>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/tree/ReadonlyNodeTree.tsx#ReadonlyNodeTree"]={docgenInfo:ReadonlyNodeTree_ReadonlyNodeTree.__docgenInfo,name:"ReadonlyNodeTree",path:"src/components/tree/ReadonlyNodeTree.tsx#ReadonlyNodeTree"})}catch(__react_docgen_typescript_loader_error){}var StaticGraph_StaticGraph=function StaticGraph(props){var nodes=props.data.nodes,style=Object(tslib_es6.a)({position:"absolute",top:0,left:0,height:"100%",width:"100%"},props.style);return react.createElement("svg",{style:style},react.createElement(Transform_Transform,{matrix:props.transformMatrix},react.createElement(ReadonlyNodeTree_ReadonlyNodeTree,{tree:nodes})))};try{StaticGraph_StaticGraph.displayName="StaticGraph",StaticGraph_StaticGraph.__docgenInfo={description:"",displayName:"StaticGraph",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},transformMatrix:{defaultValue:null,description:"",name:"transformMatrix",required:!0,type:{name:"ITransformMatrix"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/StaticGraph/StaticGraph.tsx#StaticGraph"]={docgenInfo:StaticGraph_StaticGraph.__docgenInfo,name:"StaticGraph",path:"src/components/StaticGraph/StaticGraph.tsx#StaticGraph"})}catch(__react_docgen_typescript_loader_error){}var Shadow_MiniMapShadow=function MiniMapShadow(_a){var rect=_a.containerRect,viewport=_a.viewport,_b=_a.shadowPadding,shadowPadding=void 0===_b?0:_b,onClick=_a.onClick,theme=useTheme_useTheme().theme;if(!rect)return null;var shadowStyle={fill:theme.minimapShadow,opacity:.1},lineStyle={stroke:theme.inputFocusBorderAlt,strokeWidth:1},viewportStartX=Math.max(viewport.startX,shadowPadding),viewportStartY=Math.max(viewport.startY,shadowPadding),viewportEndX=Math.min(viewport.endX,rect.width-shadowPadding),viewportEndY=Math.min(viewport.endY,rect.height-shadowPadding),sideShadowHeight=viewportEndY-viewportStartY,rightShadowWidth=rect.width-viewportEndX,bottomShadowHeight=rect.height-viewportEndY;return react.createElement(react.Fragment,null,viewportStartY>0&&react.createElement("g",null,react.createElement("rect",{onClick:onClick,onMouseDown:stopPropagation,onPointerDown:stopPropagation,x:0,y:0,height:viewportStartY,width:rect.width,style:shadowStyle}),react.createElement("line",{x1:viewportStartX,y1:viewportStartY,x2:viewportEndX,y2:viewportStartY,style:lineStyle})),viewportStartX&&sideShadowHeight>0&&react.createElement("g",null,react.createElement("rect",{onClick:onClick,onMouseDown:stopPropagation,onPointerDown:stopPropagation,x:0,y:viewportStartY,height:sideShadowHeight,width:viewportStartX,style:shadowStyle}),react.createElement("line",{x1:viewportStartX,y1:viewportStartY,x2:viewportStartX,y2:viewportEndY,style:lineStyle})),rightShadowWidth&&sideShadowHeight>0&&react.createElement("g",null,react.createElement("rect",{onClick:onClick,onMouseDown:stopPropagation,onPointerDown:stopPropagation,x:viewportEndX,y:viewportStartY,height:sideShadowHeight,width:rightShadowWidth,style:shadowStyle}),react.createElement("line",{x1:viewportEndX,y1:viewportStartY,x2:viewportEndX,y2:viewportEndY,style:lineStyle})),bottomShadowHeight>0&&react.createElement("g",null,react.createElement("rect",{onClick:onClick,onMouseDown:stopPropagation,onPointerDown:stopPropagation,x:0,y:viewportEndY,height:bottomShadowHeight,width:rect.width,style:shadowStyle}),react.createElement("line",{x1:viewportStartX,y1:viewportEndY,x2:viewportEndX,y2:viewportEndY,style:lineStyle})))};try{Shadow_MiniMapShadow.displayName="MiniMapShadow",Shadow_MiniMapShadow.__docgenInfo={description:"",displayName:"MiniMapShadow",props:{containerRect:{defaultValue:null,description:"",name:"containerRect",required:!0,type:{name:"ClientRect | DOMRect | null | undefined"}},viewport:{defaultValue:null,description:"",name:"viewport",required:!0,type:{name:"IRect"}},shadowPadding:{defaultValue:{value:"0"},description:"",name:"shadowPadding",required:!1,type:{name:"number"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"MouseEventHandler<SVGRectElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Minimap/Shadow.tsx#MiniMapShadow"]={docgenInfo:Shadow_MiniMapShadow.__docgenInfo,name:"MiniMapShadow",path:"src/components/Minimap/Shadow.tsx#MiniMapShadow"})}catch(__react_docgen_typescript_loader_error){}var Minimap_Minimap=function Minimap(props){var _a=props.shadowPadding,shadowPadding=void 0===_a?0:_a,_b=props.maxNodesCountAllowed,maxNodesCountAllowed=void 0===_b?150:_b,_c=props.onRenderUnavailable,onRenderUnavailable=void 0===_c?function(){return null}:_c,_d=props.renderArrow,renderArrow=void 0===_d?function(arrowDeg){}:_d,graphViewport=useViewport(),graphController=useGraphController(),theme=useTheme_useTheme().theme,data=function useGraphData(){return Object(react.useContext)(GraphValueContext)}(),minimapContainerStyle=Object(tslib_es6.a)({background:theme.minimapBackground},props.style),svgRef=react.useRef(null),graphConfig=useGraphConfig(),rect=function useMinimapRect(svgRef){var _a=Object(react.useState)(void 0),rect=_a[0],setRect=_a[1];return Object(react.useLayoutEffect)((function(){setRect(getMinimapRect(svgRef))}),[svgRef]),Object(react.useEffect)((function(){var onResize=throttle((function(){setRect(getMinimapRect(svgRef))}),20);return window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[svgRef]),rect}(svgRef),rectRef=useRefValue(rect),minimapTransformMatrix=react.useMemo((function(){return rect?viewport_getZoomFitMatrix({data:data,rect:rect,graphConfig:graphConfig,nodeMaxVisibleSize:{width:0,height:0},nodeMinVisibleSize:{width:1/0,height:1/0}}):EMPTY_TRANSFORM_MATRIX}),[rect,data.nodes]),minimapTransformMatrixRef=useRefValue(minimapTransformMatrix),viewport=react.useMemo((function(){if(!rect||!isViewportComplete(graphViewport))return{startX:0,startY:0,endX:0,endY:0};var boundaryPoints=viewport_getVisibleArea(graphViewport),_a=transformPoint(boundaryPoints.minX,boundaryPoints.minY,minimapTransformMatrix),startX=_a.x,startY=_a.y,_b=transformPoint(boundaryPoints.maxX,boundaryPoints.maxY,minimapTransformMatrix);return{startX:startX,startY:startY,endX:_b.x,endY:_b.y}}),Object(tslib_es6.f)([rect,minimapTransformMatrix,graphViewport.rect],graphViewport.transformMatrix)),onClick=react.useCallback((function(evt){if(evt.stopPropagation(),rect){var viewportWidth=viewport.endX-viewport.startX,viewportHeight=viewport.endY-viewport.startY,point=reverseTransformPoint(clamp(shadowPadding+viewportWidth/2,rect.width-shadowPadding-viewportWidth/2,evt.clientX-rect.left),clamp(shadowPadding+viewportHeight/2,rect.height-shadowPadding-viewportHeight/2,evt.clientY-rect.top),minimapTransformMatrix);graphController.eventChannel.batch([{type:GraphCanvasEvent.ScrollIntoView,x:point.x,y:point.y},{type:GraphMinimapEvent.Click,rawEvent:evt}])}}),[rect]),onStartDrag=react.useCallback((function(evt,eventProvider){if(rectRef.current){var _a=rectRef.current,left=_a.left,top=_a.top,right=_a.right,bottom=_a.bottom,validMouseRect={startX:left+shadowPadding,startY:top+shadowPadding,endX:right-shadowPadding,endY:bottom-shadowPadding};graphController.eventChannel.trigger({type:GraphMinimapEvent.PanStart,rawEvent:evt});var drag=new DragController_DragController(eventProvider,(function(e){return{x:clamp(validMouseRect.startX,validMouseRect.endX,e.clientX),y:clamp(validMouseRect.startY,validMouseRect.endY,e.clientY)}}));drag.onMove=function(_a){var dx=_a.dx,dy=_a.dy,e=_a.e,_b=getPointDeltaByClientDelta(-dx,-dy,minimapTransformMatrixRef.current),x=_b.x,y=_b.y;graphController.eventChannel.trigger({type:GraphMinimapEvent.Pan,dx:x,dy:y,rawEvent:e})},drag.start(evt),drag.onEnd=function(){graphController.eventChannel.trigger({type:GraphMinimapEvent.PanEnd,rawEvent:evt})}}}),[shadowPadding]),arrowParams=react.useMemo((function(){if(!rect)return{showArrow:!1,arrowDeg:0};var showArrow=viewport.startX>rect.width-shadowPadding||viewport.startY>rect.height-shadowPadding||viewport.endX<shadowPadding||viewport.endY<shadowPadding,x0=rect.width/2,y0=rect.height/2,x1=(viewport.startX+viewport.endX)/2,y1=(viewport.startY+viewport.endY)/2,arrowDeg=180*Math.atan2(y1-y0,x1-x0)/Math.PI;return arrowDeg<0&&(arrowDeg+=360),{showArrow:showArrow,arrowDeg:arrowDeg}}),[rect,viewport,shadowPadding]),onMouseDown=react.useCallback((function(evt){onStartDrag(evt.nativeEvent,new MouseMoveEventProvider(graphController.getGlobalEventTarget()))}),[onStartDrag]),touchController=react.useMemo((function(){var handlers=new Map,touchDragAdapter=new TouchDragAdapter_TouchDragAdapter;return touchDragAdapter.on("start",(function(e){onStartDrag(e,touchDragAdapter)})),handlers.set(1,touchDragAdapter),new TouchController_TouchController(handlers)}),[onStartDrag,rect]),staticGraphEl=react.useMemo((function(){return react.createElement(StaticGraph_StaticGraph,{data:data,transformMatrix:minimapTransformMatrix})}),Object(tslib_es6.f)([data.nodes],minimapTransformMatrix));return data.nodes.size>maxNodesCountAllowed?react.createElement("div",{className:"minimap-container",style:minimapContainerStyle},onRenderUnavailable()):react.createElement("div",{className:"minimap-container "+components_Graph_styles_m.minimap,style:minimapContainerStyle},staticGraphEl,react.createElement("svg",Object(tslib_es6.a)({className:components_Graph_styles_m.minimapSvg},touchController.eventHandlers,{onMouseDown:onMouseDown,ref:svgRef,"data-automation-id":"minimap-id"}),react.createElement(Shadow_MiniMapShadow,{containerRect:rect,viewport:viewport,shadowPadding:shadowPadding,onClick:onClick})),arrowParams.showArrow&&renderArrow(arrowParams.arrowDeg))};try{Minimap_Minimap.displayName="Minimap",Minimap_Minimap.__docgenInfo={description:"",displayName:"Minimap",props:{style:{defaultValue:null,description:"Custom styling for the minimap",name:"style",required:!1,type:{name:"CSSProperties"}},shadowPadding:{defaultValue:{value:"0"},description:"The padding of the minimap viewport",name:"shadowPadding",required:!1,type:{name:"number"}},maxNodesCountAllowed:{defaultValue:{value:"150"},description:"The max nodes counts allowed to show in the minimap",name:"maxNodesCountAllowed",required:!1,type:{name:"number"}},onRenderUnavailable:{defaultValue:{value:"() => null"},description:"The renderer when exceed the max node counts",name:"onRenderUnavailable",required:!1,type:{name:"(() => ReactNode)"}},renderArrow:{defaultValue:null,description:"The renderer to point the graph position when the graph is out of the viewport\n@param arrowDeg",name:"renderArrow",required:!1,type:{name:"((arrowDeg: number) => ReactNode)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Minimap/Minimap.tsx#Minimap"]={docgenInfo:Minimap_Minimap.__docgenInfo,name:"Minimap",path:"src/components/Minimap/Minimap.tsx#Minimap"})}catch(__react_docgen_typescript_loader_error){}var ContextMenu_ContextMenu=function ContextMenu(props){var theme=useTheme_useTheme().theme,classes=Object(mergeStyleSets.a)({contextMenu:{fontSize:14,background:theme.contextMenuBackground,color:theme.fontColor,border:"1px solid "+theme.contextMenuBorder,width:193,lineHeight:"20px",cursor:"default","> *":{padding:8,":hover":{background:theme.contextMenuHoverBackground}}}}),propsMerged=Object(tslib_es6.a)(Object(tslib_es6.a)({},props),{className:classes.contextMenu+" "+props.className});return useContextMenuConfigContext_useContextMenuConfigContext().registerContextMenu(propsMerged),react.createElement("div",null,props.children)};try{ContextMenu_ContextMenu.displayName="ContextMenu",ContextMenu_ContextMenu.__docgenInfo={description:"",displayName:"ContextMenu",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/ContextMenu.tsx#ContextMenu"]={docgenInfo:ContextMenu_ContextMenu.__docgenInfo,name:"ContextMenu",path:"src/components/RegisterComponent/ContextMenu/ContextMenu.tsx#ContextMenu"})}catch(__react_docgen_typescript_loader_error){}var NodeMenu_NodeMenu=function NodeMenu(props){return useContextMenuConfigContext_useContextMenuConfigContext().registerMenu(props.children,MenuType.Node),null};try{NodeMenu_NodeMenu.displayName="NodeMenu",NodeMenu_NodeMenu.__docgenInfo={description:"",displayName:"NodeMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/NodeMenu.tsx#NodeMenu"]={docgenInfo:NodeMenu_NodeMenu.__docgenInfo,name:"NodeMenu",path:"src/components/RegisterComponent/ContextMenu/NodeMenu.tsx#NodeMenu"})}catch(__react_docgen_typescript_loader_error){}var EdgeMenu_EdgeMenu=function EdgeMenu(props){return useContextMenuConfigContext_useContextMenuConfigContext().registerMenu(props.children,MenuType.Edge),null};try{EdgeMenu_EdgeMenu.displayName="EdgeMenu",EdgeMenu_EdgeMenu.__docgenInfo={description:"",displayName:"EdgeMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/EdgeMenu.tsx#EdgeMenu"]={docgenInfo:EdgeMenu_EdgeMenu.__docgenInfo,name:"EdgeMenu",path:"src/components/RegisterComponent/ContextMenu/EdgeMenu.tsx#EdgeMenu"})}catch(__react_docgen_typescript_loader_error){}var PortMenu_PortMenu=function PortMenu(props){return useContextMenuConfigContext_useContextMenuConfigContext().registerMenu(props.children,MenuType.Port),null};try{PortMenu_PortMenu.displayName="PortMenu",PortMenu_PortMenu.__docgenInfo={description:"",displayName:"PortMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/PortMenu.tsx#PortMenu"]={docgenInfo:PortMenu_PortMenu.__docgenInfo,name:"PortMenu",path:"src/components/RegisterComponent/ContextMenu/PortMenu.tsx#PortMenu"})}catch(__react_docgen_typescript_loader_error){}var CanvasMenu_CanvasMenu=function CanvasMenu(props){return useContextMenuConfigContext_useContextMenuConfigContext().registerMenu(props.children,MenuType.Canvas),null};try{CanvasMenu_CanvasMenu.displayName="CanvasMenu",CanvasMenu_CanvasMenu.__docgenInfo={description:"",displayName:"CanvasMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/CanvasMenu.tsx#CanvasMenu"]={docgenInfo:CanvasMenu_CanvasMenu.__docgenInfo,name:"CanvasMenu",path:"src/components/RegisterComponent/ContextMenu/CanvasMenu.tsx#CanvasMenu"})}catch(__react_docgen_typescript_loader_error){}var MultiMenu_MultiMenu=function MultiMenu(props){return useContextMenuConfigContext_useContextMenuConfigContext().registerMenu(props.children,MenuType.Multi),null};try{MultiMenu_MultiMenu.displayName="MultiMenu",MultiMenu_MultiMenu.__docgenInfo={description:"",displayName:"MultiMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/RegisterComponent/ContextMenu/MultiMenu.tsx#MultiMenu"]={docgenInfo:MultiMenu_MultiMenu.__docgenInfo,name:"MultiMenu",path:"src/components/RegisterComponent/ContextMenu/MultiMenu.tsx#MultiMenu"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__(64),function(){function TestAPI(adapter){this.adapter=adapter}TestAPI.prototype.getNodesCount=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.selectAll("g[data-automation-id*='node-container-']")];case 1:return[2,_a.sent().length]}}))}))},TestAPI.prototype.getEdgesCount=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.selectAll("g[data-automation-id*='edge-container-']")];case 1:return[2,_a.sent().length]}}))}))},TestAPI.prototype.addNodeFromItemPanel=function(options){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var addColumnsModuleInPanelElPos,canvasBBOx;return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.getCentralPosBySelector(options.itemSelector)];case 1:return addColumnsModuleInPanelElPos=_a.sent(),[4,this.adapter.mouseMove(addColumnsModuleInPanelElPos.x,addColumnsModuleInPanelElPos.y)];case 2:return _a.sent(),[4,this.adapter.mouseDown()];case 3:return _a.sent(),[4,this.getCanvasBoundingBox()];case 4:return canvasBBOx=_a.sent(),[4,this.adapter.mouseMove(canvasBBOx.x+options.x,canvasBBOx.y+options.y)];case 5:return _a.sent(),[4,this.adapter.mouseUp()];case 6:return _a.sent(),[2]}}))}))},TestAPI.prototype.connectTwoNodes=function(_a){var sourceNodeName=_a.sourceNodeName,sourcePortName=_a.sourcePortName,targetNodeName=_a.targetNodeName,targetPortName=_a.targetPortName;return Object(tslib_es6.b)(this,void 0,void 0,(function(){var sourcePos,targetPos;return Object(tslib_es6.d)(this,(function(_b){switch(_b.label){case 0:return[4,this.getCentralPosBySelector(this.getPortCssSelector(sourceNodeName,sourcePortName))];case 1:return sourcePos=_b.sent(),[4,this.adapter.mouseMove(sourcePos.x,sourcePos.y)];case 2:return _b.sent(),[4,this.adapter.mouseDown()];case 3:return _b.sent(),[4,this.getCentralPosBySelector(this.getPortCssSelector(targetNodeName,targetPortName))];case 4:return targetPos=_b.sent(),[4,this.adapter.mouseMove(targetPos.x,targetPos.y)];case 5:return _b.sent(),[4,this.adapter.mouseUp()];case 6:return _b.sent(),[2]}}))}))},TestAPI.prototype.draggingNode=function(nodeName,toPosition){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var nodeCenterPos,canvasBBOx;return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.getCentralPosBySelector(this.getNodeCssSelector(nodeName))];case 1:return nodeCenterPos=_a.sent(),[4,this.adapter.mouseMove(nodeCenterPos.x,nodeCenterPos.y)];case 2:return _a.sent(),[4,this.adapter.mouseDown()];case 3:return _a.sent(),[4,this.getCanvasBoundingBox()];case 4:return canvasBBOx=_a.sent(),[4,this.adapter.mouseMove(toPosition.x+canvasBBOx.x,toPosition.y+canvasBBOx.y)];case 5:return _a.sent(),[2]}}))}))},TestAPI.prototype.rightClickOnNode=function(nodeName){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.rightClick(this.getNodeCssSelector(nodeName))];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.clickOnNode=function(nodeName){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.click(this.getNodeCssSelector(nodeName))];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.hoverOnNode=function(nodeName){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.hover(this.getNodeCssSelector(nodeName))];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.hoverOnPort=function(nodeName,portName){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.hover(this.getPortCssSelector(nodeName,portName))];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.hoverOnEdge=function(edgeId){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.hover(this.getEdgeCssSelector(edgeId))];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.getAutoAlignHintLineCount=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.selectAll("line.auto-align-hint")];case 1:return[2,_a.sent().length]}}))}))},TestAPI.prototype.clickOnNodesWithCtrlKey=function(nodeNames){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var _i,nodeNames_1,name_1;return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.keyDown("Control")];case 1:_a.sent(),_i=0,nodeNames_1=nodeNames,_a.label=2;case 2:return _i<nodeNames_1.length?(name_1=nodeNames_1[_i],[4,this.clickOnNode(name_1)]):[3,5];case 3:_a.sent(),_a.label=4;case 4:return _i++,[3,2];case 5:return[4,this.adapter.keyUp("Control")];case 6:return _a.sent(),[2]}}))}))},TestAPI.prototype.rightClickOnCanvas=function(x,y){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.rightClick("svg.react-dag-editor-svg-container",{position:{x:x,y:y}})];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.selectArea=function(start,end){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.mouseMove(start.x,start.y)];case 1:return _a.sent(),[4,this.adapter.mouseDown()];case 2:return _a.sent(),[4,this.adapter.mouseMove(end.x,end.y)];case 3:return _a.sent(),[4,this.adapter.mouseUp()];case 4:return _a.sent(),[2]}}))}))},TestAPI.prototype.connectWithKeyboard=function(isCancelConnect){return void 0===isCancelConnect&&(isCancelConnect=!1),Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:case 2:case 3:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 4:return _a.sent(),[4,this.adapter.keyDown("Alt")];case 5:return _a.sent(),[4,this.adapter.keyPress("c")];case 6:return _a.sent(),[4,this.adapter.keyUp("Alt")];case 7:case 8:case 9:case 10:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 11:return _a.sent(),isCancelConnect?[4,this.adapter.keyPress("Escape")]:[3,13];case 12:return _a.sent(),[3,15];case 13:return[4,this.adapter.keyPress("Enter")];case 14:_a.sent(),_a.label=15;case 15:return[2]}}))}))},TestAPI.prototype.navigateAroundNodesWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 2:case 3:return _a.sent(),[4,this.adapter.keyPress("ArrowDown")];case 4:return _a.sent(),[4,this.adapter.keyPress("ArrowRight")];case 5:return _a.sent(),[4,this.adapter.keyPress("ArrowLeft")];case 6:return _a.sent(),[2]}}))}))},TestAPI.prototype.navigateBackWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:case 2:case 3:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 4:return _a.sent(),[4,this.adapter.keyDown("Shift")];case 5:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 6:return _a.sent(),[4,this.adapter.keyUp("Shift")];case 7:return _a.sent(),[2]}}))}))},TestAPI.prototype.navigateAroundPortsWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 2:return _a.sent(),[4,this.adapter.keyPress("ArrowDown")];case 3:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 4:case 5:return _a.sent(),[4,this.adapter.keyPress("ArrowDown")];case 6:return _a.sent(),[2]}}))}))},TestAPI.prototype.goToConnectedPortWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 2:return _a.sent(),[4,this.adapter.keyPress("ArrowDown")];case 3:case 4:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 5:return _a.sent(),[4,this.adapter.keyDown("Alt")];case 6:return _a.sent(),[4,this.adapter.keyPress("g")];case 7:return _a.sent(),[4,this.adapter.keyUp("Alt")];case 8:return _a.sent(),[2]}}))}))},TestAPI.prototype.deleteNodeWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.focusOnCanvasWithKeyboard()];case 1:return _a.sent(),[4,this.adapter.keyPress("Tab")];case 2:return _a.sent(),[4,this.adapter.keyPress("ArrowDown")];case 3:return _a.sent(),[4,this.adapter.keyPress("Delete")];case 4:return _a.sent(),[2]}}))}))},TestAPI.prototype.panCanvas=function(from,to){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.mouseMove(from.x,from.y)];case 1:return _a.sent(),[4,this.adapter.mouseDown()];case 2:return _a.sent(),[4,this.adapter.mouseMove(to.x,to.y)];case 3:return _a.sent(),[4,this.adapter.mouseUp()];case 4:return _a.sent(),[2]}}))}))},TestAPI.prototype.getElementBoundingBox=function(cssSelector){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var _a,_b,x,_c,y,_d,height,_e;return Object(tslib_es6.d)(this,(function(_f){switch(_f.label){case 0:return[4,this.adapter.waitForSelector(cssSelector)];case 1:return[4,_f.sent().boundingBox()];case 2:return _a=_f.sent()||{},_b=_a.x,x=void 0===_b?0:_b,_c=_a.y,y=void 0===_c?0:_c,_d=_a.height,height=void 0===_d?0:_d,_e=_a.width,[2,{x:x,y:y,width:void 0===_e?0:_e,height:height}]}}))}))},TestAPI.prototype.getCanvasBoundingBox=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getElementBoundingBox("svg.react-dag-editor-svg-container")]}))}))},TestAPI.prototype.getMinimapBoundingBox=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var _a,x,y,height,width;return Object(tslib_es6.d)(this,(function(_b){switch(_b.label){case 0:return[4,this.getElementBoundingBox("svg[data-automation-id*='minimap-id']")];case 1:return _a=_b.sent(),x=_a.x,y=_a.y,height=_a.height,width=_a.width,[2,{x:x,y:y,width:width,height:height}]}}))}))},TestAPI.prototype.dragOnItem=function(start,end){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.selectArea(start,end)];case 1:return _a.sent(),[2]}}))}))},TestAPI.prototype.getNodeCentralPosition=function(nodeName){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.getCentralPosBySelector(this.getNodeCssSelector(nodeName))];case 1:return[2,_a.sent()]}}))}))},TestAPI.prototype.getNodes=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getDomElements("g[data-automation-id*='node-container-']")]}))}))},TestAPI.prototype.getEdges=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getDomElements("g[data-automation-id*='edge-container-']")]}))}))},TestAPI.prototype.getPorts=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getDomElements("g[aria-roledescription='port']")]}))}))},TestAPI.prototype.getNodeTooltips=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getDomElements(".node-tooltips")]}))}))},TestAPI.prototype.getPortTooltips=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){return[2,this.getDomElements(".port-tooltips")]}))}))},TestAPI.prototype.composeGraph=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var nodes,edges,ports,nodeTooltips,portTooltips;return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.getNodes()];case 1:return nodes=_a.sent(),[4,this.getEdges()];case 2:return edges=_a.sent(),[4,this.getPorts()];case 3:return ports=_a.sent(),[4,this.getNodeTooltips()];case 4:return nodeTooltips=_a.sent(),[4,this.getPortTooltips()];case 5:return portTooltips=_a.sent(),[2,{nodes:nodes,edges:edges,ports:ports,nodeTooltips:nodeTooltips,portTooltips:portTooltips}]}}))}))},TestAPI.prototype.getCentralPosBySelector=function(cssSelector){return Object(tslib_es6.b)(this,void 0,void 0,(function(){var _a;return Object(tslib_es6.d)(this,(function(_b){switch(_b.label){case 0:return _a=this.getCentralPosByBBox,[4,this.getElementBoundingBox(cssSelector)];case 1:return[2,_a.apply(this,[_b.sent()])]}}))}))},TestAPI.prototype.getDomElements=function(selector){var _a;return Object(tslib_es6.b)(this,void 0,void 0,(function(){var _b,_c,_this=this;return Object(tslib_es6.d)(this,(function(_d){switch(_d.label){case 0:return _c=(_b=Promise).all,[4,this.adapter.selectAll(selector)];case 1:return[2,_c.apply(_b,[null===(_a=_d.sent())||void 0===_a?void 0:_a.map((function(handle){return Object(tslib_es6.b)(_this,void 0,void 0,(function(){var bbox,className,innerHTML,textContent,ariaLabel,automationId;return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,handle.boundingBox()];case 1:return bbox=_a.sent(),[4,handle.getAttribute("class")];case 2:return className=_a.sent(),[4,handle.innerHTML()];case 3:return innerHTML=_a.sent(),[4,handle.textContent()];case 4:return textContent=_a.sent(),[4,handle.getAttribute("aria-label")];case 5:return ariaLabel=_a.sent(),[4,handle.getAttribute("data-automation-id")];case 6:return automationId=_a.sent(),[2,{bbox:bbox,textContent:textContent,className:className,innerHTML:innerHTML,ariaLabel:ariaLabel,automationId:automationId}]}}))}))}))])]}}))}))},TestAPI.prototype.getCentralPosByBBox=function(bbox){return bbox?{x:bbox.width/2+bbox.x,y:bbox.height/2+bbox.y}:{x:0,y:0}},TestAPI.prototype.getPortCssSelector=function(nodeName,portName){return"g[data-automation-id*='"+nodeName+"'][data-automation-id*='"+portName+"'][data-automation-id*='port-']"},TestAPI.prototype.getNodeCssSelector=function(nodeName){return"g[data-automation-id*='node-container-'][data-automation-id*='"+nodeName+"']"},TestAPI.prototype.getEdgeCssSelector=function(edgeId){return"g[data-automation-id*='edge-container-"+edgeId+"']"},TestAPI.prototype.focusOnCanvasWithKeyboard=function(){return Object(tslib_es6.b)(this,void 0,void 0,(function(){return Object(tslib_es6.d)(this,(function(_a){switch(_a.label){case 0:return[4,this.adapter.keyDown("Alt")];case 1:return _a.sent(),[4,this.adapter.keyDown("Shift")];case 2:return _a.sent(),[4,this.adapter.keyPress("f")];case 3:return _a.sent(),[4,this.adapter.keyUp("Alt")];case 4:return _a.sent(),[4,this.adapter.keyUp("Shift")];case 5:return _a.sent(),[2]}}))}))}}(),__webpack_require__(424);function composeReducers(reducers){return function(next){return reducers.reduceRight((function(prev,current){return current(prev)}),next)}}function attachPort(state,nodeId,portId){if(!state.connectState)return state;var data=state.data.present;return data=data.updatePort(nodeId,portId,state_updateState(addState(GraphPortState.connectingAsTarget))),state.connectState.targetNode&&state.connectState.targetPort&&(data=data.updatePort(state.connectState.targetNode,state.connectState.targetPort,state_updateState(removeState(GraphPortState.connectingAsTarget)))),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.connectState),{targetNode:nodeId,targetPort:portId}),data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data})})}function clearAttach(state){if(!state.connectState)return state;var data=state.data.present,_a=state.connectState,targetPort=_a.targetPort,targetNode=_a.targetNode;return targetNode&&targetPort&&(data=data.updatePort(targetNode,targetPort,state_updateState(removeState(GraphPortState.connectingAsTarget)))),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.connectState),{targetNode:void 0,targetPort:void 0}),data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data})})}function pipe(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return args.reduceRight((function(result,current){return function(value){return result(current(value))}}),identical)}var getDelta=function getDelta(start,end,value){return value<start?-10:value>end?10:0};function getSelectedNodes(data,graphConfig){var nodes=[];return data.nodes.forEach((function(node){state_isSelected(node)&&nodes.push(Object(tslib_es6.a)({id:node.id,x:node.x,y:node.y},getNodeSize(node,graphConfig)))})),nodes}var updateNodeBySelectBox_selectNodeBySelectBox=function selectNodeBySelectBox(graphConfig,transformMatrix,selectBox,data){if(!selectBox.width||!selectBox.height)return data;var selectAreaMinX=Math.min(selectBox.startX,selectBox.startX+selectBox.width),selectAreaMaxX=Math.max(selectBox.startX,selectBox.startX+selectBox.width),selectAreaMinY=Math.min(selectBox.startY,selectBox.startY+selectBox.height),selectAreaMaxY=Math.max(selectBox.startY,selectBox.startY+selectBox.height),primeSelectionMin=reverseTransformPoint(selectAreaMinX,selectAreaMinY,transformMatrix),primeSelectionMax=reverseTransformPoint(selectAreaMaxX,selectAreaMaxY,transformMatrix),primeRectSelectionBox={minX:primeSelectionMin.x,minY:primeSelectionMin.y,maxX:primeSelectionMax.x,maxY:primeSelectionMax.y};return data.selectNodes((function(n){var _a=getNodeSize(n,graphConfig),width=_a.width,height=_a.height,rectNode={minX:n.x,minY:n.y,maxX:n.x+width,maxY:n.y+height};return function checkRectIntersect(rectA,rectB){var isALeftOfB=rectA.maxX<rectB.minX,isARightOfB=rectA.minX>rectB.maxX,isABelowB=rectA.minY>rectB.maxY,isAAboveB=rectA.maxY<rectB.minY;return!(isALeftOfB||isARightOfB||isABelowB||isAAboveB)}(primeRectSelectionBox,rectNode)}))};function getRectCenter(rect){return{x:rect.width/2,y:rect.height/2}}var viewportReducer_reducer=function reducer(viewport,action,data,settings){var _a,_b,_c,_d,graphConfig=settings.graphConfig,canvasBoundaryPadding=settings.canvasBoundaryPadding,features=settings.features,limitScale=function limitScale(scale){return Math.max(scale,getScaleLimit(data,settings))};switch(action.type){case GraphCanvasEvent.ViewportResize:return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{rect:action.viewportRect});case GraphCanvasEvent.Zoom:return isViewportComplete(viewport)?viewport_zoom({scale:action.scale,anchor:null!==(_a=action.anchor)&&void 0!==_a?_a:getRectCenter(viewport.rect),direction:action.direction,limitScale:limitScale})(viewport):viewport;case GraphScrollBarEvent.Scroll:case GraphCanvasEvent.MouseWheelScroll:case GraphCanvasEvent.Pan:case GraphCanvasEvent.Drag:if(!isViewportComplete(viewport))return viewport;var transformMatrix=viewport.transformMatrix,rect=viewport.rect,dx=action.dx,dy=action.dy,limitBoundary=features.has(GraphFeatures.limitBoundary),groupPadding=null===(_c=null===(_b=data.groups)||void 0===_b?void 0:_b[0])||void 0===_c?void 0:_c.padding;if(limitBoundary){var _e=getOffsetLimit_getOffsetLimit({data:data,graphConfig:graphConfig,rect:rect,transformMatrix:transformMatrix,canvasBoundaryPadding:canvasBoundaryPadding,groupPadding:groupPadding}),minX=_e.minX,maxX=_e.maxX,minY=_e.minY,maxY=_e.maxY;dx=clamp(minX-transformMatrix[4],maxX-transformMatrix[4],dx),dy=clamp(minY-transformMatrix[5],maxY-transformMatrix[5],dy)}return viewport_pan(dx,dy)(viewport);case GraphCanvasEvent.Pinch:dx=action.dx,dy=action.dy;var scale=action.scale,anchor=action.anchor;return pipe(viewport_pan(dx,dy),viewport_zoom({scale:scale,anchor:anchor,limitScale:limitScale}))(viewport);case GraphMinimapEvent.Pan:return function minimapPan(dx,dy){return 0===dx&&0===dy?identical:function(prevState){var _a=prevState.transformMatrix,a=_a[0],b=_a[1],c=_a[2],d=_a[3];return Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{transformMatrix:[a,b,c,d,prevState.transformMatrix[4]+a*dx+b*dy,prevState.transformMatrix[5]+c*dx+d*dy]})}}(action.dx,action.dy)(viewport);case GraphCanvasEvent.ResetViewport:return function resetViewport(viewport,data,graphConfig,action){if(!isViewportComplete(viewport))return viewport;if(!action.ensureNodeVisible)return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:EMPTY_TRANSFORM_MATRIX});var nodes=data.nodes,groups=data.groups;if(0===nodes.size)return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:EMPTY_TRANSFORM_MATRIX});var isShapeRectInViewport=function isShapeRectInViewport(r){return isRectVisible(r,viewport)},nodeRects=nodes.map((function(n){return viewport_getNodeRect(n,graphConfig)}));if(nodeRects.find(isShapeRectInViewport))return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:EMPTY_TRANSFORM_MATRIX});var groupRects=groups.map((function(g){return getGroupRect(g,nodes,graphConfig)}));if(groupRects.find(isShapeRectInViewport))return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:EMPTY_TRANSFORM_MATRIX});var focusNode=nodeRects.first(),findTopMostRect=function findTopMostRect(cur){focusNode.y>cur.y&&(focusNode=cur)};return nodeRects.forEach(findTopMostRect),groupRects.forEach(findTopMostRect),Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:[1,0,0,1,-focusNode.x,-focusNode.y]})}(viewport,data,graphConfig,action);case GraphCanvasEvent.ZoomTo:return isViewportComplete(viewport)?viewport_zoomTo({scale:action.scale,anchor:null!==(_d=action.anchor)&&void 0!==_d?_d:getRectCenter(viewport.rect),direction:action.direction,limitScale:limitScale})(viewport):viewport;case GraphCanvasEvent.ZoomToFit:return function zoomToFit(viewport,data,settings,action){if(!isViewportComplete(viewport))return viewport;var graphConfig=settings.graphConfig,nodeMaxVisibleSize=settings.nodeMaxVisibleSize,nodeMinVisibleSize=settings.nodeMinVisibleSize,transformMatrix=viewport_getZoomFitMatrix(Object(tslib_es6.a)(Object(tslib_es6.a)({},action),{data:data,graphConfig:graphConfig,rect:viewport.rect,nodeMaxVisibleSize:nodeMaxVisibleSize,nodeMinVisibleSize:nodeMinVisibleSize}));return Object(tslib_es6.a)(Object(tslib_es6.a)({},viewport),{transformMatrix:transformMatrix})}(viewport,data,settings,action);case GraphCanvasEvent.ScrollIntoView:if(viewport.rect){var _f=transformPoint(action.x,action.y,viewport.transformMatrix),x=_f.x,y=_f.y;return viewport_scrollIntoView(x,y,viewport.rect,!0)(viewport)}return viewport;default:return viewport}},builtinReducer=composeReducers([function behaviorReducer(prevState,action){var nextBehavior=behaviorReducer_handleBehaviorChange(prevState.behavior,action);return nextBehavior===prevState.behavior?prevState:Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{behavior:nextBehavior})},function viewportReducer(state,action){var viewport=viewportReducer_reducer(state.viewport,action,state.data.present,state.settings);return viewport===state.viewport?state:Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{viewport:viewport})},function nodeReducer(state,action){var data=state.data.present;switch(action.type){case GraphNodeEvent.ResizingStart:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{dummyNodes:Object(tslib_es6.a)(Object(tslib_es6.a)({},{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1}),{isVisible:!0,nodes:getSelectedNodes(data,state.settings.graphConfig)})});case GraphNodeEvent.Resizing:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{dummyNodes:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.dummyNodes),{dx:action.dx,dy:action.dy,dWidth:action.dWidth,dHeight:action.dHeight})});case GraphNodeEvent.ResizingEnd:var _a=state.dummyNodes,dx_1=_a.dx,dy_1=_a.dy,dWidth_1=_a.dWidth,dHeight_1=_a.dHeight;return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{dummyNodes:{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1},data:history_pushHistory(state.data,data.updateNodesPositionAndSize(state.dummyNodes.nodes.map((function(node){return Object(tslib_es6.a)(Object(tslib_es6.a)({},node),{x:node.x+dx_1,y:node.y+dy_1,width:node.width+dWidth_1,height:node.height+dHeight_1})}))),graphDataUtils_unSelectAllEntity())});case GraphNodeEvent.DragStart:return function dragStart(state,action){var selectedNodes,data=state.data.present,targetNode=data.nodes.get(action.node.id);return targetNode?(selectedNodes=action.isMultiSelect?getSelectedNodes(data=data.selectNodes((function(node){return node.id===action.node.id||state_isSelected(node)})),state.settings.graphConfig):state_isSelected(targetNode)?getSelectedNodes(data,state.settings.graphConfig):[Object(tslib_es6.a)({id:action.node.id,x:action.node.x,y:action.node.y},getNodeSize(action.node,state.settings.graphConfig))],Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data}),dummyNodes:Object(tslib_es6.a)(Object(tslib_es6.a)({},{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1}),{isVisible:!1,nodes:selectedNodes})})):state}(state,action);case GraphNodeEvent.Drag:return function dragNodeHandler(state,event){if(!isViewportComplete(state.viewport))return state;var e=event.rawEvent,rect=state.viewport.rect,nextState=Object(tslib_es6.a)({},state),data=state.data.present,viewportDx=getDelta(rect.left,rect.right,e.clientX),viewportDy=getDelta(rect.top,rect.bottom,e.clientY),scale=0!==viewportDx||0!==viewportDy?.999:1,viewport=0!==viewportDx||0!==viewportDx?pipe(viewport_pan(-viewportDx,-viewportDy),viewport_zoom({scale:scale,anchor:getRelativePoint(rect,e),direction:Direction.XY,limitScale:function limitScale(scale){return Math.max(scale,getScaleLimit(data,state.settings))}}))(state.viewport):state.viewport,delta=getPointDeltaByClientDelta(event.dx+viewportDx*scale,event.dy+viewportDy*scale,viewport.transformMatrix),dummyNodes=Object(tslib_es6.a)(Object(tslib_es6.a)({},state.dummyNodes),{dx:state.dummyNodes.dx+delta.x,dy:state.dummyNodes.dy+delta.y,isVisible:event.isVisible});if(event.isAutoAlignEnable){var renderedNodes=getRenderedNodes(data.nodes,state.viewport);if(renderedNodes.length<event.autoAlignThreshold){var nodes=dummyNodes.nodes.map((function(it){return Object(tslib_es6.a)(Object(tslib_es6.a)({},it),{x:it.x+dummyNodes.dx,y:it.y+dummyNodes.dy})})),alignmentLines=getAlignmentLines(nodes,renderedNodes,state.settings.graphConfig,state.viewport.transformMatrix[0]>.3?2:5);if(alignmentLines.length){var dxAligned=getAutoAlignDisplacement(alignmentLines,nodes,state.settings.graphConfig,"x"),dyAligned=getAutoAlignDisplacement(alignmentLines,nodes,state.settings.graphConfig,"y");dummyNodes.alignedDX=dummyNodes.dx+dxAligned,dummyNodes.alignedDY=dummyNodes.dy+dyAligned}else dummyNodes.alignedDX=void 0,dummyNodes.alignedDY=void 0;nextState.alignmentLines=alignmentLines}else dummyNodes.alignedDX=void 0,dummyNodes.alignedDY=void 0}return nextState.dummyNodes=dummyNodes,nextState.viewport=viewport,nextState}(state,action);case GraphNodeEvent.DragEnd:return function dragEnd(state,action){var data=state.data.present;if(action.isDragCanceled)return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{alignmentLines:[],dummyNodes:{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1}});var _a=state.dummyNodes,dx=_a.dx,dy=_a.dy;return data=data.updateNodesPositionAndSize(state.dummyNodes.nodes.map((function(node){return Object(tslib_es6.a)(Object(tslib_es6.a)({},node),{x:node.x+dx,y:node.y+dy,width:void 0,height:void 0})}))),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{alignmentLines:[],dummyNodes:{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1},data:history_pushHistory(state.data,data,graphDataUtils_unSelectAllEntity())})}(state,action);case GraphNodeEvent.PointerEnter:switch(state.behavior){case GraphBehavior.default:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data.updateNode(action.node.id,state_updateState(addState(GraphNodeState.activated)))})});default:return state}case GraphNodeEvent.PointerLeave:switch(state.behavior){case GraphBehavior.default:case GraphBehavior.connecting:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data.updateNode(action.node.id,state_updateState(removeState(GraphNodeState.activated)))})});default:return state}case GraphCanvasEvent.DraggingNodeFromItemPanel:return function handleDraggingNewNode(state,action){if(!state.settings.features.has(GraphFeatures.autoAlign))return state;var data=state.data.present,renderedNodes=getRenderedNodes(data.nodes,state.viewport),alignmentLines=getAlignmentLines([action.node],renderedNodes,state.settings.graphConfig,state.viewport.transformMatrix[0]>.3?2:5);return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{alignmentLines:alignmentLines})}(state,action);case GraphCanvasEvent.DraggingNodeFromItemPanelEnd:return action.node?Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{alignmentLines:[],data:history_pushHistory(state.data,state.data.present.insertNode(Object(tslib_es6.a)(Object(tslib_es6.a)({},action.node),{state:GraphNodeState.selected})),graphDataUtils_unSelectAllEntity())}):Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{alignmentLines:[]});case GraphNodeEvent.Centralize:case GraphNodeEvent.Locate:return function locateNode(action,state){var data=state.data.present;if(!isViewportComplete(state.viewport)||!action.nodes.length)return state;if(1===action.nodes.length){var nodeId=action.nodes[0],node=data.nodes.get(nodeId);if(!node)return state;var _a=getNodeSize(node,state.settings.graphConfig),width=_a.width,height=_a.height,nodeX=action.type===GraphNodeEvent.Centralize?node.x+width/2:node.x,nodeY=action.type===GraphNodeEvent.Centralize?node.y+height/2:node.y,_b=transformPoint(nodeX,nodeY,state.viewport.transformMatrix),clientX=_b.x,clientY=_b.y,position=action.type===GraphNodeEvent.Locate?action.position:void 0;return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{viewport:viewport_scrollIntoView(clientX,clientY,state.viewport.rect,!0,position)(state.viewport)})}var _c=viewport_getContentArea(data,state.settings.graphConfig,new Set(action.nodes)),minNodeX=_c.minNodeX,minNodeY=_c.minNodeY,maxNodeX=_c.maxNodeX,maxNodeY=_c.maxNodeY;return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{viewport:viewport_focusArea(minNodeX,minNodeY,maxNodeX,maxNodeY,state.viewport)})}(action,state);case GraphNodeEvent.Add:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:history_pushHistory(state.data,data.insertNode(action.node))});case GraphNodeEvent.DoubleClick:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updateNode(action.node.id,state_updateState(addState(GraphNodeState.editing)))})});default:return state}},function portReducer(state,action){switch(action.type){case GraphPortEvent.Focus:case GraphPortEvent.PointerEnter:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updatePort(action.node.id,action.port.id,state_updateState(addState(GraphPortState.activated)))})});case GraphPortEvent.Blur:case GraphPortEvent.PointerLeave:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updatePort(action.node.id,action.port.id,state_updateState(removeState(GraphPortState.activated)))})});case GraphPortEvent.Click:case GraphPortEvent.ContextMenu:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:graphDataUtils_unSelectAllEntity()(state.data.present).updatePort(action.node.id,action.port.id,state_updateState(addState(GraphPortState.selected)))})});default:return state}},function edgeReducer(state,action){switch(action.type){case GraphEdgeEvent.DoubleClick:return state.settings.features.has(GraphFeatures.editEdge)?Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updateEdge(action.edge.id,state_updateState(resetState(GraphEdgeState.editing)))})}):state;case GraphEdgeEvent.MouseEnter:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updateEdge(action.edge.id,state_updateState(addState(GraphEdgeState.activated)))})});case GraphEdgeEvent.MouseLeave:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updateEdge(action.edge.id,state_updateState(removeState(GraphEdgeState.activated)))})});case GraphEdgeEvent.Click:case GraphEdgeEvent.ContextMenu:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:graphDataUtils_unSelectAllEntity()(state.data.present).updateEdge(action.edge.id,state_updateState(addState(GraphEdgeState.selected)))})});case GraphEdgeEvent.Add:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:history_pushHistory(state.data,state.data.present.insertEdge(action.edge))});default:return state}},function canvasReducer(state,action){switch(action.type){case GraphCanvasEvent.Paste:var position=action.position;if(!isViewportComplete(state.viewport))return state;var rect=state.viewport.rect,pasteNodes=action.data.nodes;if(position&&rect){var dx_1,dy_1,realPoint_1=getRealPointFromClientPoint(position.x,position.y,state.viewport);pasteNodes=pasteNodes.map((function(n,idx){return 0===idx&&(dx_1=realPoint_1.x-n.x,dy_1=realPoint_1.y-n.y),Object(tslib_es6.a)(Object(tslib_es6.a)({},n),{x:dx_1?n.x-50+dx_1:n.x,y:dy_1?n.y-50+dy_1:n.y,state:GraphNodeState.selected})}))}var next_1=graphDataUtils_unSelectAllEntity()(state.data.present);return pasteNodes.forEach((function(node){next_1=next_1.insertNode(node)})),action.data.edges.forEach((function(edge){next_1=next_1.insertEdge(edge)})),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:history_pushHistory(state.data,next_1)});case GraphCanvasEvent.Delete:return state.settings.features.has(GraphFeatures.delete)?Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:history_pushHistory(state.data,state.data.present.deleteItems({node:state_notSelected,edge:state_notSelected}),graphDataUtils_unSelectAllEntity())}):state;case GraphCanvasEvent.Undo:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:undo(state.data)});case GraphCanvasEvent.Redo:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:redo(state.data)});case GraphCanvasEvent.KeyDown:var key=action.rawEvent.key.toLowerCase();return state.activeKeys.has(key)?state:((set=new Set(state.activeKeys)).add(key),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{activeKeys:set}));case GraphCanvasEvent.KeyUp:var set;key=action.rawEvent.key.toLowerCase();return state.activeKeys.has(key)?((set=new Set(state.activeKeys)).delete(key),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{activeKeys:set})):state;case GraphCanvasEvent.SetData:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:resetUndoStack(action.data)});case GraphCanvasEvent.UpdateData:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:action.shouldRecord?history_pushHistory(state.data,action.updater(state.data.present)):Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:action.updater(state.data.present)})});case GraphCanvasEvent.ResetUndoStack:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:resetUndoStack(state.data.present)});case GraphCanvasEvent.UpdateSettings:action.type;var settings=Object(tslib_es6.e)(action,["type"]);return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{settings:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.settings),settings)});default:return state}},function connectingReducer(state,action){var _a,_b,_c;if(!isViewportComplete(state.viewport))return state;var rect=state.viewport.rect;switch(action.type){case GraphEdgeEvent.ConnectStart:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:Object(tslib_es6.a)(Object(tslib_es6.a)({},EMPTY_CONNECT_STATE),{sourceNode:action.nodeId,sourcePort:action.portId,movingPoint:action.clientPoint?{x:action.clientPoint.x-rect.left,y:action.clientPoint.y-rect.top}:void 0}),data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:state.data.present.updatePort(action.nodeId,action.portId,state_updateState(addState(GraphPortState.connecting)))})});case GraphEdgeEvent.ConnectMove:return state.connectState?Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.connectState),{movingPoint:{x:action.clientX-rect.left,y:action.clientY-rect.top}})}):state;case GraphEdgeEvent.ConnectEnd:if(state.connectState){var edgeWillAdd=action.edgeWillAdd,isCancel=action.isCancel,_d=state.connectState,sourceNode=_d.sourceNode,sourcePort=_d.sourcePort,targetNode=_d.targetNode,targetPort=_d.targetPort;if(data=(data=state.data.present).updatePort(sourceNode,sourcePort,state_updateState(resetState(GraphPortState.default))),!isCancel&&targetNode&&targetPort){var edge={source:sourceNode,sourcePortId:sourcePort,target:targetNode,targetPortId:targetPort,id:Object(v4.a)(),shape:state.settings.graphConfig.defaultEdgeShape,state:GraphEdgeState.default};return edgeWillAdd&&(edge=edgeWillAdd(edge,data)),data=data.insertEdge(edge).updatePort(targetNode,targetPort,state_updateState(resetState(GraphPortState.default))),Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:void 0,data:history_pushHistory(state.data,data,graphDataUtils_unSelectAllEntity())})}return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{connectState:void 0,data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data})})}return state;case GraphEdgeEvent.ConnectNavigate:if(state.connectState){sourcePort=null==(sourceNode=(data=state.data.present).nodes.get(state.connectState.sourceNode))?void 0:sourceNode.getPort(state.connectState.sourcePort),targetNode=state.connectState.targetNode?data.nodes.get(state.connectState.targetNode):void 0,targetPort=state.connectState.targetPort?null==targetNode?void 0:targetNode.getPort(state.connectState.targetPort):void 0;if(!sourceNode||!sourcePort)return state;var next=function nextConnectablePort(graphConfig,params){return function(data,node,port){for(var _a,_b,_c,next=getNextItem(data,node,port);(null===(_a=next.node)||void 0===_a?void 0:_a.id)!==node.id||(null===(_b=next.port)||void 0===_b?void 0:_b.id)!==(null==port?void 0:port.id);){if(next.node){if(next.port){var portShape=next.port.shape?next.port.shape:graphConfig.defaultPortShape;if(null===(_c=graphConfig.getPortConfigByName(portShape))||void 0===_c?void 0:_c.getIsConnectable(Object(tslib_es6.a)(Object(tslib_es6.a)({},params),{data:data,parentNode:next.node,model:next.port})))return next}}else next=a11yUtils_item(data.getNavigationFirstNode());next=getNextItem(data,next.node,next.port)}return a11yUtils_item()}}(state.settings.graphConfig,{anotherNode:sourceNode,anotherPort:sourcePort})(data,targetNode||sourceNode,targetPort);return!next.node||!next.port||next.node.id===sourceNode.id&&next.port.id===sourcePort.id?state:attachPort(state,next.node.id,next.port.id)}return state;case GraphPortEvent.PointerEnter:if(state.connectState){var _e=state.connectState,port=(sourceNode=_e.sourceNode,sourcePort=_e.sourcePort,null==(node=(data=state.data.present).nodes.get(action.node.id))?void 0:node.getPort(action.port.id)),anotherPort=null==(anotherNode=data.nodes.get(sourceNode))?void 0:anotherNode.getPort(sourcePort);if(node&&port&&anotherNode&&anotherPort&&graphDataUtils_isConnectable(state.settings.graphConfig,{parentNode:node,model:port,data:data,anotherPort:anotherPort,anotherNode:anotherNode}))return attachPort(state,node.id,port.id)}return state;case GraphNodeEvent.PointerEnter:case GraphNodeEvent.PointerMove:if(state.connectState){var data,anotherNode,_f=action.rawEvent,clientX=_f.clientX,clientY=_f.clientY,_g=state.connectState,node=(sourceNode=_g.sourceNode,sourcePort=_g.sourcePort,(data=state.data.present).nodes.get(action.node.id));anotherPort=null==(anotherNode=data.nodes.get(sourceNode))?void 0:anotherNode.getPort(sourcePort);if(node&&anotherNode&&anotherPort)return(targetPort=function getNearestConnectablePort(params){var nearestPort,node=params.parentNode,clientX=params.clientX,clientY=params.clientY,graphConfig=params.graphConfig,viewport=params.viewport,minDistance=1/0;if(node.ports){var point=getRealPointFromClientPoint(clientX,clientY,viewport);return node.ports.forEach((function(port){if(graphDataUtils_isConnectable(graphConfig,Object(tslib_es6.a)(Object(tslib_es6.a)({},params),{model:port}))){var portPos=getPortPosition_getPortPositionByPortId(node,port.id,graphConfig);if(!portPos)return;var diffX=point.x-portPos.x,diffY=point.y-portPos.y,distance=diffX*diffX+diffY*diffY;distance<minDistance&&(minDistance=distance,nearestPort=port)}})),nearestPort}}({parentNode:node,clientX:clientX,clientY:clientY,graphConfig:state.settings.graphConfig,data:state.data.present,viewport:state.viewport,anotherPort:anotherPort,anotherNode:anotherNode}))?attachPort(state,node.id,targetPort.id):state}return state;case GraphNodeEvent.PointerLeave:return(null===(_a=state.connectState)||void 0===_a?void 0:_a.targetNode)===action.node.id?clearAttach(state):state;case GraphPortEvent.PointerLeave:return(null===(_b=state.connectState)||void 0===_b?void 0:_b.targetNode)===action.node.id&&(null===(_c=state.connectState)||void 0===_c?void 0:_c.targetPort)===action.port.id?clearAttach(state):state;default:return state}},function selectionReducer(state,action){var _a,_b,data=state.data.present,isLassoSelectEnable=state.settings.features.has(GraphFeatures.lassoSelect);switch(action.type){case GraphCanvasEvent.Click:case GraphCanvasEvent.ResetSelection:case GraphCanvasEvent.ContextMenu:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:graphDataUtils_unSelectAllEntity()(data)})});case GraphNodeEvent.Click:case GraphNodeEvent.ContextMenu:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:graphDataUtils_nodeSelection(action.rawEvent,action.node)(data)})});case GraphCanvasEvent.SelectStart:if(!isViewportComplete(state.viewport))return state;var point=getRelativePoint(state.viewport.rect,action.rawEvent);return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:graphDataUtils_unSelectAllEntity()(data)}),selectBoxPosition:{startX:point.x,startY:isLassoSelectEnable?0:point.y,width:0,height:0}});case GraphCanvasEvent.SelectMove:return state.behavior!==GraphBehavior.multiSelect?state:Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{selectBoxPosition:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.selectBoxPosition),{width:state.selectBoxPosition.width+action.dx,height:isLassoSelectEnable?null!==(_b=null===(_a=state.viewport.rect)||void 0===_a?void 0:_a.height)&&void 0!==_b?_b:state.selectBoxPosition.height:state.selectBoxPosition.height+action.dy})});case GraphCanvasEvent.SelectEnd:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{selectBoxPosition:{startX:0,startY:0,height:0,width:0},data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:updateNodeBySelectBox_selectNodeBySelectBox(state.settings.graphConfig,state.viewport.transformMatrix,state.selectBoxPosition,data)})});case GraphCanvasEvent.UpdateNodeSelectionBySelectBox:return state.behavior!==GraphBehavior.multiSelect?state:Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:updateNodeBySelectBox_selectNodeBySelectBox(state.settings.graphConfig,state.viewport.transformMatrix,state.selectBoxPosition,data)})});case GraphCanvasEvent.Navigate:return function handleNavigate(state,action){var data=graphDataUtils_unSelectAllEntity()(state.data.present);if(action.node&&action.port)data=data.updatePort(action.node.id,action.port.id,state_updateState(addState(GraphPortState.selected)));else if(action.node){var nodeId_1=action.node.id;data=data.selectNodes((function(node){return node.id===nodeId_1}))}return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data})})}(state,action);case GraphNodeEvent.SelectAll:return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data.selectNodes((function(){return!0}))})});case GraphNodeEvent.Select:var nodes_1=new Set(action.nodes);return Object(tslib_es6.a)(Object(tslib_es6.a)({},state),{data:Object(tslib_es6.a)(Object(tslib_es6.a)({},state.data),{present:data.selectNodes((function(node){return nodes_1.has(node.id)}))})});default:return state}},function contextMenuReducer(prevState,action){var nextContextMenuPosition=prevState.contextMenuPosition;switch(action.type){case GraphCanvasEvent.ContextMenu:case GraphNodeEvent.ContextMenu:case GraphEdgeEvent.ContextMenu:case GraphPortEvent.ContextMenu:var e=action.rawEvent;e.button===MouseEventButton.Secondary&&(nextContextMenuPosition={x:e.clientX,y:e.clientY});break;case GraphCanvasEvent.Click:case GraphNodeEvent.Click:case GraphEdgeEvent.Click:case GraphPortEvent.Click:nextContextMenuPosition=void 0;break;case GraphContextMenuEvent.Open:nextContextMenuPosition={x:action.x,y:action.y};break;case GraphContextMenuEvent.Close:nextContextMenuPosition=void 0}return prevState.contextMenuPosition===nextContextMenuPosition?prevState:Object(tslib_es6.a)(Object(tslib_es6.a)({},prevState),{contextMenuPosition:nextContextMenuPosition})}].map((function(reducer){return function(next){return function(state,action){return next(reducer(state,action),action)}}}))),noopReducer=function noopReducer(state){return state};var sampleGraphData={nodes:[{id:"source",name:"source",ports:[{id:"source-port",position:[.5,1],name:"source port",isInputDisabled:!0,isOutputDisabled:!1}],data:{},x:100,y:100,shape:"source"},{id:"step-1",name:"the first step",ports:[{id:"input-top",position:[.5,0],name:"input top",isOutputDisabled:!0,shape:"myPort"},{id:"input-left",position:[0,.5],name:"input left",isOutputDisabled:!0,shape:"myPort"},{id:"output-bottom",position:[.5,1],name:"output bottom",isInputDisabled:!0,shape:"myPort"},{id:"output-right",position:[1,.5],name:"output right",isInputDisabled:!0,shape:"myPort"}],data:{},x:100,y:400,shape:"step"},{id:"step-2",name:"the second step",ports:[{id:"input-top",position:[.5,0],name:"input top",isOutputDisabled:!0,shape:"myPort"},{id:"input-left",position:[0,.5],name:"input left",isOutputDisabled:!0,shape:"myPort"},{id:"output-bottom",position:[.5,1],name:"output bottom",isInputDisabled:!0,shape:"myPort"},{id:"output-right",position:[1,.5],name:"output right",isInputDisabled:!0,shape:"myPort"}],data:{},x:600,y:400,shape:"step"}],edges:[]},stepNodeContainerStyles={flexGrow:1,height:"100%",backgroundColor:"yellow",opacity:.5},FeaturesDemo_StepNode=function StepNode(props){return react.createElement("div",{style:stepNodeContainerStyles},props.name,react.createElement("button",{onClick:function onClick(){console.log("this is node "+props.name)}},"Click me"))},sourceNodeConfig={getMinHeight:function getMinHeight(){return 60},getMinWidth:function getMinWidth(){return 100},render:function render(args){var height=getRectHeight(sourceNodeConfig,args.model),width=getRectWidth(sourceNodeConfig,args.model),fill=hasState(GraphNodeState.activated)(args.model.state)?"red":"blue",stroke=hasState(GraphNodeState.selected)(args.model.state)?"green":"none";return react.createElement("ellipse",{rx:width/2,ry:height/2,cx:args.model.x+width/2,cy:args.model.y+height/2,stroke:stroke,strokeWidth:4,fill:fill,fillOpacity:.8})}},stepNodeConfig={getMinHeight:function getMinHeight(){return 64},getMinWidth:function getMinWidth(model){var _a,_b;return 120+12*(null!==(_b=null===(_a=model.name)||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)},render:function render(args){var _a,height=getRectHeight(stepNodeConfig,args.model),width=getRectWidth(stepNodeConfig,args.model);return react.createElement("foreignObject",{transform:"translate("+args.model.x+", "+args.model.y+")",height:height,width:width,style:{display:"flex"}},react.createElement(FeaturesDemo_StepNode,{name:null!==(_a=args.model.name)&&void 0!==_a?_a:""}))}},FeaturesDemo_Port=function Port(props){var port=props.port,x=props.x,y=props.y,parentNode=props.parentNode,style=props.style,isConnectable=props.isConnectable,renderCircle=function renderCircle(r,circleStyle){return react.createElement("circle",{r:r,cx:x,cy:y,style:circleStyle})},opacity=hasState(GraphNodeState.unconnectedToSelected)(parentNode.state)?"60%":"100%";return react.createElement("g",{opacity:opacity},void 0===isConnectable?react.createElement(react.Fragment,null,hasState(GraphPortState.activated)(port.state)?renderCircle(7,style):renderCircle(5,style)):hasState(GraphPortState.connectingAsTarget)(port.state)?renderCircle(7,style):react.createElement(react.Fragment,null,isConnectable&&renderCircle(18,{fill:"#0078ba",opacity:.2}),renderCircle(5,style)),react.createElement("circle",{r:18,fill:"transparent",cx:x,cy:y}))},FeaturesDemo_MyPortConfig=function(){function MyPortConfig(){}return MyPortConfig.prototype.getStyle=function(port,parentNode,data,isConnectable,connectedAsSource,connectedAsTarget){var stroke="#B3B0AD",strokeDasharray="",fill="#ffffff";if((connectedAsSource||connectedAsTarget)&&(fill="#B3B0AD"),hasState(GraphPortState.activated|GraphPortState.selected|GraphPortState.connecting)(port.state)&&(fill="#0078D4",stroke="#0078D4"),hasState(GraphPortState.connecting)(port.state))switch(isConnectable){case!0:fill="#ffffff",stroke="#0078D4",strokeDasharray="3,2";break;case!1:fill="#E1DFDD",hasState(GraphPortState.activated)(port.state)&&(stroke="#B3B0AD")}return{stroke:stroke,strokeWidth:1,strokeDasharray:strokeDasharray,fill:fill}},MyPortConfig.prototype.getIsConnectable=function(_a){var anotherPort=_a.anotherPort,model=_a.model;if(anotherPort)return!anotherPort.isOutputDisabled&&!model.isInputDisabled||!anotherPort.isInputDisabled&&!model.isOutputDisabled},MyPortConfig.prototype.render=function(args){var port=args.model,data=args.data,x=args.x,y=args.y,parentNode=args.parentNode,isConnectable=this.getIsConnectable(args),connectedAsSource=data.isPortConnectedAsSource(parentNode.id,port.id),connectedAsTarget=data.isPortConnectedAsTarget(parentNode.id,port.id);return react.createElement(FeaturesDemo_Port,{data:data,port:port,parentNode:parentNode,x:x,y:y,style:this.getStyle(port,parentNode,data,isConnectable,connectedAsSource,connectedAsTarget),isConnectable:isConnectable})},MyPortConfig.prototype.renderTooltips=function(args){var styles={position:"absolute",left:args.x+8,top:args.y+8,background:"#fff",height:30,border:"1px solid #ccc",minWidth:50,zIndex:1e3};return react.createElement("div",{style:styles},args.parentNode.name," ",args.model.name)},MyPortConfig}(),FeaturesDemo_graphConfig=GraphConfigBuilder_GraphConfigBuilder.default().registerNode("source",sourceNodeConfig).registerNode("step",stepNodeConfig).registerPort("myPort",new FeaturesDemo_MyPortConfig).build(),FeaturesDemo_FeaturesDemo=function FeaturesDemo(){var _a=function useGraphReducer(params,middleware){var reducer=react.useMemo((function(){return(middleware?composeReducers([middleware,builtinReducer]):builtinReducer)(noopReducer)}),[middleware]),_a=react.useReducer(reducer,params,(function(_a){var data=_a.data,transformMatrix=_a.transformMatrix,settings=Object(tslib_es6.e)(_a,["data","transformMatrix"]);return{settings:Object(tslib_es6.a)(Object(tslib_es6.a)({},DEFAULT_GRAPH_SETTINGS),settings),data:resetUndoStack(null!=data?data:GraphModel_GraphModel.empty()),viewport:{rect:void 0,transformMatrix:null!=transformMatrix?transformMatrix:EMPTY_TRANSFORM_MATRIX},behavior:GraphBehavior.default,dummyNodes:{dx:0,dy:0,dWidth:0,dHeight:0,alignedDX:void 0,alignedDY:void 0,nodes:[],isVisible:!1},alignmentLines:[],activeKeys:new Set,selectBoxPosition:{startX:0,startY:0,height:0,width:0},connectState:void 0}})),state=_a[0],dispatchImpl=_a[1],sideEffects=useConst((function(){return[]})),prevStateRef=react.useRef(state),dispatch=react.useCallback((function(action,callback){callback&&sideEffects.push(callback),dispatchImpl(action)}),[sideEffects]);return react.useEffect((function(){var prevState=prevStateRef.current;prevState!==state&&(prevStateRef.current=state,Object(react_dom.unstable_batchedUpdates)((function(){sideEffects.forEach((function(callback){try{callback(state,prevState)}catch(e){console.error(e)}})),sideEffects.length=0})))}),[state]),[state,dispatch]}({graphConfig:FeaturesDemo_graphConfig,data:GraphModel_GraphModel.fromJSON(sampleGraphData)},void 0),state=_a[0],dispatch=_a[1];return react.createElement(ReactDagEditor_ReactDagEditor,{style:{width:"900px",height:"600px"},state:state,dispatch:dispatch},react.createElement(Graph,null))};try{FeaturesDemo_Port.displayName="Port",FeaturesDemo_Port.__docgenInfo={description:"",displayName:"Port",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GraphModel<unknown, unknown, unknown>"}},port:{defaultValue:null,description:"",name:"port",required:!0,type:{name:"ICanvasPort<unknown>"}},parentNode:{defaultValue:null,description:"",name:"parentNode",required:!0,type:{name:"ICanvasNode<unknown, unknown>"}},x:{defaultValue:null,description:"",name:"x",required:!0,type:{name:"number"}},y:{defaultValue:null,description:"",name:"y",required:!0,type:{name:"number"}},style:{defaultValue:null,description:"",name:"style",required:!0,type:{name:"CSSProperties"}},isConnectable:{defaultValue:null,description:"",name:"isConnectable",required:!0,type:{name:"boolean | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/components/FeaturesDemo.tsx#Port"]={docgenInfo:FeaturesDemo_Port.__docgenInfo,name:"Port",path:"stories/components/FeaturesDemo.tsx#Port"})}catch(__react_docgen_typescript_loader_error){}try{FeaturesDemo_FeaturesDemo.displayName="FeaturesDemo",FeaturesDemo_FeaturesDemo.__docgenInfo={description:"",displayName:"FeaturesDemo",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/components/FeaturesDemo.tsx#FeaturesDemo"]={docgenInfo:FeaturesDemo_FeaturesDemo.__docgenInfo,name:"FeaturesDemo",path:"stories/components/FeaturesDemo.tsx#FeaturesDemo"})}catch(__react_docgen_typescript_loader_error){}__webpack_exports__.default={title:"react-dag-editor"};var index_stories_Features=function Features(){return react.createElement(FeaturesDemo_FeaturesDemo,null)};index_stories_Features.storyName="features",index_stories_Features.parameters=Object(tslib_es6.a)({storySource:{source:"() => <FeaturesDemo />"}},index_stories_Features.parameters)}},[[475,2,3]]]);